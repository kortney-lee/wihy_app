{"ast":null,"code":"var _jsxFileName = \"C:\\\\vHealth\\\\vhealth\\\\client\\\\src\\\\vHealthApp.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport SearchResults from './SearchResults';\nimport ImageUploadModal from './components/ImageUploadModal';\nimport { searchCache } from './services/searchCache';\nimport { healthSearchService } from './services/healthSearchService';\nimport { photoStorageService } from './services/photoStorageService';\nimport './VHealthSearch.css';\nimport MultiAuthLogin from './components/shared/components/MultiAuthLogin';\n\n// Add TypeScript declaration for Speech Recognition\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst VHealthApp = () => {\n  _s();\n  const [apiStatus, setApiStatus] = useState({\n    connected: false,\n    message: 'Checking API connection...'\n  });\n  const [currentView, setCurrentView] = useState('search');\n  const [currentQuery, setCurrentQuery] = useState('');\n  const [currentResults, setCurrentResults] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [dataSource, setDataSource] = useState(\"openai\");\n  const [currentPhotoId, setCurrentPhotoId] = useState(null);\n  const [isListening, setIsListening] = useState(false);\n  const [image, setImage] = useState(null);\n  const [isUploadModalOpen, setIsUploadModalOpen] = useState(false);\n  const recognitionRef = useRef(null);\n\n  // Handle browser navigation (back/forward buttons)\n  useEffect(() => {\n    const handlePopState = event => {\n      const state = event.state;\n      if (state) {\n        setCurrentView(state.view);\n        setCurrentQuery(state.query || '');\n        setCurrentResults(state.results || '');\n        setDataSource(state.dataSource || 'local');\n        setIsLoading(false);\n      } else {\n        // No state means we're at the root\n        setCurrentView('search');\n        setCurrentQuery('');\n        setCurrentResults('');\n      }\n    };\n    window.addEventListener('popstate', handlePopState);\n\n    // Check for initial query in URL\n    const urlParams = new URLSearchParams(window.location.search);\n    const queryParam = urlParams.get('q');\n    if (queryParam) {\n      handleSearch(queryParam, false); // Don't push to history on initial load\n    }\n    return () => window.removeEventListener('popstate', handlePopState);\n  }, []);\n  const handleSearch = async (query, pushToHistory = true) => {\n    console.log('🔍 SEARCH DEBUG: handleSearch called with query:', query);\n\n    // Add debugging right when loading starts\n    setIsLoading(true);\n    console.log('🔍 SEARCH DEBUG: setIsLoading(true) called');\n    if (!query.trim()) return;\n    const trimmedQuery = query.trim();\n\n    // Check cache first\n    const cachedResults = searchCache.getCachedResult(trimmedQuery);\n    if (cachedResults) {\n      console.log('🔍 SEARCH DEBUG: Using cached results');\n      // Use cached results\n      setCurrentQuery(trimmedQuery);\n      setCurrentResults(cachedResults);\n      setCurrentView('results');\n      setIsLoading(false);\n      if (pushToHistory) {\n        const url = `?q=${encodeURIComponent(trimmedQuery)}`;\n        window.history.pushState({\n          view: 'results',\n          query: trimmedQuery,\n          results: cachedResults\n        }, '', url);\n      }\n    } else {\n      console.log('🔍 SEARCH DEBUG: Making new search request');\n      try {\n        console.log('🔍 SEARCH DEBUG: About to call healthSearchService.searchHealthInfo');\n        const healthData = await healthSearchService.searchHealthInfo(trimmedQuery);\n        console.log('🔍 SEARCH DEBUG: Got response from healthSearchService:', healthData);\n\n        // Format the results for display\n        const formattedResults = formatHealthResults(healthData);\n        setCurrentResults(formattedResults);\n        searchCache.setCachedResult(trimmedQuery, formattedResults, window.location.href);\n\n        // If this search included an image, silently save the analysis\n        if (currentPhotoId && image) {\n          await photoStorageService.updatePhotoAnalysis(currentPhotoId, formattedResults);\n          console.log('AI analysis saved for photo:', currentPhotoId);\n        }\n\n        // Update history with results\n        if (pushToHistory) {\n          const url = `?q=${encodeURIComponent(trimmedQuery)}`;\n          window.history.replaceState({\n            view: 'results',\n            query: trimmedQuery,\n            results: formattedResults,\n            dataSource: healthData.dataSource\n          }, '', url);\n        }\n        console.log(`✅ Search completed using: ${healthData.dataSource === 'openai' ? 'ChatGPT' : 'Local Database'}`);\n      } catch (error) {\n        console.error('🔍 SEARCH DEBUG: Error in search:', error);\n        const errorMessage = 'Sorry, we encountered an error while searching for health information. Please try again or consult with a healthcare provider for medical advice.';\n        setCurrentResults(errorMessage);\n        setDataSource('error');\n      } finally {\n        console.log('🔍 SEARCH DEBUG: setIsLoading(false) called');\n        setIsLoading(false);\n        setCurrentPhotoId(null); // Reset after use\n      }\n    }\n  };\n  const formatHealthResults = healthData => {\n    let formatted = '';\n\n    // Keep only the clean content:\n    formatted += `${healthData.summary}\\n\\n`;\n    formatted += `${healthData.details}\\n\\n`;\n    if (healthData.recommendations && healthData.recommendations.length > 0) {\n      formatted += `**Recommendations:**\\n${healthData.recommendations.map(r => `• ${r}`).join('\\n')}\\n\\n`;\n    }\n    if (healthData.sources && healthData.sources.length > 0) {\n      formatted += `**Sources:** ${healthData.sources.join(', ')}\\n\\n`;\n    }\n    formatted += `**Medical Disclaimer:** ${healthData.medicalDisclaimer}`;\n    return formatted;\n  };\n  const handleBackToSearch = () => {\n    setCurrentView('search');\n    setCurrentQuery('');\n    setCurrentResults('');\n    window.history.pushState({\n      view: 'search'\n    }, '', '/');\n  };\n  const handleNewSearch = newQuery => {\n    handleSearch(newQuery);\n  };\n  const handleTextSubmit = async e => {\n    e.preventDefault();\n    if (!currentQuery.trim()) return;\n    console.log('🚀 Starting search with ChatGPT...');\n    handleSearch(currentQuery.trim());\n  };\n  const handleKeyPress = e => {\n    if (e.key === 'Enter') {\n      e.preventDefault();\n      handleTextSubmit(e);\n    }\n  };\n  const handleClearAll = () => {\n    setCurrentQuery('');\n    setImage(null);\n    setCurrentPhotoId(null);\n\n    // Clear file input and CSS classes\n    const fileInput = document.getElementById('camera-input');\n    if (fileInput) {\n      fileInput.value = '';\n    }\n    const searchInput = document.querySelector('.search-input');\n    if (searchInput) {\n      searchInput.classList.remove('with-image');\n    }\n  };\n  const handleVoiceInput = () => {\n    if (!('webkitSpeechRecognition' in window)) {\n      alert('Speech recognition not supported in this browser');\n      return;\n    }\n    if (!isListening) {\n      const recognition = new window.webkitSpeechRecognition();\n      recognition.continuous = false;\n      recognition.interimResults = false;\n      recognition.lang = 'en-US';\n      recognition.onstart = () => {\n        setIsListening(true);\n      };\n      recognition.onresult = event => {\n        const transcript = event.results[0][0].transcript;\n        setCurrentQuery(transcript);\n        setIsListening(false);\n      };\n      recognition.onerror = () => {\n        setIsListening(false);\n      };\n      recognition.onend = () => {\n        setIsListening(false);\n      };\n      recognitionRef.current = recognition;\n      recognition.start();\n    } else {\n      var _recognitionRef$curre;\n      (_recognitionRef$curre = recognitionRef.current) === null || _recognitionRef$curre === void 0 ? void 0 : _recognitionRef$curre.stop();\n      setIsListening(false);\n    }\n  };\n\n  // Clear expired cache on component mount\n  useEffect(() => {\n    searchCache.clearExpiredCache();\n  }, []);\n  useEffect(() => {\n    // Check service status on load\n    healthSearchService.checkServiceStatus().then(status => {\n      console.log('🔧 Health Search Service Status:', status);\n    });\n  }, []);\n\n  // Replace the handleCameraClick function\n  const handleCameraClick = () => {\n    setIsUploadModalOpen(true);\n  };\n\n  // Change this function name and simplify it:\n  const handleAnalysisComplete = async foodName => {\n    try {\n      console.log('Image analysis completed, food detected:', foodName);\n\n      // Set the analyzed food name as the search query\n      setCurrentQuery(foodName);\n\n      // Trigger a search with the analyzed food name\n      await handleSearch(foodName);\n\n      // Close the modal\n      setIsUploadModalOpen(false);\n    } catch (error) {\n      console.error('Error processing analyzed food:', error);\n      alert('Failed to process the analyzed food. Please try again.');\n    }\n  };\n  const handleUserChange = user => {\n    console.log('User changed:', user);\n  };\n  const handleSignIn = user => {\n    console.log('User signed in:', user);\n  };\n  const handleSignOut = () => {\n    console.log('User signed out');\n  };\n  if (currentView === 'results') {\n    return /*#__PURE__*/_jsxDEV(SearchResults, {\n      query: currentQuery,\n      results: currentResults,\n      onBackToSearch: handleBackToSearch,\n      onNewSearch: handleNewSearch,\n      isLoading: isLoading,\n      dataSource: dataSource\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 308,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"search-container\",\n    children: [/*#__PURE__*/_jsxDEV(MultiAuthLogin, {\n      position: \"top-right\",\n      className: \"main-login-button\",\n      onUserChange: handleUserChange,\n      onSignIn: handleSignIn,\n      onSignOut: handleSignOut\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 321,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n      className: \"search-title\",\n      children: \"What is Healthy?\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 329,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleTextSubmit,\n      className: \"search-form\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"search-input-container\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          placeholder: \"Ask anything about health...\",\n          value: currentQuery,\n          onChange: e => setCurrentQuery(e.target.value),\n          onKeyPress: handleKeyPress,\n          className: \"search-input\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 333,\n          columnNumber: 11\n        }, this), image && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"image-preview\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"image-icon\",\n            children: \"\\uD83D\\uDCF7\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 345,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"image-name\",\n            children: image.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 346,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: () => {\n              setImage(null);\n              setCurrentPhotoId(null);\n              const searchInput = document.querySelector('.search-input');\n              if (searchInput) {\n                searchInput.classList.remove('with-image');\n              }\n            },\n            className: \"remove-image\",\n            \"aria-label\": \"Remove image\",\n            children: \"\\xD7\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 347,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 344,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"search-icons\",\n          children: [(currentQuery || image) && /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: handleClearAll,\n            className: \"icon-button clear-button\",\n            \"aria-label\": \"Clear all\",\n            children: /*#__PURE__*/_jsxDEV(\"svg\", {\n              viewBox: \"0 0 24 24\",\n              fill: \"currentColor\",\n              children: /*#__PURE__*/_jsxDEV(\"path\", {\n                d: \"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 374,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 373,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 367,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: handleCameraClick,\n            className: \"icon-button\",\n            \"aria-label\": \"Upload image\",\n            children: /*#__PURE__*/_jsxDEV(\"svg\", {\n              viewBox: \"0 0 24 24\",\n              fill: \"currentColor\",\n              children: /*#__PURE__*/_jsxDEV(\"path\", {\n                d: \"M9 2L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2H9zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5z\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 386,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 385,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 379,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: handleVoiceInput,\n            className: `icon-button ${isListening ? 'listening' : ''}`,\n            \"aria-label\": isListening ? 'Stop listening' : 'Start voice input',\n            children: /*#__PURE__*/_jsxDEV(\"svg\", {\n              viewBox: \"0 0 24 24\",\n              fill: \"currentColor\",\n              children: [/*#__PURE__*/_jsxDEV(\"path\", {\n                d: \"M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 397,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n                d: \"M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.28c3.39-.49 6-3.3 6-6.72h-2z\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 398,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 396,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 390,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 365,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 332,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 331,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"search-actions\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"button\",\n        className: \"search-button\",\n        onClick: () => window.open('https://mhealth.com', '_blank'),\n        children: \"mHealth\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 406,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"button\",\n        className: \"search-button\",\n        onClick: () => window.open('https://whatishealthy.org', '_blank'),\n        children: \"What is Healthy?\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 413,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 405,\n      columnNumber: 7\n    }, this), isListening && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"voice-feedback\",\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"\\uD83C\\uDFA4 Listening...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 425,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 424,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(ImageUploadModal, {\n      isOpen: isUploadModalOpen,\n      onClose: () => setIsUploadModalOpen(false),\n      onAnalysisComplete: handleAnalysisComplete // Changed from onFileSelect\n      ,\n      title: \"Upload Image\",\n      subtitle: \"Upload images for analysis\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 430,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 320,\n    columnNumber: 5\n  }, this);\n};\n_s(VHealthApp, \"gePDTYJD9NlDHSt4l2Jpvfg3m3o=\");\n_c = VHealthApp;\nexport default VHealthApp;\nvar _c;\n$RefreshReg$(_c, \"VHealthApp\");","map":{"version":3,"names":["React","useState","useEffect","useRef","SearchResults","ImageUploadModal","searchCache","healthSearchService","photoStorageService","MultiAuthLogin","jsxDEV","_jsxDEV","VHealthApp","_s","apiStatus","setApiStatus","connected","message","currentView","setCurrentView","currentQuery","setCurrentQuery","currentResults","setCurrentResults","isLoading","setIsLoading","dataSource","setDataSource","currentPhotoId","setCurrentPhotoId","isListening","setIsListening","image","setImage","isUploadModalOpen","setIsUploadModalOpen","recognitionRef","handlePopState","event","state","view","query","results","window","addEventListener","urlParams","URLSearchParams","location","search","queryParam","get","handleSearch","removeEventListener","pushToHistory","console","log","trim","trimmedQuery","cachedResults","getCachedResult","url","encodeURIComponent","history","pushState","healthData","searchHealthInfo","formattedResults","formatHealthResults","setCachedResult","href","updatePhotoAnalysis","replaceState","error","errorMessage","formatted","summary","details","recommendations","length","map","r","join","sources","medicalDisclaimer","handleBackToSearch","handleNewSearch","newQuery","handleTextSubmit","e","preventDefault","handleKeyPress","key","handleClearAll","fileInput","document","getElementById","value","searchInput","querySelector","classList","remove","handleVoiceInput","alert","recognition","webkitSpeechRecognition","continuous","interimResults","lang","onstart","onresult","transcript","onerror","onend","current","start","_recognitionRef$curre","stop","clearExpiredCache","checkServiceStatus","then","status","handleCameraClick","handleAnalysisComplete","foodName","handleUserChange","user","handleSignIn","handleSignOut","onBackToSearch","onNewSearch","fileName","_jsxFileName","lineNumber","columnNumber","className","children","position","onUserChange","onSignIn","onSignOut","onSubmit","type","placeholder","onChange","target","onKeyPress","name","onClick","viewBox","fill","d","open","isOpen","onClose","onAnalysisComplete","title","subtitle","_c","$RefreshReg$"],"sources":["C:/vHealth/vhealth/client/src/vHealthApp.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport SearchResults from './SearchResults';\r\nimport ImageUploadModal from './components/ImageUploadModal';\r\nimport { searchCache } from './services/searchCache';\r\nimport { healthSearchService } from './services/healthSearchService';\r\nimport { photoStorageService } from './services/photoStorageService';\r\nimport { foodAnalysisService } from './components/foodAnalysisService';\r\nimport './VHealthSearch.css';\r\nimport MultiAuthLogin from './components/shared/components/MultiAuthLogin';\r\n\r\n// Add TypeScript declaration for Speech Recognition\r\ndeclare global {\r\n  interface Window {\r\n    webkitSpeechRecognition: any;\r\n    SpeechRecognition: any;\r\n  }\r\n}\r\n\r\ninterface SpeechRecognition extends EventTarget {\r\n  continuous: boolean;\r\n  interimResults: boolean;\r\n  lang: string;\r\n  start(): void;\r\n  stop(): void;\r\n  onstart: () => void;\r\n  onresult: (event: any) => void;\r\n  onerror: () => void;\r\n  onend: () => void;\r\n}\r\n\r\nconst VHealthApp: React.FC = () => {\r\n  const [apiStatus, setApiStatus] = useState({\r\n    connected: false,\r\n    message: 'Checking API connection...'\r\n  });\r\n  const [currentView, setCurrentView] = useState<'search' | 'results'>('search');\r\n  const [currentQuery, setCurrentQuery] = useState('');\r\n  const [currentResults, setCurrentResults] = useState('');\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [dataSource, setDataSource] = useState<\"openai\" | \"local\" | \"error\" | \"vnutrition\">(\"openai\");\r\n  const [currentPhotoId, setCurrentPhotoId] = useState<string | null>(null);\r\n  const [isListening, setIsListening] = useState(false);\r\n  const [image, setImage] = useState<File | null>(null);\r\n  const [isUploadModalOpen, setIsUploadModalOpen] = useState(false);\r\n\r\n  const recognitionRef = useRef<SpeechRecognition | null>(null);\r\n\r\n  // Handle browser navigation (back/forward buttons)\r\n  useEffect(() => {\r\n    const handlePopState = (event: PopStateEvent) => {\r\n      const state = event.state;\r\n      if (state) {\r\n        setCurrentView(state.view);\r\n        setCurrentQuery(state.query || '');\r\n        setCurrentResults(state.results || '');\r\n        setDataSource(state.dataSource || 'local');\r\n        setIsLoading(false);\r\n      } else {\r\n        // No state means we're at the root\r\n        setCurrentView('search');\r\n        setCurrentQuery('');\r\n        setCurrentResults('');\r\n      }\r\n    };\r\n\r\n    window.addEventListener('popstate', handlePopState);\r\n    \r\n    // Check for initial query in URL\r\n    const urlParams = new URLSearchParams(window.location.search);\r\n    const queryParam = urlParams.get('q');\r\n    if (queryParam) {\r\n      handleSearch(queryParam, false); // Don't push to history on initial load\r\n    }\r\n\r\n    return () => window.removeEventListener('popstate', handlePopState);\r\n  }, []);\r\n\r\n  const handleSearch = async (query: string, pushToHistory = true) => {\r\n    console.log('🔍 SEARCH DEBUG: handleSearch called with query:', query);\r\n    \r\n    // Add debugging right when loading starts\r\n    setIsLoading(true);\r\n    console.log('🔍 SEARCH DEBUG: setIsLoading(true) called');\r\n    \r\n    if (!query.trim()) return;\r\n\r\n    const trimmedQuery = query.trim();\r\n    \r\n    // Check cache first\r\n    const cachedResults = searchCache.getCachedResult(trimmedQuery);\r\n    \r\n    if (cachedResults) {\r\n      console.log('🔍 SEARCH DEBUG: Using cached results');\r\n      // Use cached results\r\n      setCurrentQuery(trimmedQuery);\r\n      setCurrentResults(cachedResults);\r\n      setCurrentView('results');\r\n      setIsLoading(false);\r\n      \r\n      if (pushToHistory) {\r\n        const url = `?q=${encodeURIComponent(trimmedQuery)}`;\r\n        window.history.pushState(\r\n          { view: 'results', query: trimmedQuery, results: cachedResults },\r\n          '',\r\n          url\r\n        );\r\n      }\r\n    } else {\r\n      console.log('🔍 SEARCH DEBUG: Making new search request');\r\n      \r\n      try {\r\n        console.log('🔍 SEARCH DEBUG: About to call healthSearchService.searchHealthInfo');\r\n        const healthData = await healthSearchService.searchHealthInfo(trimmedQuery);\r\n        console.log('🔍 SEARCH DEBUG: Got response from healthSearchService:', healthData);\r\n        \r\n        // Format the results for display\r\n        const formattedResults = formatHealthResults(healthData);\r\n        \r\n        setCurrentResults(formattedResults);\r\n        searchCache.setCachedResult(trimmedQuery, formattedResults, window.location.href);\r\n        \r\n        // If this search included an image, silently save the analysis\r\n        if (currentPhotoId && image) {\r\n          await photoStorageService.updatePhotoAnalysis(currentPhotoId, formattedResults);\r\n          console.log('AI analysis saved for photo:', currentPhotoId);\r\n        }\r\n        \r\n        // Update history with results\r\n        if (pushToHistory) {\r\n          const url = `?q=${encodeURIComponent(trimmedQuery)}`;\r\n          window.history.replaceState(\r\n            { \r\n              view: 'results', \r\n              query: trimmedQuery, \r\n              results: formattedResults,\r\n              dataSource: healthData.dataSource\r\n            },\r\n            '',\r\n            url\r\n          );\r\n        }\r\n\r\n        console.log(`✅ Search completed using: ${healthData.dataSource === 'openai' ? 'ChatGPT' : 'Local Database'}`);\r\n      } catch (error) {\r\n        console.error('🔍 SEARCH DEBUG: Error in search:', error);\r\n        const errorMessage = 'Sorry, we encountered an error while searching for health information. Please try again or consult with a healthcare provider for medical advice.';\r\n        setCurrentResults(errorMessage);\r\n        setDataSource('error');\r\n      } finally {\r\n        console.log('🔍 SEARCH DEBUG: setIsLoading(false) called');\r\n        setIsLoading(false);\r\n        setCurrentPhotoId(null); // Reset after use\r\n      }\r\n    }\r\n  };\r\n\r\n  const formatHealthResults = (healthData: any): string => {\r\n    let formatted = '';\r\n    \r\n    // Keep only the clean content:\r\n    formatted += `${healthData.summary}\\n\\n`;\r\n    formatted += `${healthData.details}\\n\\n`;\r\n    \r\n    if (healthData.recommendations && healthData.recommendations.length > 0) {\r\n      formatted += `**Recommendations:**\\n${healthData.recommendations.map((r: string) => `• ${r}`).join('\\n')}\\n\\n`;\r\n    }\r\n    \r\n    if (healthData.sources && healthData.sources.length > 0) {\r\n      formatted += `**Sources:** ${healthData.sources.join(', ')}\\n\\n`;\r\n    }\r\n    \r\n    formatted += `**Medical Disclaimer:** ${healthData.medicalDisclaimer}`;\r\n    \r\n    return formatted;\r\n  };\r\n\r\n  const handleBackToSearch = () => {\r\n    setCurrentView('search');\r\n    setCurrentQuery('');\r\n    setCurrentResults('');\r\n    window.history.pushState({ view: 'search' }, '', '/');\r\n  };\r\n\r\n  const handleNewSearch = (newQuery: string) => {\r\n    handleSearch(newQuery);\r\n  };\r\n\r\n  const handleTextSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    if (!currentQuery.trim()) return;\r\n    console.log('🚀 Starting search with ChatGPT...');\r\n    handleSearch(currentQuery.trim());\r\n  };\r\n\r\n  const handleKeyPress = (e: React.KeyboardEvent) => {\r\n    if (e.key === 'Enter') {\r\n      e.preventDefault();\r\n      handleTextSubmit(e as any);\r\n    }\r\n  };\r\n\r\n  const handleClearAll = () => {\r\n    setCurrentQuery('');\r\n    setImage(null);\r\n    setCurrentPhotoId(null);\r\n    \r\n    // Clear file input and CSS classes\r\n    const fileInput = document.getElementById('camera-input') as HTMLInputElement;\r\n    if (fileInput) {\r\n      fileInput.value = '';\r\n    }\r\n    \r\n    const searchInput = document.querySelector('.search-input') as HTMLInputElement;\r\n    if (searchInput) {\r\n      searchInput.classList.remove('with-image');\r\n    }\r\n  };\r\n\r\n  const handleVoiceInput = () => {\r\n    if (!('webkitSpeechRecognition' in window)) {\r\n      alert('Speech recognition not supported in this browser');\r\n      return;\r\n    }\r\n\r\n    if (!isListening) {\r\n      const recognition = new (window as any).webkitSpeechRecognition();\r\n      recognition.continuous = false;\r\n      recognition.interimResults = false;\r\n      recognition.lang = 'en-US';\r\n\r\n      recognition.onstart = () => {\r\n        setIsListening(true);\r\n      };\r\n\r\n      recognition.onresult = (event: any) => {\r\n        const transcript = event.results[0][0].transcript;\r\n        setCurrentQuery(transcript);\r\n        setIsListening(false);\r\n      };\r\n\r\n      recognition.onerror = () => {\r\n        setIsListening(false);\r\n      };\r\n\r\n      recognition.onend = () => {\r\n        setIsListening(false);\r\n      };\r\n\r\n      recognitionRef.current = recognition;\r\n      recognition.start();\r\n    } else {\r\n      recognitionRef.current?.stop();\r\n      setIsListening(false);\r\n    }\r\n  };\r\n\r\n  // Clear expired cache on component mount\r\n  useEffect(() => {\r\n    searchCache.clearExpiredCache();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    // Check service status on load\r\n    healthSearchService.checkServiceStatus().then(status => {\r\n      console.log('🔧 Health Search Service Status:', status);\r\n    });\r\n  }, []);\r\n\r\n  // Replace the handleCameraClick function\r\n  const handleCameraClick = () => {\r\n    setIsUploadModalOpen(true);\r\n  };\r\n\r\n  // Change this function name and simplify it:\r\n  const handleAnalysisComplete = async (foodName: string) => {\r\n    try {\r\n      console.log('Image analysis completed, food detected:', foodName);\r\n      \r\n      // Set the analyzed food name as the search query\r\n      setCurrentQuery(foodName);\r\n      \r\n      // Trigger a search with the analyzed food name\r\n      await handleSearch(foodName);\r\n      \r\n      // Close the modal\r\n      setIsUploadModalOpen(false);\r\n      \r\n    } catch (error) {\r\n      console.error('Error processing analyzed food:', error);\r\n      alert('Failed to process the analyzed food. Please try again.');\r\n    }\r\n  };\r\n\r\n  const handleUserChange = (user: any) => {\r\n    console.log('User changed:', user);\r\n  };\r\n\r\n  const handleSignIn = (user: any) => {\r\n    console.log('User signed in:', user);\r\n  };\r\n\r\n  const handleSignOut = () => {\r\n    console.log('User signed out');\r\n  };\r\n\r\n  if (currentView === 'results') {\r\n    return (\r\n      <SearchResults\r\n        query={currentQuery}\r\n        results={currentResults}\r\n        onBackToSearch={handleBackToSearch}\r\n        onNewSearch={handleNewSearch}\r\n        isLoading={isLoading}\r\n        dataSource={dataSource}\r\n      />\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"search-container\">\r\n      <MultiAuthLogin \r\n        position=\"top-right\"\r\n        className=\"main-login-button\"\r\n        onUserChange={handleUserChange}\r\n        onSignIn={handleSignIn}\r\n        onSignOut={handleSignOut}\r\n      />\r\n\r\n      <h1 className=\"search-title\">What is Healthy?</h1>\r\n\r\n      <form onSubmit={handleTextSubmit} className=\"search-form\">\r\n        <div className=\"search-input-container\">\r\n          <input\r\n            type=\"text\"\r\n            placeholder=\"Ask anything about health...\"\r\n            value={currentQuery}\r\n            onChange={(e) => setCurrentQuery(e.target.value)}\r\n            onKeyPress={handleKeyPress}\r\n            className=\"search-input\"\r\n          />\r\n          \r\n          {/* Show image chip when image is uploaded */}\r\n          {image && (\r\n            <div className=\"image-preview\">\r\n              <div className=\"image-icon\">📷</div>\r\n              <span className=\"image-name\">{image.name}</span>\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => {\r\n                  setImage(null);\r\n                  setCurrentPhotoId(null);\r\n                  const searchInput = document.querySelector('.search-input') as HTMLInputElement;\r\n                  if (searchInput) {\r\n                    searchInput.classList.remove('with-image');\r\n                  }\r\n                }}\r\n                className=\"remove-image\"\r\n                aria-label=\"Remove image\"\r\n              >\r\n                ×\r\n              </button>\r\n            </div>\r\n          )}\r\n          \r\n          <div className=\"search-icons\">\r\n            {(currentQuery || image) && (\r\n              <button\r\n                type=\"button\"\r\n                onClick={handleClearAll}\r\n                className=\"icon-button clear-button\"\r\n                aria-label=\"Clear all\"\r\n              >\r\n                <svg viewBox=\"0 0 24 24\" fill=\"currentColor\">\r\n                  <path d=\"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z\"/>\r\n                </svg>\r\n              </button>\r\n            )}\r\n            \r\n            <button\r\n              type=\"button\"\r\n              onClick={handleCameraClick}\r\n              className=\"icon-button\"\r\n              aria-label=\"Upload image\"\r\n            >\r\n              <svg viewBox=\"0 0 24 24\" fill=\"currentColor\">\r\n                <path d=\"M9 2L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2H9zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5z\"/>\r\n              </svg>\r\n            </button>\r\n            \r\n            <button\r\n              type=\"button\"\r\n              onClick={handleVoiceInput}\r\n              className={`icon-button ${isListening ? 'listening' : ''}`}\r\n              aria-label={isListening ? 'Stop listening' : 'Start voice input'}\r\n            >\r\n              <svg viewBox=\"0 0 24 24\" fill=\"currentColor\">\r\n                <path d=\"M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z\"/>\r\n                <path d=\"M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.28c3.39-.49 6-3.3 6-6.72h-2z\"/>\r\n              </svg>\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </form>\r\n\r\n      <div className=\"search-actions\">\r\n        <button \r\n          type=\"button\" \r\n          className=\"search-button\"\r\n          onClick={() => window.open('https://mhealth.com', '_blank')}\r\n        >\r\n          mHealth\r\n        </button>\r\n        <button \r\n          type=\"button\"\r\n          className=\"search-button\"\r\n          onClick={() => window.open('https://whatishealthy.org', '_blank')}\r\n        >\r\n          What is Healthy?\r\n        </button>\r\n      </div>\r\n\r\n      {/* Voice Feedback */}\r\n      {isListening && (\r\n        <div className=\"voice-feedback\">\r\n          <p>🎤 Listening...</p>\r\n        </div>\r\n      )}\r\n\r\n      {/* Add the ImageUploadModal */}\r\n      <ImageUploadModal\r\n        isOpen={isUploadModalOpen}\r\n        onClose={() => setIsUploadModalOpen(false)}\r\n        onAnalysisComplete={handleAnalysisComplete} // Changed from onFileSelect\r\n        title=\"Upload Image\"\r\n        subtitle=\"Upload images for analysis\"\r\n      />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default VHealthApp;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}