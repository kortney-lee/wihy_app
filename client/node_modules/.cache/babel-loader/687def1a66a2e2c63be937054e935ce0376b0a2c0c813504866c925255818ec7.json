{"ast":null,"code":"// Spinner.tsx\nimport React,{useEffect}from'react';import ReactDOM from'react-dom';import'./Spinner.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const portalId='vh-spinner-portal';function ensurePortal(){let el=document.getElementById(portalId);if(!el){el=document.createElement('div');el.id=portalId;document.body.appendChild(el);}return el;}export default function Spinner(_ref){let{overlay=false,title='Analyzing with AI...',subtitle='This may take a few moments...',progress,disableEsc=true,onClose,type='gif',// Force it to always be GIF\ngifSrc='/assets/whatishealthyspinner.gif'}=_ref;// Optional: trap/allow ESC when overlayed\nuseEffect(()=>{if(!overlay)return;const onKey=e=>{if(e.key==='Escape'){if(disableEsc){e.preventDefault();e.stopPropagation();}else{onClose===null||onClose===void 0?void 0:onClose();}}};document.addEventListener('keydown',onKey,{capture:true});return()=>document.removeEventListener('keydown',onKey,{capture:true});},[overlay,disableEsc,onClose]);// Non-overlay inline spinner (kept for compatibility)\nif(!overlay){return/*#__PURE__*/_jsxs(\"div\",{className:\"clean-loader\",role:\"status\",\"aria-live\":\"polite\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"arc-spinner\"}),subtitle&&/*#__PURE__*/_jsx(\"p\",{style:{marginTop:12},className:\"spinner-text\",children:subtitle})]});}// Overlay modal via portal to avoid z-index issues\nconst portal=ensurePortal();const clamped=typeof progress==='number'?Math.max(0,Math.min(100,Math.round(progress))):undefined;const modal=/*#__PURE__*/_jsx(\"div\",{className:\"spinner-overlay\",role:\"dialog\",\"aria-modal\":\"true\",\"aria-labelledby\":\"spinner-title\",\"aria-describedby\":\"spinner-subtitle\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"spinner-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"spinner-gif\",children:/*#__PURE__*/_jsx(\"img\",{src:\"/assets/whatishealthyspinner.gif\",alt:\"Loading...\",className:\"spinner-image\"})}),/*#__PURE__*/_jsx(\"h2\",{id:\"spinner-title\",className:\"spinner-title\",children:title}),subtitle&&/*#__PURE__*/_jsx(\"p\",{id:\"spinner-subtitle\",className:\"spinner-message\",children:subtitle}),type!=='gif'&&/*#__PURE__*/_jsxs(\"div\",{className:\"spinner-progress\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"spinner-track\",children:/*#__PURE__*/_jsx(\"div\",{className:\"spinner-fill \".concat(clamped===undefined?'indeterminate':''),style:clamped!==undefined?{width:\"\".concat(clamped,\"%\")}:undefined})}),/*#__PURE__*/_jsx(\"div\",{className:\"spinner-percent\",children:clamped!==undefined?\"\".concat(clamped,\"% Complete\"):'Working…'})]})]})});return/*#__PURE__*/ReactDOM.createPortal(modal,portal);}","map":{"version":3,"names":["React","useEffect","ReactDOM","jsx","_jsx","jsxs","_jsxs","portalId","ensurePortal","el","document","getElementById","createElement","id","body","appendChild","Spinner","_ref","overlay","title","subtitle","progress","disableEsc","onClose","type","gifSrc","onKey","e","key","preventDefault","stopPropagation","addEventListener","capture","removeEventListener","className","role","children","style","marginTop","portal","clamped","Math","max","min","round","undefined","modal","src","alt","concat","width","createPortal"],"sources":["C:/repo/wihy_ui/client/src/components/Spinner.tsx"],"sourcesContent":["// Spinner.tsx\r\nimport React, { useEffect } from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './Spinner.css';\r\n\r\ninterface SpinnerProps {\r\n  /** Full-screen overlay modal */\r\n  overlay?: boolean;\r\n  /** Bold heading (defaults to “Analyzing with AI…”) */\r\n  title?: string;\r\n  /** Secondary line (defaults to “This may take a few moments…”) */\r\n  subtitle?: string;\r\n  /** Prevent closing with Esc (defaults true for blocking tasks) */\r\n  disableEsc?: boolean;\r\n  /** Called if Esc is allowed and user presses it */\r\n  onClose?: () => void;\r\n  /** 0–100 for determinate; omit for indeterminate */\r\n  progress?: number;\r\n  /** Specify spinner type: 'circle' or 'gif' */\r\n  type?: 'circle' | 'gif';\r\n  /** Custom GIF source, used if type is 'gif' */\r\n  gifSrc?: string;\r\n}\r\n\r\nconst portalId = 'vh-spinner-portal';\r\n\r\nfunction ensurePortal(): HTMLElement {\r\n  let el = document.getElementById(portalId);\r\n  if (!el) {\r\n    el = document.createElement('div');\r\n    el.id = portalId;\r\n    document.body.appendChild(el);\r\n  }\r\n  return el;\r\n}\r\n\r\nexport default function Spinner({\r\n  overlay = false,\r\n  title = 'Analyzing with AI...',\r\n  subtitle = 'This may take a few moments...',\r\n  progress,\r\n  disableEsc = true,\r\n  onClose,\r\n  type = 'gif', // Force it to always be GIF\r\n  gifSrc = '/assets/whatishealthyspinner.gif'\r\n}: SpinnerProps) {\r\n  // Optional: trap/allow ESC when overlayed\r\n  useEffect(() => {\r\n    if (!overlay) return;\r\n    const onKey = (e: KeyboardEvent) => {\r\n      if (e.key === 'Escape') {\r\n        if (disableEsc) {\r\n          e.preventDefault();\r\n          e.stopPropagation();\r\n        } else {\r\n          onClose?.();\r\n        }\r\n      }\r\n    };\r\n    document.addEventListener('keydown', onKey, { capture: true });\r\n    return () => document.removeEventListener('keydown', onKey, { capture: true } as any);\r\n  }, [overlay, disableEsc, onClose]);\r\n\r\n  // Non-overlay inline spinner (kept for compatibility)\r\n  if (!overlay) {\r\n    return (\r\n      <div className=\"clean-loader\" role=\"status\" aria-live=\"polite\">\r\n        <div className=\"arc-spinner\" />\r\n        {subtitle && <p style={{ marginTop: 12 }} className=\"spinner-text\">{subtitle}</p>}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Overlay modal via portal to avoid z-index issues\r\n  const portal = ensurePortal();\r\n  const clamped =\r\n    typeof progress === 'number'\r\n      ? Math.max(0, Math.min(100, Math.round(progress)))\r\n      : undefined;\r\n\r\n  const modal = (\r\n    <div className=\"spinner-overlay\" role=\"dialog\" aria-modal=\"true\" aria-labelledby=\"spinner-title\" aria-describedby=\"spinner-subtitle\">\r\n      <div className=\"spinner-container\">\r\n        {/* Always show GIF for testing */}\r\n        <div className=\"spinner-gif\">\r\n          <img \r\n            src=\"/assets/whatishealthyspinner.gif\" \r\n            alt=\"Loading...\" \r\n            className=\"spinner-image\"\r\n          />\r\n        </div>\r\n        <h2 id=\"spinner-title\" className=\"spinner-title\">{title}</h2>\r\n        {subtitle && <p id=\"spinner-subtitle\" className=\"spinner-message\">{subtitle}</p>}\r\n\r\n        {type !== 'gif' && (\r\n          <div className=\"spinner-progress\">\r\n            <div className=\"spinner-track\">\r\n              <div\r\n                className={`spinner-fill ${clamped === undefined ? 'indeterminate' : ''}`}\r\n                style={clamped !== undefined ? { width: `${clamped}%` } : undefined}\r\n              />\r\n            </div>\r\n            <div className=\"spinner-percent\">\r\n              {clamped !== undefined ? `${clamped}% Complete` : 'Working…'}\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  return ReactDOM.createPortal(modal, portal);\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}