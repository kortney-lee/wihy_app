{"ast":null,"code":"import React,{useState,useRef,useEffect}from'react';import{useNavigate}from'react-router-dom';import'../../styles/VHealthSearch.css';import ImageUploadModal from'../ui/ImageUploadModal';import MultiAuthLogin from'../shared/MultiAuthLogin';import{wihyAPI}from'../../services/wihyAPI';import HealthNewsFeed from'../HealthNewsFeed';import{logger}from'../../utils/logger';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const rotatingPrompts=[\"Ask me what is healthy\",\"Do we really need to eat several small meals per day?\",\"What's the real truth about detox?\",\"Why doesn't cleansing actually heal the body?\",\"What does it mean to rediscover real food?\",\"When did food become a prescription instead of nourishment?\",\"What do we really know about the metabolism?\",\"Is the thyroid the whole story—or just part of it?\",\"How are food and fertility connected to our future?\",\"What's the hidden cost of convenience in modern life?\",\"What exactly happened in the year 2000 that changed our health?\",\"How did disconnection start replacing love?\"];const VHealthSearch=()=>{// ================================\n// STATE MANAGEMENT\n// ================================\nconst[searchQuery,setSearchQuery]=useState('');const[isListening,setIsListening]=useState(false);const[isUploadModalOpen,setIsUploadModalOpen]=useState(false);const[isLoading,setIsLoading]=useState(false);const[imageError,setImageError]=useState(false);const[loadingMessage,setLoadingMessage]=useState('Searching...');const[showFeelingHealthyContent,setShowFeelingHealthyContent]=useState(false);const[isScrolled,setIsScrolled]=useState(false);const[placeholder,setPlaceholder]=useState(rotatingPrompts[0]);const navigate=useNavigate();const searchInputRef=useRef(null);const recognitionRef=useRef(null);const abortControllerRef=useRef(null);// ================================\n// PREVENT SCROLLBARS ON LANDING PAGE\n// ================================\nuseEffect(()=>{// Add class to body to hide scrollbars on landing page\ndocument.body.classList.add('landing-page-active');document.documentElement.classList.add('landing-page-active');// Cleanup when component unmounts or navigates away\nreturn()=>{document.body.classList.remove('landing-page-active');document.documentElement.classList.remove('landing-page-active');};},[]);// ================================\n// ALLOW SCROLLING WHEN NEWS FEED IS OPEN\n// ================================\nuseEffect(()=>{if(showFeelingHealthyContent){// Remove landing page classes to allow scrolling when news feed is open\ndocument.body.classList.remove('landing-page-active');document.documentElement.classList.remove('landing-page-active');}else{// Re-add landing page classes when news feed is closed\ndocument.body.classList.add('landing-page-active');document.documentElement.classList.add('landing-page-active');}},[showFeelingHealthyContent]);// ================================\n// SCROLL DETECTION FOR LOGIN BUTTON\n// ================================\nuseEffect(()=>{const handleScroll=()=>{const scrollY=window.scrollY;const threshold=10;// Hide login button when scrolled more than 10px\nsetIsScrolled(scrollY>threshold);};// Check initial scroll position\nhandleScroll();window.addEventListener('scroll',handleScroll,{passive:true});return()=>{window.removeEventListener('scroll',handleScroll);};},[]);// ================================\n// FORCE MOBILE ANIMATION\n// ================================\nuseEffect(()=>{// Force the animation to work on mobile by applying it directly\nconst forceAnimation=()=>{const container=document.querySelector('.search-input-container');if(container){// Try a simpler animation approach for mobile\nif('ontouchstart'in window||navigator.maxTouchPoints>0){// Mobile-specific animation using background-position sweep (matching desktop pattern)\ncontainer.style.setProperty('border','2px solid transparent','important');container.style.setProperty('background',\"\\n            linear-gradient(#fff, #fff) padding-box,\\n            linear-gradient(90deg, #fa5f06, #ffffff, #C0C0C0, #4cbb17, #1a73e8) border-box\\n          \",'important');container.style.setProperty('background-size','100% 100%, 200% 100%','important');container.style.setProperty('animation','none','important');// Use background-position animation to match desktop sweep pattern\nlet position=0;const animateSweep=()=>{position=(position+1)%200;// 0 to 200% like the original\ncontainer.style.setProperty('background-position',\"0 0, \".concat(position,\"% 0\"),'important');setTimeout(()=>requestAnimationFrame(animateSweep),22);// ~2.2s for full cycle (200 * 22ms ≈ 4.4s)\n};animateSweep();container.classList.add('force-mobile-animation');logger.debug('Mobile device detected - custom gradient animation started');}else{// Desktop - use CSS animation\ncontainer.style.setProperty('animation','wiH-border-sweep 2.2s linear infinite','important');container.style.setProperty('background',\"\\n            linear-gradient(#fff, #fff) padding-box,\\n            linear-gradient(90deg, #fa5f06, #ffffff, #C0C0C0, #4cbb17, #1a73e8) border-box\\n          \",'important');container.style.setProperty('background-size','100% 100%, 200% 100%','important');container.style.setProperty('border','2px solid transparent','important');logger.debug('Desktop animation applied');}logger.debug('Forced animation applied to search container');}};// Apply immediately and also after a short delay to ensure it sticks\nforceAnimation();const timeoutId=setTimeout(forceAnimation,100);// Also apply when the component mounts fully\nconst mountTimeout=setTimeout(forceAnimation,500);return()=>{clearTimeout(timeoutId);clearTimeout(mountTimeout);};},[]);// ================================\n// UTILITY FUNCTIONS\n// ================================\n/**\r\n   * PROGRESS CALCULATOR\r\n   * Converts loading message text to progress percentage for UI feedback\r\n   * @param msg - The current loading message\r\n   * @returns Progress percentage (0-100)\r\n   */const progressFromMessage=msg=>{if(msg.includes('Initializing'))return 10;if(msg.includes('Checking cache'))return 25;if(msg.includes('Analyzing with AI'))return 55;if(msg.includes('Processing results'))return 75;if(msg.includes('Results ready')||msg.includes('Response ready'))return 95;if(msg.includes('Processing image'))return 35;if(msg.includes('Checking nutrition'))return 45;if(msg.includes('Analyzing nutrition'))return 60;if(msg.includes('Processing nutrition'))return 80;if(msg.includes('complete'))return 95;if(msg.includes('failed'))return 100;// will close shortly\nreturn 40;// default midpoint\n};/**\r\n   * AUTO-SIZE TEXT AREA\r\n   * Dynamically adjusts the height of the search input based on content\r\n   */const autoSize=()=>{const el=document.querySelector('.search-input');if(!el)return;// Reset to default height when empty\nif(!searchQuery.trim()){el.style.height='44px';// Default height\nel.style.overflowY='hidden';return;}// Otherwise handle auto-sizing as before\nel.style.height=\"auto\";const next=el.scrollHeight;el.style.height=next+\"px\";// Check if we've hit max height\nconst max=parseFloat(getComputedStyle(el).maxHeight);el.style.overflowY=next>max?\"auto\":\"hidden\";};/**\r\n   * CLEAR SEARCH INPUT\r\n   * Clears search input and resets its height to default\r\n   */const handleClearSearch=()=>{setSearchQuery('');// Force a reset after state update\nsetTimeout(()=>{const el=document.querySelector('.search-input');if(el)el.style.height='44px';},10);};// ================================\n// AUTHENTICATION HANDLERS\n// ================================\n/**\r\n   * USER CHANGE HANDLER\r\n   * Handles when user authentication state changes\r\n   * @param user - User object from auth service\r\n   */const handleUserChange=user=>{console.log('User changed:',user);};/**\r\n   * SIGN IN HANDLER\r\n   * Handles successful user sign-in\r\n   * @param user - Authenticated user object\r\n   */const handleSignIn=user=>{console.log('User signed in:',user);};/**\r\n   * SIGN OUT HANDLER\r\n   * Handles user sign-out action\r\n   */const handleSignOut=()=>{console.log('User signed out');};// ================================\n// MAIN SEARCH FUNCTIONALITY\n// ================================\n/**\r\n   * MAIN SEARCH HANDLER\r\n   * Primary search function that handles text-based health queries\r\n   * Flow: Check cache → API call → Save to cache → Navigate to results\r\n   * Uses 4-step fallback strategy for reliability\r\n   */const handleSearch=async queryParam=>{const queryToUse=queryParam||searchQuery;if(!queryToUse.trim()||isLoading)return;// Create new AbortController for this request\nabortControllerRef.current=new AbortController();const signal=abortControllerRef.current.signal;setIsLoading(true);setLoadingMessage('Initializing search...');try{// Get fresh results from WiHy API (cache is managed by the API)\nsetLoadingMessage('Analyzing with AI...');logger.debug('Getting fresh results for query',{query:queryToUse});try{// Use WiHy Unified API for search\nlogger.apiRequest('WiHy API search',{query:queryToUse});const wihyResponse=await wihyAPI.searchHealth(queryToUse);if(wihyResponse.success){// Handle both unified and legacy response formats\nlet summary='Health information provided';if('data'in wihyResponse){var _data;// New unified API response format\nsummary=((_data=wihyResponse.data)===null||_data===void 0?void 0:_data.response)||summary;}else{var _wihy_response;// Legacy WihyResponse format\nsummary=((_wihy_response=wihyResponse.wihy_response)===null||_wihy_response===void 0?void 0:_wihy_response.core_principle)||summary;}// Convert WiHy response to expected format\nconst searchResults={summary:summary,details:wihyAPI.formatWihyResponse(wihyResponse),sources:wihyAPI.extractCitations(wihyResponse),recommendations:wihyAPI.extractRecommendations(wihyResponse),relatedTopics:[],medicalDisclaimer:'This guidance is based on evidence-based health principles. Always consult healthcare professionals for personalized medical advice.',dataSource:'wihy'};console.log('WiHy search results received:',searchResults);const isValidResult=searchResults&&typeof searchResults==='object'&&searchResults!==null&&(searchResults.summary||searchResults.details||Object.keys(searchResults).length>0);if(isValidResult){logger.info('Valid search results confirmed');// Results ready - cache is managed by the API\nsetLoadingMessage('Results ready!');await new Promise(resolve=>setTimeout(resolve,300));setIsLoading(false);logger.debug('Navigating to results page with data');// Pass the fresh results via navigation state\nnavigate(\"/results?q=\".concat(encodeURIComponent(queryToUse)),{state:{results:searchResults,dataSource:'wihy',fromSearch:true}});return;}else{throw new Error('WiHy API returned invalid results');}}else{throw new Error('WiHy API request failed');}}catch(apiError){var _apiError$message,_apiError$message2,_apiError$message3,_apiError$message4,_apiError$message5,_apiError$message6,_apiError$message7;// Handle AbortError specifically\nif(apiError.name==='AbortError'){logger.debug('API request was cancelled');return;// Exit early\n}const isNetworkError=((_apiError$message=apiError.message)===null||_apiError$message===void 0?void 0:_apiError$message.includes('NETWORK_ERROR'))||((_apiError$message2=apiError.message)===null||_apiError$message2===void 0?void 0:_apiError$message2.includes('TIMEOUT_ERROR'))||((_apiError$message3=apiError.message)===null||_apiError$message3===void 0?void 0:_apiError$message3.includes('fetch'))||((_apiError$message4=apiError.message)===null||_apiError$message4===void 0?void 0:_apiError$message4.includes('network'))||apiError.name==='TypeError'||((_apiError$message5=apiError.message)===null||_apiError$message5===void 0?void 0:_apiError$message5.includes('Failed to fetch'));const isServerError=(_apiError$message6=apiError.message)===null||_apiError$message6===void 0?void 0:_apiError$message6.includes('SERVER_ERROR');const isCorsError=(_apiError$message7=apiError.message)===null||_apiError$message7===void 0?void 0:_apiError$message7.includes('CORS_ERROR');if(isCorsError){logger.error('CORS error in health search:',apiError);setLoadingMessage('Configuration hiccup! 🔧 Our team is fixing this - try again later!');}else if(isNetworkError){logger.error('Network error in health search:',apiError);setLoadingMessage('Connection trouble! 🌐 Our servers might be napping...');}else if(isServerError){logger.error('Server error in health search:',apiError);setLoadingMessage('Our servers are taking a coffee break ☕ Come back in a few minutes!');}else{logger.error('Health search service failed:',apiError);setLoadingMessage('Search hit a snag! 🔍 Please try again later.');}// Show error message for a few seconds then reset\nsetTimeout(()=>{setIsLoading(false);setLoadingMessage('Searching...');},4000);return;}}catch(error){// Handle AbortError specifically\nif(error.name==='AbortError'){logger.debug('Search request was cancelled');return;// Exit early\n}logger.error(\"Search error:\",error);// Check for specific error types\nconst errorMessage=error.message||'';if(errorMessage.includes('CORS_ERROR')){setLoadingMessage('Configuration issue! 🔧 Our team is working on this - please try again later!');}else if(errorMessage.includes('NETWORK_ERROR')||errorMessage.includes('TIMEOUT_ERROR')){setLoadingMessage('Oops! Our servers are taking a coffee break ☕ Come back in a few minutes!');}else if(errorMessage.includes('SERVER_ERROR')){setLoadingMessage('Server hiccup! 🤖 Please try again in a moment.');}else if(errorMessage.includes('fetch')||errorMessage.includes('network')||error.name==='TypeError'){setLoadingMessage('Connection trouble! 📡 Please check your internet and try again.');}else{setLoadingMessage('Something went wrong! Please try your search again 🔄');}setTimeout(()=>{setIsLoading(false);setLoadingMessage('Searching...');},4000);// Give a bit more time to read the friendly message\n}};/**\r\n   * SEARCH CANCELLATION HANDLER\r\n   * Cancels in-progress search requests and resets loading state\r\n   * Called when user clicks the cancel button in loading overlay\r\n   */const handleCancelSearch=()=>{if(abortControllerRef.current){abortControllerRef.current.abort();abortControllerRef.current=null;}setIsLoading(false);setLoadingMessage('Searching...');};// ================================\n// IMAGE ANALYSIS FUNCTIONALITY\n// ================================\n/**\r\n   * IMAGE ANALYSIS COMPLETION HANDLER\r\n   * Processes results from image upload and food recognition\r\n   * Triggered when ImageUploadModal completes food detection\r\n   * @param foodName - The detected food name from image analysis\r\n   */const handleAnalysisComplete=async foodName=>{if(!foodName||isLoading){setIsUploadModalOpen(false);return;}// Create abort controller for this request too\nabortControllerRef.current=new AbortController();const signal=abortControllerRef.current.signal;setIsLoading(true);setLoadingMessage('Processing image analysis...');try{console.log(\"Image analysis completed, food detected:\",foodName);setSearchQuery(foodName);// Search for nutrition data using WiHy API (cache managed by API)\nsetLoadingMessage('Analyzing nutrition content...');try{logger.debug('Making WiHy API nutrition search for:',foodName);const wihyResponse=await wihyAPI.searchNutrition(foodName);if(wihyResponse.success){// Handle both unified and legacy response formats\nlet summary='Nutrition information provided';if('data'in wihyResponse){var _data2;// New unified API response format\nsummary=((_data2=wihyResponse.data)===null||_data2===void 0?void 0:_data2.response)||summary;}else{var _wihy_response2;// Legacy WihyResponse format\nsummary=((_wihy_response2=wihyResponse.wihy_response)===null||_wihy_response2===void 0?void 0:_wihy_response2.core_principle)||summary;}// Convert WiHy response to expected format\nconst nutritionResults={summary:summary,details:wihyAPI.formatWihyResponse(wihyResponse),sources:wihyAPI.extractCitations(wihyResponse),recommendations:wihyAPI.extractRecommendations(wihyResponse),relatedTopics:[],medicalDisclaimer:'This guidance is based on evidence-based health principles. Always consult healthcare professionals for personalized medical advice.',dataSource:'wihy'};const isValidResult=nutritionResults&&typeof nutritionResults==='object'&&nutritionResults!==null&&(nutritionResults.summary||nutritionResults.details||Object.keys(nutritionResults).length>0);if(isValidResult){// Nutrition analysis complete - cache is managed by the API\nsetLoadingMessage('Nutrition analysis complete!');await new Promise(resolve=>setTimeout(resolve,300));setIsLoading(false);// Pass the fresh nutrition results via navigation state\nnavigate(\"/results?q=\".concat(encodeURIComponent(foodName)),{state:{results:nutritionResults,dataSource:'wihy',fromSearch:true}});return;}else{throw new Error('WiHy API returned invalid nutrition results');}}else{throw new Error('WiHy nutrition API request failed');}}catch(nutritionError){logger.error('Nutrition analysis failed:',nutritionError);setLoadingMessage('Hmm, we couldn\\'t figure out what that food is 🤔 Try a different photo or search manually!');setTimeout(()=>{setIsLoading(false);setLoadingMessage('Searching...');},4000);return;}}catch(error){var _error$message,_error$message2;logger.error(\"Error processing analyzed food:\",error);const isNetworkError=((_error$message=error.message)===null||_error$message===void 0?void 0:_error$message.includes('fetch'))||((_error$message2=error.message)===null||_error$message2===void 0?void 0:_error$message2.includes('network'))||error.name==='TypeError';if(isNetworkError){setLoadingMessage('Oops! Connection hiccup 📡 Please try again in a moment!');}else{setLoadingMessage('Food analysis had a little hiccup 🍎 Please try again!');}setTimeout(()=>{setIsLoading(false);setLoadingMessage('Searching...');},2000);}finally{setIsUploadModalOpen(false);}};// ================================\n// LIFECYCLE HOOKS\n// ================================\n/**\r\n   * CLEANUP EFFECT\r\n   * Resets loading state when component unmounts\r\n   * Prevents memory leaks and state persistence issues\r\n   */useEffect(()=>{return()=>{setIsLoading(false);setLoadingMessage('Searching...');};},[]);// Add this with your other useEffects\nuseEffect(()=>{// Call autoSize whenever searchQuery changes\nif(searchQuery!==undefined){autoSize();}},[searchQuery]);// Auto-show news feed on mobile devices\nuseEffect(()=>{const checkMobile=()=>{const isMobile=window.innerWidth<=768||'ontouchstart'in window;if(isMobile&&!showFeelingHealthyContent){setShowFeelingHealthyContent(true);}};// Check on mount\ncheckMobile();// Check on resize\nwindow.addEventListener('resize',checkMobile);return()=>{window.removeEventListener('resize',checkMobile);};},[showFeelingHealthyContent]);// Rotating placeholder effect\nuseEffect(()=>{const interval=setInterval(()=>{setPlaceholder(prev=>{const nextIndex=(rotatingPrompts.indexOf(prev)+1)%rotatingPrompts.length;return rotatingPrompts[nextIndex];});},4000);// rotate every 4 seconds\nreturn()=>clearInterval(interval);},[]);// ================================\n// UI COMPONENTS\n// ================================\n/**\r\n   * LOADING OVERLAY COMPONENT\r\n   * Shows animated loading screen with progress bar during search operations\r\n   * @param message - Current loading message to display\r\n   * @param progress - Progress percentage (0-100) for progress bar\r\n   */const LoadingOverlay=_ref=>{let{message,progress}=_ref;return/*#__PURE__*/_jsx(\"div\",{style:{position:'fixed',top:0,left:0,right:0,bottom:0,backgroundColor:'rgba(0, 0, 0, 0.5)',display:'flex',alignItems:'center',justifyContent:'center',zIndex:9999},children:/*#__PURE__*/_jsxs(\"div\",{style:{backgroundColor:'white',borderRadius:'12px',padding:'40px',textAlign:'center',minWidth:'320px',boxShadow:'0 10px 25px rgba(0, 0, 0, 0.2)'},children:[/*#__PURE__*/_jsx(\"div\",{style:{margin:'0 auto 24px auto'},children:/*#__PURE__*/_jsx(\"img\",{src:\"/assets/whatishealthyspinner.gif\",alt:\"Loading...\",style:{width:'48px',height:'48px',objectFit:'contain'}})}),/*#__PURE__*/_jsx(\"h3\",{style:{margin:'0 0 8px 0',fontSize:'24px',fontWeight:'600',color:'#1f2937'},children:\"Loading Content\"}),/*#__PURE__*/_jsx(\"p\",{style:{margin:'0 0 24px 0',fontSize:'16px',color:'#6b7280'},children:\"Please wait while we process your request...\"}),/*#__PURE__*/_jsx(\"div\",{style:{width:'100%',height:'8px',backgroundColor:'#e5e7eb',borderRadius:'4px',overflow:'hidden',marginBottom:'12px'},children:/*#__PURE__*/_jsx(\"div\",{style:{width:\"\".concat(progress,\"%\"),height:'100%',backgroundColor:'#3b82f6',borderRadius:'4px',transition:'width 0.3s ease'}})}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',justifyContent:'space-between',marginTop:'16px'},children:[/*#__PURE__*/_jsxs(\"p\",{style:{margin:0,fontSize:'14px',color:'#6b7280'},children:[progress,\"% Complete\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleCancelSearch,style:{backgroundColor:'transparent',color:'#555',border:'1px solid #ccc',borderRadius:'16px',padding:'8px 16px',fontSize:'14px',fontWeight:'500',cursor:'pointer',transition:'all 0.2s ease'},onMouseOver:e=>{e.currentTarget.style.backgroundColor='#f1f1f1';e.currentTarget.style.color='#333';e.currentTarget.style.borderColor='#aaa';},onMouseOut:e=>{e.currentTarget.style.backgroundColor='transparent';e.currentTarget.style.color='#555';e.currentTarget.style.borderColor='#ccc';},children:\"Cancel\"})]})]})});};// ================================\n// MAIN COMPONENT RENDER\n// ================================\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"search-landing\",children:[isLoading&&/*#__PURE__*/_jsx(LoadingOverlay,{message:loadingMessage,progress:progressFromMessage(loadingMessage)}),/*#__PURE__*/_jsx(\"div\",{style:{position:'fixed',top:'20px',right:'20px',zIndex:1000,opacity:isScrolled?0:1,visibility:isScrolled?'hidden':'visible',pointerEvents:isScrolled?'none':'auto',transition:'all 0.2s ease'},children:/*#__PURE__*/_jsx(MultiAuthLogin,{className:\"main-login-button\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"search-container-centered\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"logo-container\",children:!imageError?/*#__PURE__*/_jsx(\"img\",{src:\"/assets/wihylogo.png\",alt:\"What is Healthy?\",className:\"search-logo-image\",onError:()=>setImageError(true),onLoad:()=>setImageError(false),onClick:()=>navigate('/'),style:{cursor:'pointer'}}):/*#__PURE__*/_jsx(\"h1\",{className:\"search-logo\",onClick:()=>navigate('/'),style:{cursor:'pointer'},children:\"What is Healthy?\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"search-input-container\",children:[/*#__PURE__*/_jsx(\"form\",{onSubmit:e=>{e.preventDefault();handleSearch();},children:/*#__PURE__*/_jsx(\"textarea\",{value:searchQuery,onChange:e=>{setSearchQuery(e.target.value);},onKeyDown:e=>{if(e.key==='Enter'&&!e.shiftKey){e.preventDefault();handleSearch();}},placeholder:placeholder,className:\"search-input\",autoFocus:true,disabled:isLoading,rows:1,style:{resize:'none',overflow:'hidden',minHeight:'44px',height:'auto',paddingRight:'100px',width:'100%',// Use full width of container\nboxSizing:'border-box'// Include padding in width calculation\n},onInput:e=>{// Auto-resize height algorithm\nconst target=e.target;target.style.height='0';const scrollHeight=target.scrollHeight;target.style.height=scrollHeight+'px';}})}),/*#__PURE__*/_jsxs(\"div\",{className:\"search-icons\",children:[searchQuery&&/*#__PURE__*/_jsx(\"button\",{className:\"icon-button clear-button\",onClick:handleClearSearch,\"aria-label\":\"Clear\",children:/*#__PURE__*/_jsx(\"svg\",{viewBox:\"0 0 24 24\",width:\"24\",height:\"24\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z\",fill:\"currentColor\"})})}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setIsUploadModalOpen(true),className:\"icon-button\",\"aria-label\":\"Upload image\",disabled:isLoading,children:/*#__PURE__*/_jsx(\"svg\",{viewBox:\"0 0 24 24\",fill:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M9 2L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2H9zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5z\"})})}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>{if(isLoading)return;if(!('webkitSpeechRecognition'in window)){alert('Speech recognition not supported in this browser');return;}if(!recognitionRef.current){const recognition=new window.webkitSpeechRecognition();recognition.continuous=false;recognition.interimResults=false;recognition.lang='en-US';recognition.onstart=()=>setIsListening(true);recognition.onresult=event=>{const transcript=event.results[0][0].transcript;setSearchQuery(transcript);setIsListening(false);};recognition.onerror=()=>setIsListening(false);recognition.onend=()=>setIsListening(false);recognitionRef.current=recognition;}if(!isListening){recognitionRef.current.start();}else{recognitionRef.current.stop();setIsListening(false);}},className:\"icon-button \".concat(isListening?'listening':''),\"aria-label\":isListening?'Stop listening':'Start voice input',disabled:isLoading,children:/*#__PURE__*/_jsxs(\"svg\",{viewBox:\"0 0 24 24\",fill:\"currentColor\",children:[/*#__PURE__*/_jsx(\"path\",{d:\"M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.28c3.39-.49 6-3.3 6-6.72h-2z\"})]})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"search-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.preventDefault();handleSearch();},className:\"search-btn primary\",disabled:!searchQuery.trim()||isLoading,children:isLoading?loadingMessage:'Analyze Nutrition'}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{if(isLoading)return;if(showFeelingHealthyContent){// If news is showing, just close it (don't change search query)\nsetShowFeelingHealthyContent(false);}else{// Show the news feed\nsetShowFeelingHealthyContent(true);}},className:\"search-btn secondary\",type:\"button\",style:{color:'#000000'},disabled:isLoading,children:\"I'm Feeling Healthy\"})]})]}),showFeelingHealthyContent&&/*#__PURE__*/_jsx(\"div\",{className:\"feeling-healthy-section\",onClick:()=>{// Close news feed when clicking anywhere in the white space\nsetShowFeelingHealthyContent(false);},style:{position:'fixed',top:0,left:0,right:0,bottom:0,backgroundColor:'rgba(255, 255, 255, 0.95)',backdropFilter:'blur(2px)',zIndex:1000,overflow:'auto',cursor:'pointer'},children:/*#__PURE__*/_jsx(\"div\",{onClick:e=>e.stopPropagation(),style:{maxWidth:'1200px',margin:'40px auto',padding:'20px',cursor:'default'},children:/*#__PURE__*/_jsx(HealthNewsFeed,{maxArticles:6,setSearchQuery:setSearchQuery,triggerSearch:customQuery=>{setShowFeelingHealthyContent(false);// Close news feed\n// Use the custom query if provided, otherwise use current searchQuery\nif(customQuery){handleSearch(customQuery);}else{handleSearch();}}})})}),/*#__PURE__*/_jsx(ImageUploadModal,{isOpen:isUploadModalOpen,onClose:()=>setIsUploadModalOpen(false)// FIXED: Changed from setIsUploadModal to setIsUploadModalOpen\n,onAnalysisComplete:handleAnalysisComplete,title:\"Upload Image\",subtitle:\"Upload Image for Analysis\"})]});};export default VHealthSearch;/* Add this CSS to your styles\r\n@keyframes spin {\r\n  0% { transform: rotate(0deg); }\r\n  100% { transform: rotate(360deg); }\r\n}\r\n*/","map":{"version":3,"names":["React","useState","useRef","useEffect","useNavigate","ImageUploadModal","MultiAuthLogin","wihyAPI","HealthNewsFeed","logger","jsx","_jsx","jsxs","_jsxs","rotatingPrompts","VHealthSearch","searchQuery","setSearchQuery","isListening","setIsListening","isUploadModalOpen","setIsUploadModalOpen","isLoading","setIsLoading","imageError","setImageError","loadingMessage","setLoadingMessage","showFeelingHealthyContent","setShowFeelingHealthyContent","isScrolled","setIsScrolled","placeholder","setPlaceholder","navigate","searchInputRef","recognitionRef","abortControllerRef","document","body","classList","add","documentElement","remove","handleScroll","scrollY","window","threshold","addEventListener","passive","removeEventListener","forceAnimation","container","querySelector","navigator","maxTouchPoints","style","setProperty","position","animateSweep","concat","setTimeout","requestAnimationFrame","debug","timeoutId","mountTimeout","clearTimeout","progressFromMessage","msg","includes","autoSize","el","trim","height","overflowY","next","scrollHeight","max","parseFloat","getComputedStyle","maxHeight","handleClearSearch","handleUserChange","user","console","log","handleSignIn","handleSignOut","handleSearch","queryParam","queryToUse","current","AbortController","signal","query","apiRequest","wihyResponse","searchHealth","success","summary","_data","data","response","_wihy_response","wihy_response","core_principle","searchResults","details","formatWihyResponse","sources","extractCitations","recommendations","extractRecommendations","relatedTopics","medicalDisclaimer","dataSource","isValidResult","Object","keys","length","info","Promise","resolve","encodeURIComponent","state","results","fromSearch","Error","apiError","_apiError$message","_apiError$message2","_apiError$message3","_apiError$message4","_apiError$message5","_apiError$message6","_apiError$message7","name","isNetworkError","message","isServerError","isCorsError","error","errorMessage","handleCancelSearch","abort","handleAnalysisComplete","foodName","searchNutrition","_data2","_wihy_response2","nutritionResults","nutritionError","_error$message","_error$message2","undefined","checkMobile","isMobile","innerWidth","interval","setInterval","prev","nextIndex","indexOf","clearInterval","LoadingOverlay","_ref","progress","top","left","right","bottom","backgroundColor","display","alignItems","justifyContent","zIndex","children","borderRadius","padding","textAlign","minWidth","boxShadow","margin","src","alt","width","objectFit","fontSize","fontWeight","color","overflow","marginBottom","transition","marginTop","onClick","border","cursor","onMouseOver","e","currentTarget","borderColor","onMouseOut","className","opacity","visibility","pointerEvents","onError","onLoad","onSubmit","preventDefault","value","onChange","target","onKeyDown","key","shiftKey","autoFocus","disabled","rows","resize","minHeight","paddingRight","boxSizing","onInput","viewBox","d","fill","type","alert","recognition","webkitSpeechRecognition","continuous","interimResults","lang","onstart","onresult","event","transcript","onerror","onend","start","stop","backdropFilter","stopPropagation","maxWidth","maxArticles","triggerSearch","customQuery","isOpen","onClose","onAnalysisComplete","title","subtitle"],"sources":["C:/repo/wihy_ui/client/src/components/search/VHealthSearch.tsx"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport '../../styles/VHealthSearch.css';\r\nimport ImageUploadModal from '../ui/ImageUploadModal';\r\nimport MultiAuthLogin from '../shared/MultiAuthLogin';\r\nimport { wihyAPI } from '../../services/wihyAPI';\r\nimport { searchCache } from '../../services/searchCache';\r\nimport { foodAnalysisService } from '../../services/foodAnalysisService';\r\nimport HealthNewsFeed from '../HealthNewsFeed';\r\nimport { getApiEndpoint } from '../../config/apiConfig';\r\nimport { logger } from '../../utils/logger';\r\n\r\nconst rotatingPrompts = [\r\n  \"Ask me what is healthy\",\r\n  \"Do we really need to eat several small meals per day?\",\r\n  \"What's the real truth about detox?\",\r\n  \"Why doesn't cleansing actually heal the body?\",\r\n  \"What does it mean to rediscover real food?\",\r\n  \"When did food become a prescription instead of nourishment?\",\r\n  \"What do we really know about the metabolism?\",\r\n  \"Is the thyroid the whole story—or just part of it?\",\r\n  \"How are food and fertility connected to our future?\",\r\n  \"What's the hidden cost of convenience in modern life?\",\r\n  \"What exactly happened in the year 2000 that changed our health?\",\r\n  \"How did disconnection start replacing love?\"\r\n];\r\n\r\nconst VHealthSearch: React.FC = () => {\r\n  // ================================\r\n  // STATE MANAGEMENT\r\n  // ================================\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [isListening, setIsListening] = useState(false);\r\n  const [isUploadModalOpen, setIsUploadModalOpen] = useState(false);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [imageError, setImageError] = useState(false);\r\n  const [loadingMessage, setLoadingMessage] = useState('Searching...');\r\n  const [showFeelingHealthyContent, setShowFeelingHealthyContent] = useState(false);\r\n  const [isScrolled, setIsScrolled] = useState(false);\r\n  const [placeholder, setPlaceholder] = useState(rotatingPrompts[0]);\r\n  \r\n  const navigate = useNavigate();\r\n  const searchInputRef = useRef<HTMLInputElement>(null);\r\n  const recognitionRef = useRef<any>(null);\r\n  const abortControllerRef = useRef<AbortController | null>(null);\r\n\r\n  // ================================\r\n  // PREVENT SCROLLBARS ON LANDING PAGE\r\n  // ================================\r\n  useEffect(() => {\r\n    // Add class to body to hide scrollbars on landing page\r\n    document.body.classList.add('landing-page-active');\r\n    document.documentElement.classList.add('landing-page-active');\r\n    \r\n    // Cleanup when component unmounts or navigates away\r\n    return () => {\r\n      document.body.classList.remove('landing-page-active');\r\n      document.documentElement.classList.remove('landing-page-active');\r\n    };\r\n  }, []);\r\n\r\n  // ================================\r\n  // ALLOW SCROLLING WHEN NEWS FEED IS OPEN\r\n  // ================================\r\n  useEffect(() => {\r\n    if (showFeelingHealthyContent) {\r\n      // Remove landing page classes to allow scrolling when news feed is open\r\n      document.body.classList.remove('landing-page-active');\r\n      document.documentElement.classList.remove('landing-page-active');\r\n    } else {\r\n      // Re-add landing page classes when news feed is closed\r\n      document.body.classList.add('landing-page-active');\r\n      document.documentElement.classList.add('landing-page-active');\r\n    }\r\n  }, [showFeelingHealthyContent]);\r\n\r\n  // ================================\r\n  // SCROLL DETECTION FOR LOGIN BUTTON\r\n  // ================================\r\n  useEffect(() => {\r\n    const handleScroll = () => {\r\n      const scrollY = window.scrollY;\r\n      const threshold = 10; // Hide login button when scrolled more than 10px\r\n      setIsScrolled(scrollY > threshold);\r\n    };\r\n\r\n    // Check initial scroll position\r\n    handleScroll();\r\n    \r\n    window.addEventListener('scroll', handleScroll, { passive: true });\r\n    \r\n    return () => {\r\n      window.removeEventListener('scroll', handleScroll);\r\n    };\r\n  }, []);\r\n\r\n  // ================================\r\n  // FORCE MOBILE ANIMATION\r\n  // ================================\r\n  useEffect(() => {\r\n    // Force the animation to work on mobile by applying it directly\r\n    const forceAnimation = () => {\r\n      const container = document.querySelector('.search-input-container') as HTMLElement;\r\n      if (container) {\r\n        // Try a simpler animation approach for mobile\r\n        if ('ontouchstart' in window || navigator.maxTouchPoints > 0) {\r\n          // Mobile-specific animation using background-position sweep (matching desktop pattern)\r\n          container.style.setProperty('border', '2px solid transparent', 'important');\r\n          container.style.setProperty('background', `\r\n            linear-gradient(#fff, #fff) padding-box,\r\n            linear-gradient(90deg, #fa5f06, #ffffff, #C0C0C0, #4cbb17, #1a73e8) border-box\r\n          `, 'important');\r\n          container.style.setProperty('background-size', '100% 100%, 200% 100%', 'important');\r\n          container.style.setProperty('animation', 'none', 'important');\r\n          \r\n          // Use background-position animation to match desktop sweep pattern\r\n          let position = 0;\r\n          const animateSweep = () => {\r\n            position = (position + 1) % 200; // 0 to 200% like the original\r\n            container.style.setProperty('background-position', `0 0, ${position}% 0`, 'important');\r\n            setTimeout(() => requestAnimationFrame(animateSweep), 22); // ~2.2s for full cycle (200 * 22ms ≈ 4.4s)\r\n          };\r\n          animateSweep();\r\n          \r\n          container.classList.add('force-mobile-animation');\r\n          logger.debug('Mobile device detected - custom gradient animation started');\r\n        } else {\r\n          // Desktop - use CSS animation\r\n          container.style.setProperty('animation', 'wiH-border-sweep 2.2s linear infinite', 'important');\r\n          container.style.setProperty('background', `\r\n            linear-gradient(#fff, #fff) padding-box,\r\n            linear-gradient(90deg, #fa5f06, #ffffff, #C0C0C0, #4cbb17, #1a73e8) border-box\r\n          `, 'important');\r\n          container.style.setProperty('background-size', '100% 100%, 200% 100%', 'important');\r\n          container.style.setProperty('border', '2px solid transparent', 'important');\r\n          logger.debug('Desktop animation applied');\r\n        }\r\n        \r\n        logger.debug('Forced animation applied to search container');\r\n      }\r\n    };\r\n\r\n    // Apply immediately and also after a short delay to ensure it sticks\r\n    forceAnimation();\r\n    const timeoutId = setTimeout(forceAnimation, 100);\r\n    \r\n    // Also apply when the component mounts fully\r\n    const mountTimeout = setTimeout(forceAnimation, 500);\r\n    \r\n    return () => {\r\n      clearTimeout(timeoutId);\r\n      clearTimeout(mountTimeout);\r\n    };\r\n  }, []);\r\n\r\n  // ================================\r\n  // UTILITY FUNCTIONS\r\n  // ================================\r\n\r\n  /**\r\n   * PROGRESS CALCULATOR\r\n   * Converts loading message text to progress percentage for UI feedback\r\n   * @param msg - The current loading message\r\n   * @returns Progress percentage (0-100)\r\n   */\r\n  const progressFromMessage = (msg: string) => {\r\n    if (msg.includes('Initializing')) return 10;\r\n    if (msg.includes('Checking cache')) return 25;\r\n    if (msg.includes('Analyzing with AI')) return 55;\r\n    if (msg.includes('Processing results')) return 75;\r\n    if (msg.includes('Results ready') || msg.includes('Response ready')) return 95;\r\n\r\n    if (msg.includes('Processing image')) return 35;\r\n    if (msg.includes('Checking nutrition')) return 45;\r\n    if (msg.includes('Analyzing nutrition')) return 60;\r\n    if (msg.includes('Processing nutrition')) return 80;\r\n    if (msg.includes('complete')) return 95;\r\n\r\n    if (msg.includes('failed')) return 100; // will close shortly\r\n    return 40; // default midpoint\r\n  };\r\n\r\n  /**\r\n   * AUTO-SIZE TEXT AREA\r\n   * Dynamically adjusts the height of the search input based on content\r\n   */\r\n  const autoSize = () => {\r\n    const el = document.querySelector('.search-input') as HTMLTextAreaElement;\r\n    if (!el) return;\r\n    \r\n    // Reset to default height when empty\r\n    if (!searchQuery.trim()) {\r\n      el.style.height = '44px'; // Default height\r\n      el.style.overflowY = 'hidden';\r\n      return;\r\n    }\r\n    \r\n    // Otherwise handle auto-sizing as before\r\n    el.style.height = \"auto\";\r\n    const next = el.scrollHeight;\r\n    el.style.height = next + \"px\";\r\n    \r\n    // Check if we've hit max height\r\n    const max = parseFloat(getComputedStyle(el).maxHeight);\r\n    el.style.overflowY = next > max ? \"auto\" : \"hidden\";\r\n  };\r\n  \r\n  /**\r\n   * CLEAR SEARCH INPUT\r\n   * Clears search input and resets its height to default\r\n   */\r\n  const handleClearSearch = () => {\r\n    setSearchQuery('');\r\n    // Force a reset after state update\r\n    setTimeout(() => {\r\n      const el = document.querySelector('.search-input') as HTMLTextAreaElement;\r\n      if (el) el.style.height = '44px';\r\n    }, 10);\r\n  };\r\n\r\n  // ================================\r\n  // AUTHENTICATION HANDLERS\r\n  // ================================\r\n\r\n  /**\r\n   * USER CHANGE HANDLER\r\n   * Handles when user authentication state changes\r\n   * @param user - User object from auth service\r\n   */\r\n  const handleUserChange = (user: any) => {\r\n    console.log('User changed:', user);\r\n  };\r\n\r\n  /**\r\n   * SIGN IN HANDLER\r\n   * Handles successful user sign-in\r\n   * @param user - Authenticated user object\r\n   */\r\n  const handleSignIn = (user: any) => {\r\n    console.log('User signed in:', user);\r\n  };\r\n\r\n  /**\r\n   * SIGN OUT HANDLER\r\n   * Handles user sign-out action\r\n   */\r\n  const handleSignOut = () => {\r\n    console.log('User signed out');\r\n  };\r\n\r\n  // ================================\r\n  // MAIN SEARCH FUNCTIONALITY\r\n  // ================================\r\n\r\n  /**\r\n   * MAIN SEARCH HANDLER\r\n   * Primary search function that handles text-based health queries\r\n   * Flow: Check cache → API call → Save to cache → Navigate to results\r\n   * Uses 4-step fallback strategy for reliability\r\n   */\r\n  const handleSearch = async (queryParam?: string) => {\r\n    const queryToUse = queryParam || searchQuery;\r\n    if (!queryToUse.trim() || isLoading) return;\r\n    \r\n    // Create new AbortController for this request\r\n    abortControllerRef.current = new AbortController();\r\n    const signal = abortControllerRef.current.signal;\r\n    \r\n    setIsLoading(true);\r\n    setLoadingMessage('Initializing search...');\r\n    \r\n    try {\r\n      // Get fresh results from WiHy API (cache is managed by the API)\r\n      setLoadingMessage('Analyzing with AI...');\r\n      logger.debug('Getting fresh results for query', { query: queryToUse });\r\n      \r\n      try {\r\n        // Use WiHy Unified API for search\r\n        logger.apiRequest('WiHy API search', { query: queryToUse });\r\n        const wihyResponse = await wihyAPI.searchHealth(queryToUse);\r\n        \r\n        if (wihyResponse.success) {\r\n          // Handle both unified and legacy response formats\r\n          let summary = 'Health information provided';\r\n          if ('data' in wihyResponse) {\r\n            // New unified API response format\r\n            summary = (wihyResponse as any).data?.response || summary;\r\n          } else {\r\n            // Legacy WihyResponse format\r\n            summary = (wihyResponse as any).wihy_response?.core_principle || summary;\r\n          }\r\n          \r\n          // Convert WiHy response to expected format\r\n          const searchResults = {\r\n            summary: summary,\r\n            details: wihyAPI.formatWihyResponse(wihyResponse),\r\n            sources: wihyAPI.extractCitations(wihyResponse),\r\n            recommendations: wihyAPI.extractRecommendations(wihyResponse),\r\n            relatedTopics: [],\r\n            medicalDisclaimer: 'This guidance is based on evidence-based health principles. Always consult healthcare professionals for personalized medical advice.',\r\n            dataSource: 'wihy'\r\n          };\r\n          \r\n          console.log('WiHy search results received:', searchResults);\r\n        \r\n          const isValidResult = searchResults && \r\n            typeof searchResults === 'object' && \r\n            searchResults !== null &&\r\n            (searchResults.summary || searchResults.details || Object.keys(searchResults).length > 0);\r\n          \r\n          if (isValidResult) {\r\n            logger.info('Valid search results confirmed');\r\n            \r\n            // Results ready - cache is managed by the API\r\n            setLoadingMessage('Results ready!');\r\n            await new Promise(resolve => setTimeout(resolve, 300));\r\n            \r\n            setIsLoading(false);\r\n            logger.debug('Navigating to results page with data');\r\n            \r\n            // Pass the fresh results via navigation state\r\n            navigate(`/results?q=${encodeURIComponent(queryToUse)}`, {\r\n              state: {\r\n                results: searchResults,\r\n                dataSource: 'wihy',\r\n                fromSearch: true\r\n              }\r\n            });\r\n            return;\r\n          } else {\r\n            throw new Error('WiHy API returned invalid results');\r\n          }\r\n        } else {\r\n          throw new Error('WiHy API request failed');\r\n        }\r\n        \r\n      } catch (apiError) {\r\n        // Handle AbortError specifically\r\n        if (apiError.name === 'AbortError') {\r\n          logger.debug('API request was cancelled');\r\n          return; // Exit early\r\n        }\r\n        \r\n        const isNetworkError = apiError.message?.includes('NETWORK_ERROR') || \r\n                              apiError.message?.includes('TIMEOUT_ERROR') ||\r\n                              apiError.message?.includes('fetch') || \r\n                              apiError.message?.includes('network') || \r\n                              apiError.name === 'TypeError' ||\r\n                              apiError.message?.includes('Failed to fetch');\r\n        \r\n        const isServerError = apiError.message?.includes('SERVER_ERROR');\r\n        const isCorsError = apiError.message?.includes('CORS_ERROR');\r\n        \r\n        if (isCorsError) {\r\n          logger.error('CORS error in health search:', apiError);\r\n          setLoadingMessage('Configuration hiccup! 🔧 Our team is fixing this - try again later!');\r\n        } else if (isNetworkError) {\r\n          logger.error('Network error in health search:', apiError);\r\n          setLoadingMessage('Connection trouble! 🌐 Our servers might be napping...');\r\n        } else if (isServerError) {\r\n          logger.error('Server error in health search:', apiError);\r\n          setLoadingMessage('Our servers are taking a coffee break ☕ Come back in a few minutes!');\r\n        } else {\r\n          logger.error('Health search service failed:', apiError);\r\n          setLoadingMessage('Search hit a snag! 🔍 Please try again later.');\r\n        }\r\n        \r\n        // Show error message for a few seconds then reset\r\n        setTimeout(() => {\r\n          setIsLoading(false);\r\n          setLoadingMessage('Searching...');\r\n        }, 4000);\r\n        return;\r\n      }\r\n        \r\n    } catch (error) {\r\n      // Handle AbortError specifically\r\n      if (error.name === 'AbortError') {\r\n        logger.debug('Search request was cancelled');\r\n        return; // Exit early\r\n      }\r\n      \r\n      logger.error(\"Search error:\", error);\r\n      \r\n      // Check for specific error types\r\n      const errorMessage = error.message || '';\r\n      \r\n      if (errorMessage.includes('CORS_ERROR')) {\r\n        setLoadingMessage('Configuration issue! 🔧 Our team is working on this - please try again later!');\r\n      } else if (errorMessage.includes('NETWORK_ERROR') || errorMessage.includes('TIMEOUT_ERROR')) {\r\n        setLoadingMessage('Oops! Our servers are taking a coffee break ☕ Come back in a few minutes!');\r\n      } else if (errorMessage.includes('SERVER_ERROR')) {\r\n        setLoadingMessage('Server hiccup! 🤖 Please try again in a moment.');\r\n      } else if (errorMessage.includes('fetch') || \r\n                 errorMessage.includes('network') || \r\n                 error.name === 'TypeError') {\r\n        setLoadingMessage('Connection trouble! 📡 Please check your internet and try again.');\r\n      } else {\r\n        setLoadingMessage('Something went wrong! Please try your search again 🔄');\r\n      }\r\n      \r\n      setTimeout(() => {\r\n        setIsLoading(false);\r\n        setLoadingMessage('Searching...');\r\n      }, 4000); // Give a bit more time to read the friendly message\r\n    }\r\n  };\r\n\r\n  /**\r\n   * SEARCH CANCELLATION HANDLER\r\n   * Cancels in-progress search requests and resets loading state\r\n   * Called when user clicks the cancel button in loading overlay\r\n   */\r\n  const handleCancelSearch = () => {\r\n    if (abortControllerRef.current) {\r\n      abortControllerRef.current.abort();\r\n      abortControllerRef.current = null;\r\n    }\r\n    setIsLoading(false);\r\n    setLoadingMessage('Searching...');\r\n  };\r\n\r\n  // ================================\r\n  // IMAGE ANALYSIS FUNCTIONALITY\r\n  // ================================\r\n\r\n  /**\r\n   * IMAGE ANALYSIS COMPLETION HANDLER\r\n   * Processes results from image upload and food recognition\r\n   * Triggered when ImageUploadModal completes food detection\r\n   * @param foodName - The detected food name from image analysis\r\n   */\r\n  const handleAnalysisComplete = async (foodName: string): Promise<void> => {\r\n    if (!foodName || isLoading) {\r\n      setIsUploadModalOpen(false);\r\n      return;\r\n    }\r\n\r\n    // Create abort controller for this request too\r\n    abortControllerRef.current = new AbortController();\r\n    const signal = abortControllerRef.current.signal;\r\n    \r\n    setIsLoading(true);\r\n    setLoadingMessage('Processing image analysis...');\r\n    \r\n    try {\r\n      console.log(\"Image analysis completed, food detected:\", foodName);\r\n      setSearchQuery(foodName);\r\n      \r\n      // Search for nutrition data using WiHy API (cache managed by API)\r\n      setLoadingMessage('Analyzing nutrition content...');\r\n      \r\n      try {\r\n        logger.debug('Making WiHy API nutrition search for:', foodName);\r\n        const wihyResponse = await wihyAPI.searchNutrition(foodName);\r\n        \r\n        if (wihyResponse.success) {\r\n          // Handle both unified and legacy response formats\r\n          let summary = 'Nutrition information provided';\r\n          if ('data' in wihyResponse) {\r\n            // New unified API response format\r\n            summary = (wihyResponse as any).data?.response || summary;\r\n          } else {\r\n            // Legacy WihyResponse format\r\n            summary = (wihyResponse as any).wihy_response?.core_principle || summary;\r\n          }\r\n          \r\n          // Convert WiHy response to expected format\r\n          const nutritionResults = {\r\n            summary: summary,\r\n            details: wihyAPI.formatWihyResponse(wihyResponse),\r\n            sources: wihyAPI.extractCitations(wihyResponse),\r\n            recommendations: wihyAPI.extractRecommendations(wihyResponse),\r\n            relatedTopics: [],\r\n            medicalDisclaimer: 'This guidance is based on evidence-based health principles. Always consult healthcare professionals for personalized medical advice.',\r\n            dataSource: 'wihy'\r\n          };\r\n          \r\n          const isValidResult = nutritionResults && \r\n            typeof nutritionResults === 'object' && \r\n            nutritionResults !== null &&\r\n            (nutritionResults.summary || nutritionResults.details || Object.keys(nutritionResults).length > 0);\r\n          \r\n          if (isValidResult) {\r\n            // Nutrition analysis complete - cache is managed by the API\r\n            setLoadingMessage('Nutrition analysis complete!');\r\n            await new Promise(resolve => setTimeout(resolve, 300));\r\n            \r\n            setIsLoading(false);\r\n            // Pass the fresh nutrition results via navigation state\r\n            navigate(`/results?q=${encodeURIComponent(foodName)}`, {\r\n              state: {\r\n                results: nutritionResults,\r\n                dataSource: 'wihy',\r\n                fromSearch: true\r\n              }\r\n            });\r\n            return;\r\n          } else {\r\n            throw new Error('WiHy API returned invalid nutrition results');\r\n          }\r\n        } else {\r\n          throw new Error('WiHy nutrition API request failed');\r\n        }\r\n        \r\n      } catch (nutritionError) {\r\n        logger.error('Nutrition analysis failed:', nutritionError);\r\n        \r\n        setLoadingMessage('Hmm, we couldn\\'t figure out what that food is 🤔 Try a different photo or search manually!');\r\n        setTimeout(() => {\r\n          setIsLoading(false);\r\n          setLoadingMessage('Searching...');\r\n        }, 4000);\r\n        return;\r\n      }\r\n      \r\n    } catch (error) {\r\n      logger.error(\"Error processing analyzed food:\", error);\r\n      \r\n      const isNetworkError = error.message?.includes('fetch') || \r\n                            error.message?.includes('network') || \r\n                            error.name === 'TypeError';\r\n      \r\n      if (isNetworkError) {\r\n        setLoadingMessage('Oops! Connection hiccup 📡 Please try again in a moment!');\r\n      } else {\r\n        setLoadingMessage('Food analysis had a little hiccup 🍎 Please try again!');\r\n      }\r\n      \r\n      setTimeout(() => {\r\n        setIsLoading(false);\r\n        setLoadingMessage('Searching...');\r\n      }, 2000);\r\n    } finally {\r\n      setIsUploadModalOpen(false);\r\n    }\r\n  };\r\n\r\n  // ================================\r\n  // LIFECYCLE HOOKS\r\n  // ================================\r\n\r\n  /**\r\n   * CLEANUP EFFECT\r\n   * Resets loading state when component unmounts\r\n   * Prevents memory leaks and state persistence issues\r\n   */\r\n  useEffect(() => {\r\n    return () => {\r\n      setIsLoading(false);\r\n      setLoadingMessage('Searching...');\r\n    };\r\n  }, []);\r\n\r\n  // Add this with your other useEffects\r\n  useEffect(() => {\r\n    // Call autoSize whenever searchQuery changes\r\n    if (searchQuery !== undefined) {\r\n      autoSize();\r\n    }\r\n  }, [searchQuery]);\r\n\r\n  // Auto-show news feed on mobile devices\r\n  useEffect(() => {\r\n    const checkMobile = () => {\r\n      const isMobile = window.innerWidth <= 768 || 'ontouchstart' in window;\r\n      if (isMobile && !showFeelingHealthyContent) {\r\n        setShowFeelingHealthyContent(true);\r\n      }\r\n    };\r\n\r\n    // Check on mount\r\n    checkMobile();\r\n\r\n    // Check on resize\r\n    window.addEventListener('resize', checkMobile);\r\n    \r\n    return () => {\r\n      window.removeEventListener('resize', checkMobile);\r\n    };\r\n  }, [showFeelingHealthyContent]);\r\n\r\n  // Rotating placeholder effect\r\n  useEffect(() => {\r\n    const interval = setInterval(() => {\r\n      setPlaceholder(prev => {\r\n        const nextIndex = (rotatingPrompts.indexOf(prev) + 1) % rotatingPrompts.length;\r\n        return rotatingPrompts[nextIndex];\r\n      });\r\n    }, 4000); // rotate every 4 seconds\r\n    return () => clearInterval(interval);\r\n  }, []);\r\n\r\n  // ================================\r\n  // UI COMPONENTS\r\n  // ================================\r\n\r\n  /**\r\n   * LOADING OVERLAY COMPONENT\r\n   * Shows animated loading screen with progress bar during search operations\r\n   * @param message - Current loading message to display\r\n   * @param progress - Progress percentage (0-100) for progress bar\r\n   */\r\n  const LoadingOverlay: React.FC<{ message: string; progress: number }> = ({ message, progress }) => (\r\n    <div style={{\r\n      position: 'fixed',\r\n      top: 0,\r\n      left: 0,\r\n      right: 0,\r\n      bottom: 0,\r\n      backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n      display: 'flex',\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n      zIndex: 9999\r\n    }}>\r\n      <div style={{\r\n        backgroundColor: 'white',\r\n        borderRadius: '12px',\r\n        padding: '40px',\r\n        textAlign: 'center',\r\n        minWidth: '320px',\r\n        boxShadow: '0 10px 25px rgba(0, 0, 0, 0.2)'\r\n      }}>\r\n      \r\n        {/* Spinner */}\r\n        <div style={{ margin: '0 auto 24px auto' }}>\r\n          <img \r\n            src=\"/assets/whatishealthyspinner.gif\" \r\n            alt=\"Loading...\" \r\n            style={{\r\n              width: '48px',\r\n              height: '48px',\r\n              objectFit: 'contain'\r\n            }}\r\n          />\r\n        </div>\r\n        \r\n        {/* Title */}\r\n        <h3 style={{\r\n          margin: '0 0 8px 0',\r\n          fontSize: '24px',\r\n          fontWeight: '600',\r\n          color: '#1f2937'\r\n        }}>\r\n          Loading Content\r\n        </h3>\r\n        \r\n        {/* Subtitle */}\r\n        <p style={{\r\n          margin: '0 0 24px 0',\r\n          fontSize: '16px',\r\n          color: '#6b7280'\r\n        }}>\r\n          Please wait while we process your request...\r\n        </p>\r\n        \r\n        {/* Progress Bar */}\r\n        <div style={{\r\n          width: '100%',\r\n          height: '8px',\r\n          backgroundColor: '#e5e7eb',\r\n          borderRadius: '4px',\r\n          overflow: 'hidden',\r\n          marginBottom: '12px'\r\n        }}>\r\n          <div style={{\r\n            width: `${progress}%`,\r\n            height: '100%',\r\n            backgroundColor: '#3b82f6',\r\n            borderRadius: '4px',\r\n            transition: 'width 0.3s ease'\r\n          }} />\r\n        </div>\r\n        \r\n        <div style={{\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          justifyContent: 'space-between',\r\n          marginTop: '16px'\r\n        }}>\r\n          <p style={{\r\n            margin: 0,\r\n            fontSize: '14px',\r\n            color: '#6b7280'\r\n          }}>\r\n            {progress}% Complete\r\n          </p>\r\n          \r\n          {/* Cancel button */}\r\n          <button\r\n            onClick={handleCancelSearch}\r\n            style={{\r\n              backgroundColor: 'transparent',\r\n              color: '#555',\r\n              border: '1px solid #ccc',\r\n              borderRadius: '16px',\r\n              padding: '8px 16px',\r\n              fontSize: '14px',\r\n              fontWeight: '500',\r\n              cursor: 'pointer',\r\n              transition: 'all 0.2s ease'\r\n            }}\r\n            onMouseOver={(e) => {\r\n              e.currentTarget.style.backgroundColor = '#f1f1f1';\r\n              e.currentTarget.style.color = '#333';\r\n              e.currentTarget.style.borderColor = '#aaa';\r\n            }}\r\n            onMouseOut={(e) => {\r\n              e.currentTarget.style.backgroundColor = 'transparent';\r\n              e.currentTarget.style.color = '#555';\r\n              e.currentTarget.style.borderColor = '#ccc';\r\n            }}\r\n          >\r\n            Cancel\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  // ================================\r\n  // MAIN COMPONENT RENDER\r\n  // ================================\r\n\r\n  return (\r\n    <div className=\"search-landing\">\r\n      {/* LOADING OVERLAY - Shows during search operations */}\r\n      {isLoading && (\r\n        <LoadingOverlay \r\n          message={loadingMessage}\r\n          progress={progressFromMessage(loadingMessage)}\r\n        />\r\n      )}\r\n      \r\n      {/* AUTHENTICATION COMPONENT - Top-right login/logout */}\r\n      <div style={{\r\n        position: 'fixed',\r\n        top: '20px',\r\n        right: '20px',\r\n        zIndex: 1000,\r\n        opacity: isScrolled ? 0 : 1,\r\n        visibility: isScrolled ? 'hidden' : 'visible',\r\n        pointerEvents: isScrolled ? 'none' : 'auto',\r\n        transition: 'all 0.2s ease'\r\n      }}>\r\n        <MultiAuthLogin className=\"main-login-button\" />\r\n      </div>\r\n\r\n      {/* MAIN SEARCH INTERFACE */}\r\n      <div className=\"search-container-centered\">\r\n        {/* LOGO SECTION - Shows either image logo or text fallback */}\r\n        <div className=\"logo-container\">\r\n          {!imageError ? (\r\n            <img \r\n              src=\"/assets/wihylogo.png\"\r\n              alt=\"What is Healthy?\"\r\n              className=\"search-logo-image\"\r\n              onError={() => setImageError(true)}\r\n              onLoad={() => setImageError(false)}\r\n              onClick={() => navigate('/')}\r\n              style={{ cursor: 'pointer' }}\r\n            />\r\n          ) : (\r\n            <h1 \r\n              className=\"search-logo\"\r\n              onClick={() => navigate('/')}\r\n              style={{ cursor: 'pointer' }}\r\n            >\r\n              What is Healthy?\r\n            </h1>\r\n          )}\r\n        </div>\r\n        \r\n        {/* SEARCH INPUT SECTION - Main search bar with icons */}\r\n        <div className=\"search-input-container\">\r\n          <form onSubmit={(e) => { \r\n            e.preventDefault();\r\n            handleSearch();\r\n          }}>\r\n            <textarea\r\n              value={searchQuery}\r\n              onChange={(e) => {\r\n                setSearchQuery(e.target.value);\r\n              }}\r\n              onKeyDown={(e) => {\r\n                if (e.key === 'Enter' && !e.shiftKey) {\r\n                  e.preventDefault();\r\n                  handleSearch();\r\n                }\r\n              }}\r\n              placeholder={placeholder}\r\n              className=\"search-input\"\r\n              autoFocus\r\n              disabled={isLoading}\r\n              rows={1}\r\n              style={{\r\n                resize: 'none',\r\n                overflow: 'hidden',\r\n                minHeight: '44px',\r\n                height: 'auto',\r\n                paddingRight: '100px',\r\n                width: '100%', // Use full width of container\r\n                boxSizing: 'border-box' // Include padding in width calculation\r\n              }}\r\n              onInput={(e) => {\r\n                // Auto-resize height algorithm\r\n                const target = e.target as HTMLTextAreaElement;\r\n                target.style.height = '0';\r\n                const scrollHeight = target.scrollHeight;\r\n                target.style.height = scrollHeight + 'px';\r\n              }}\r\n            />\r\n          </form>\r\n\r\n          {/* SEARCH ICONS - Clear, Camera, Voice input buttons */}\r\n          <div className=\"search-icons\">\r\n            {/* CLEAR BUTTON - Clears current search query */}\r\n            {searchQuery && (\r\n              <button \r\n                className=\"icon-button clear-button\" \r\n                onClick={handleClearSearch}\r\n                aria-label=\"Clear\"\r\n              >\r\n                <svg viewBox=\"0 0 24 24\" width=\"24\" height=\"24\">\r\n                  <path d=\"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z\" fill=\"currentColor\" />\r\n                </svg>\r\n              </button>\r\n            )}\r\n            \r\n            {/* CAMERA BUTTON - Opens image upload modal */}\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => setIsUploadModalOpen(true)}\r\n              className=\"icon-button\"\r\n              aria-label=\"Upload image\"\r\n              disabled={isLoading}\r\n            >\r\n              <svg viewBox=\"0 0 24 24\" fill=\"currentColor\">\r\n                <path d=\"M9 2L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2H9zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5z\"/>\r\n              </svg>\r\n            </button>\r\n            \r\n            {/* VOICE INPUT BUTTON - Activates speech recognition */}\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => {\r\n                if (isLoading) return;\r\n                \r\n                if (!('webkitSpeechRecognition' in window)) {\r\n                  alert('Speech recognition not supported in this browser');\r\n                  return;\r\n                }\r\n\r\n                if (!recognitionRef.current) {\r\n                  const recognition = new (window as any).webkitSpeechRecognition();\r\n                  recognition.continuous = false;\r\n                  recognition.interimResults = false;\r\n                  recognition.lang = 'en-US';\r\n\r\n                  recognition.onstart = () => setIsListening(true);\r\n                  recognition.onresult = (event: any) => {\r\n                    const transcript = event.results[0][0].transcript;\r\n                    setSearchQuery(transcript);\r\n                    setIsListening(false);\r\n                  };\r\n                  recognition.onerror = () => setIsListening(false);\r\n                  recognition.onend = () => setIsListening(false);\r\n\r\n                  recognitionRef.current = recognition;\r\n                }\r\n\r\n                if (!isListening) {\r\n                  recognitionRef.current.start();\r\n                } else {\r\n                  recognitionRef.current.stop();\r\n                  setIsListening(false);\r\n                }\r\n              }}\r\n              className={`icon-button ${isListening ? 'listening' : ''}`}\r\n              aria-label={isListening ? 'Stop listening' : 'Start voice input'}\r\n              disabled={isLoading}\r\n            >\r\n              <svg viewBox=\"0 0 24 24\" fill=\"currentColor\">\r\n                <path d=\"M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z\"/>\r\n                <path d=\"M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.28c3.39-.49 6-3.3 6-6.72h-2z\"/>\r\n              </svg>\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* ACTION BUTTONS - Primary search and secondary \"feeling healthy\" */}\r\n        <div className=\"search-buttons\">\r\n          {/* PRIMARY SEARCH BUTTON - Triggers main search function */}\r\n          <button \r\n            onClick={(e) => {\r\n              e.preventDefault();\r\n              handleSearch();\r\n            }}\r\n            className=\"search-btn primary\"\r\n            disabled={!searchQuery.trim() || isLoading}\r\n          >\r\n            {isLoading ? loadingMessage : 'Analyze Nutrition'}\r\n          </button>\r\n          \r\n          {/* FEELING HEALTHY BUTTON - Shows/hides health news feed */}\r\n          <button \r\n            onClick={() => {\r\n              if (isLoading) return;\r\n              \r\n              if (showFeelingHealthyContent) {\r\n                // If news is showing, just close it (don't change search query)\r\n                setShowFeelingHealthyContent(false);\r\n              } else {\r\n                // Show the news feed\r\n                setShowFeelingHealthyContent(true);\r\n              }\r\n            }}\r\n            className=\"search-btn secondary\"\r\n            type=\"button\"\r\n            style={{ color: '#000000' }}\r\n            disabled={isLoading}\r\n          >\r\n            I'm Feeling Healthy\r\n          </button>\r\n        </div>\r\n      </div>\r\n      \r\n      {/* HEALTH NEWS FEED - Shows when \"I'm Feeling Healthy\" is active */}\r\n      {showFeelingHealthyContent && (\r\n        <div \r\n          className=\"feeling-healthy-section\"\r\n          onClick={() => {\r\n            // Close news feed when clicking anywhere in the white space\r\n            setShowFeelingHealthyContent(false);\r\n          }}\r\n          style={{\r\n            position: 'fixed',\r\n            top: 0,\r\n            left: 0,\r\n            right: 0,\r\n            bottom: 0,\r\n            backgroundColor: 'rgba(255, 255, 255, 0.95)',\r\n            backdropFilter: 'blur(2px)',\r\n            zIndex: 1000,\r\n            overflow: 'auto',\r\n            cursor: 'pointer'\r\n          }}\r\n        >\r\n          <div \r\n            onClick={(e) => e.stopPropagation()}\r\n            style={{\r\n              maxWidth: '1200px',\r\n              margin: '40px auto',\r\n              padding: '20px',\r\n              cursor: 'default'\r\n            }}\r\n          >\r\n            <HealthNewsFeed \r\n              maxArticles={6}\r\n              setSearchQuery={setSearchQuery}\r\n              triggerSearch={(customQuery?: string) => {\r\n                setShowFeelingHealthyContent(false); // Close news feed\r\n                // Use the custom query if provided, otherwise use current searchQuery\r\n                if (customQuery) {\r\n                  handleSearch(customQuery);\r\n                } else {\r\n                  handleSearch();\r\n                }\r\n              }}\r\n            />\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* IMAGE UPLOAD MODAL - Opens when camera button is clicked */}\r\n      <ImageUploadModal\r\n        isOpen={isUploadModalOpen}\r\n        onClose={() => setIsUploadModalOpen(false)} // FIXED: Changed from setIsUploadModal to setIsUploadModalOpen\r\n        onAnalysisComplete={handleAnalysisComplete}\r\n        title=\"Upload Image\"\r\n        subtitle=\"Upload Image for Analysis\"\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default VHealthSearch;\r\n\r\n/* Add this CSS to your styles\r\n@keyframes spin {\r\n  0% { transform: rotate(0deg); }\r\n  100% { transform: rotate(360deg); }\r\n}\r\n*/"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}