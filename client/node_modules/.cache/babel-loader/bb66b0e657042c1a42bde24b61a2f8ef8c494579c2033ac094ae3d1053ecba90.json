{"ast":null,"code":"class OpenAIHealthService {\n  constructor() {\n    this.apiKey = void 0;\n    this.model = void 0;\n    this.queryLog = void 0;\n    // Add the isConfigured method\n    this.isConfigured = () => {\n      return Boolean(this.apiKey && this.apiKey.trim().length > 0);\n    };\n    this.searchHealthInfo = async query => {\n      console.log(`Searching for health info: ${query}`);\n\n      // Initial log with just the query\n      this.logQuery(query);\n      try {\n        if (!this.isConfigured()) {\n          console.warn(\"OpenAI API key not configured, using fallback data\");\n          return this.getFallbackResults(query);\n        }\n\n        // Optional: Check content moderation (can be skipped for speed)\n        // const isAppropriate = await this.moderateQuery(query);\n        // if (!isAppropriate) {\n        //   return this.getInappropriateContentResponse();\n        // }\n\n        // Make the actual API call\n        const url = 'https://api.openai.com/v1/chat/completions';\n        const response = await fetch(url, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n            'Authorization': `Bearer ${this.apiKey}`\n          },\n          body: JSON.stringify({\n            model: this.model,\n            messages: [{\n              role: 'system',\n              content: 'You are a health and nutrition expert. Provide accurate, science-based information with references. Always respond with useful information even if the query is vague.'\n            }, {\n              role: 'user',\n              content: `Please provide health and nutrition information about: ${query}. Include a brief summary, detailed information, sources, related topics, recommendations, and a medical disclaimer.`\n            }],\n            temperature: 0.3,\n            max_tokens: 800\n          })\n        });\n        if (!response.ok) {\n          console.error(\"API error:\", await response.text());\n          return this.getFallbackResults(query);\n        }\n        const data = await response.json();\n        if (!data.choices || !data.choices[0] || !data.choices[0].message) {\n          console.error(\"Unexpected API response format:\", data);\n          return this.getFallbackResults(query);\n        }\n        const content = data.choices[0].message.content;\n\n        // Extract structured information from the response\n        const summary = this.extractSummary(content);\n        const details = this.extractDetails(content);\n        const sources = this.extractRealCitations(content);\n        const recommendations = this.extractRecommendations(content);\n        const relatedTopics = this.generateRelatedTopics(query);\n\n        // Update log with full response\n        this.logQuery(query, content, sources);\n        return {\n          summary,\n          details,\n          sources,\n          relatedTopics,\n          recommendations,\n          medicalDisclaimer: \"This information is for educational purposes only and not intended as medical advice.\"\n        };\n      } catch (error) {\n        console.error(\"Error processing search request:\", error);\n        return this.getFallbackResults(query);\n      }\n    };\n    this.apiKey = process.env.REACT_APP_OPENAI_API_KEY || '';\n    this.model = 'gpt-4';\n    this.queryLog = [];\n    console.log(\"OpenAI API Service initialized\");\n    console.log(\"API Key configured:\", this.apiKey ? \"Yes\" : \"No\");\n  }\n  async moderateQuery(query) {\n    try {\n      var _data$results, _data$results$;\n      const response = await fetch('https://api.openai.com/v1/moderations', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${this.apiKey}`\n        },\n        body: JSON.stringify({\n          input: query\n        })\n      });\n      const data = await response.json();\n      const flagged = ((_data$results = data.results) === null || _data$results === void 0 ? void 0 : (_data$results$ = _data$results[0]) === null || _data$results$ === void 0 ? void 0 : _data$results$.flagged) || false;\n      if (flagged) {\n        console.warn('🚨 Query flagged by moderation:', query);\n      }\n      return !flagged;\n    } catch (error) {\n      console.error('Moderation check failed:', error);\n      return true;\n    }\n  }\n  logQuery(query, rawResponse = '', citations = []) {\n    const logEntry = {\n      timestamp: new Date().toISOString(),\n      query: query,\n      rawResponse: rawResponse,\n      citationsExtracted: citations\n    };\n    try {\n      const existingLogs = JSON.parse(localStorage.getItem('healthQueryLogs') || '[]');\n      existingLogs.push(logEntry);\n      if (existingLogs.length > 100) {\n        existingLogs.splice(0, existingLogs.length - 100);\n      }\n      localStorage.setItem('healthQueryLogs', JSON.stringify(existingLogs));\n      console.log('📝 Query logged for audit trail');\n    } catch (error) {\n      console.warn('Failed to log query:', error);\n    }\n  }\n  // Extract citations from OpenAI response\n  extractRealCitations(text) {\n    // Simple extraction of citations - improve as needed\n    const citations = [];\n    const lines = text.split('\\n');\n    for (const line of lines) {\n      if (line.match(/^\\d+\\.\\s/) || line.includes('Source:') || line.includes('Reference:')) {\n        citations.push(line.trim());\n      }\n    }\n    return citations;\n  }\n\n  // Add helper methods to extract information from the response\n  extractSummary(content) {\n    const firstParagraph = content.split('\\n\\n')[0];\n    return firstParagraph || `Information about the requested topic`;\n  }\n  extractDetails(content) {\n    // Skip the first paragraph (summary) and take the rest for details\n    const paragraphs = content.split('\\n\\n');\n    if (paragraphs.length > 1) {\n      return paragraphs.slice(1).join('\\n\\n');\n    }\n    return content;\n  }\n  extractRecommendations(content) {\n    const recommendations = [];\n    const lines = content.split('\\n');\n    let inRecommendationsSection = false;\n    for (const line of lines) {\n      if (line.toLowerCase().includes('recommendation') && line.includes(':')) {\n        inRecommendationsSection = true;\n        continue;\n      }\n      if (inRecommendationsSection && line.trim() && line.match(/^[•\\-\\*]/)) {\n        recommendations.push(line.replace(/^[•\\-\\*]\\s*/, '').trim());\n      } else if (inRecommendationsSection && line.trim() === '') {\n        inRecommendationsSection = false;\n      }\n    }\n\n    // If no recommendations found, generate some generic ones\n    if (recommendations.length === 0) {\n      recommendations.push(`Consult healthcare professionals for personalized advice`);\n      recommendations.push(`Research from reliable medical sources for more information`);\n    }\n    return recommendations;\n  }\n  generateRelatedTopics(query) {\n    const baseTopics = [\"Nutrition\", \"Health Benefits\", \"Dietary Considerations\", \"Research\"];\n    return baseTopics.map(topic => `${query} ${topic}`);\n  }\n\n  // Create a fallback response for when API calls fail\n  getFallbackResults(query) {\n    return {\n      summary: `Information about ${query}`,\n      details: `${query} is a topic related to health or nutrition. While we couldn't retrieve specific information at this moment, it's generally recommended to consider how any food or health practice fits within a balanced lifestyle.\n\nCommon nutritional advice includes eating a varied diet rich in fruits, vegetables, whole grains, lean proteins, and healthy fats. Moderation is key with most foods and health practices.\n\nFor specific health conditions or concerns, consulting with healthcare professionals is always recommended.`,\n      sources: [\"General nutrition guidelines\", \"Medical consensus on balanced diets\", \"USDA Dietary Guidelines\"],\n      relatedTopics: [`${query} nutrition facts`, `${query} health impact`, `${query} in balanced diet`, `${query} research`],\n      recommendations: [\"Consider how this fits within your overall balanced diet\", \"Consult healthcare professionals for personalized advice\", \"Research from reliable medical sources for more information\"],\n      medicalDisclaimer: \"This information is for educational purposes only and not intended as medical advice.\"\n    };\n  }\n\n  // Response for inappropriate content\n  getInappropriateContentResponse() {\n    return {\n      summary: \"We're unable to provide information on this topic\",\n      details: \"The requested information appears to be outside the scope of general health and nutrition advice that we can provide. Our service focuses on evidence-based health and nutrition information.\",\n      sources: [\"Medical ethics guidelines\", \"Content policy\"],\n      relatedTopics: [\"General nutrition guidelines\", \"Balanced diet principles\", \"Recommended daily nutrition\"],\n      recommendations: [\"Consider searching for general health and nutrition topics\", \"Consult healthcare professionals for specific medical advice\", \"Refer to reputable health resources for specialized information\"],\n      medicalDisclaimer: \"This information is for educational purposes only and not intended as medical advice.\"\n    };\n  }\n}\nexport default new OpenAIHealthService();\nexport const openaiAPI = new OpenAIHealthService();","map":{"version":3,"names":["OpenAIHealthService","constructor","apiKey","model","queryLog","isConfigured","Boolean","trim","length","searchHealthInfo","query","console","log","logQuery","warn","getFallbackResults","url","response","fetch","method","headers","body","JSON","stringify","messages","role","content","temperature","max_tokens","ok","error","text","data","json","choices","message","summary","extractSummary","details","extractDetails","sources","extractRealCitations","recommendations","extractRecommendations","relatedTopics","generateRelatedTopics","medicalDisclaimer","process","env","REACT_APP_OPENAI_API_KEY","moderateQuery","_data$results","_data$results$","input","flagged","results","rawResponse","citations","logEntry","timestamp","Date","toISOString","citationsExtracted","existingLogs","parse","localStorage","getItem","push","splice","setItem","lines","split","line","match","includes","firstParagraph","paragraphs","slice","join","inRecommendationsSection","toLowerCase","replace","baseTopics","map","topic","getInappropriateContentResponse","openaiAPI"],"sources":["C:/vHealth/vhealth/client/src/services/openaiAPI.ts"],"sourcesContent":["interface ChatGPTResponse {\r\n  summary: string;\r\n  details: string;\r\n  sources: string[];\r\n  relatedTopics: string[];\r\n  recommendations: string[];\r\n  medicalDisclaimer: string;\r\n}\r\n\r\ninterface QueryLog {\r\n  timestamp: string;\r\n  query: string;\r\n  rawResponse?: string;\r\n  citationsExtracted?: string[];\r\n}\r\n\r\nclass OpenAIHealthService {\r\n  private apiKey: string;\r\n  private model: string;\r\n  private queryLog: QueryLog[];\r\n\r\n  constructor() {\r\n    this.apiKey = process.env.REACT_APP_OPENAI_API_KEY || '';\r\n    this.model = 'gpt-4';\r\n    this.queryLog = [];\r\n    console.log(\"OpenAI API Service initialized\");\r\n    console.log(\"API Key configured:\", this.apiKey ? \"Yes\" : \"No\");\r\n  }\r\n\r\n  // Add the isConfigured method\r\n  isConfigured = (): boolean => {\r\n    return Boolean(this.apiKey && this.apiKey.trim().length > 0);\r\n  };\r\n\r\n  private async moderateQuery(query: string): Promise<boolean> {\r\n    try {\r\n      const response = await fetch('https://api.openai.com/v1/moderations', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Authorization': `Bearer ${this.apiKey}`\r\n        },\r\n        body: JSON.stringify({\r\n          input: query\r\n        })\r\n      });\r\n\r\n      const data = await response.json();\r\n      const flagged = data.results?.[0]?.flagged || false;\r\n      \r\n      if (flagged) {\r\n        console.warn('🚨 Query flagged by moderation:', query);\r\n      }\r\n      \r\n      return !flagged;\r\n    } catch (error) {\r\n      console.error('Moderation check failed:', error);\r\n      return true;\r\n    }\r\n  }\r\n\r\n  private logQuery(query: string, rawResponse: string = '', citations: string[] = []): void {\r\n    const logEntry: QueryLog = {\r\n      timestamp: new Date().toISOString(),\r\n      query: query,\r\n      rawResponse: rawResponse,\r\n      citationsExtracted: citations\r\n    };\r\n    \r\n    try {\r\n      const existingLogs = JSON.parse(localStorage.getItem('healthQueryLogs') || '[]');\r\n      existingLogs.push(logEntry);\r\n      \r\n      if (existingLogs.length > 100) {\r\n        existingLogs.splice(0, existingLogs.length - 100);\r\n      }\r\n      \r\n      localStorage.setItem('healthQueryLogs', JSON.stringify(existingLogs));\r\n      console.log('📝 Query logged for audit trail');\r\n    } catch (error) {\r\n      console.warn('Failed to log query:', error);\r\n    }\r\n  }\r\n\r\n  searchHealthInfo = async (query: string): Promise<ChatGPTResponse> => {\r\n    console.log(`Searching for health info: ${query}`);\r\n\r\n    // Initial log with just the query\r\n    this.logQuery(query);\r\n\r\n    try {\r\n      if (!this.isConfigured()) {\r\n        console.warn(\"OpenAI API key not configured, using fallback data\");\r\n        return this.getFallbackResults(query);\r\n      }\r\n\r\n      // Optional: Check content moderation (can be skipped for speed)\r\n      // const isAppropriate = await this.moderateQuery(query);\r\n      // if (!isAppropriate) {\r\n      //   return this.getInappropriateContentResponse();\r\n      // }\r\n\r\n      // Make the actual API call\r\n      const url = 'https://api.openai.com/v1/chat/completions';\r\n      \r\n      const response = await fetch(url, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Authorization': `Bearer ${this.apiKey}`\r\n        },\r\n        body: JSON.stringify({\r\n          model: this.model,\r\n          messages: [\r\n            {\r\n              role: 'system',\r\n              content: 'You are a health and nutrition expert. Provide accurate, science-based information with references. Always respond with useful information even if the query is vague.'\r\n            },\r\n            {\r\n              role: 'user',\r\n              content: `Please provide health and nutrition information about: ${query}. Include a brief summary, detailed information, sources, related topics, recommendations, and a medical disclaimer.`\r\n            }\r\n          ],\r\n          temperature: 0.3,\r\n          max_tokens: 800\r\n        })\r\n      });\r\n\r\n      if (!response.ok) {\r\n        console.error(\"API error:\", await response.text());\r\n        return this.getFallbackResults(query);\r\n      }\r\n\r\n      const data = await response.json();\r\n      \r\n      if (!data.choices || !data.choices[0] || !data.choices[0].message) {\r\n        console.error(\"Unexpected API response format:\", data);\r\n        return this.getFallbackResults(query);\r\n      }\r\n      \r\n      const content = data.choices[0].message.content;\r\n      \r\n      // Extract structured information from the response\r\n      const summary = this.extractSummary(content);\r\n      const details = this.extractDetails(content);\r\n      const sources = this.extractRealCitations(content);\r\n      const recommendations = this.extractRecommendations(content);\r\n      const relatedTopics = this.generateRelatedTopics(query);\r\n      \r\n      // Update log with full response\r\n      this.logQuery(query, content, sources);\r\n      \r\n      return {\r\n        summary,\r\n        details,\r\n        sources,\r\n        relatedTopics,\r\n        recommendations,\r\n        medicalDisclaimer: \"This information is for educational purposes only and not intended as medical advice.\"\r\n      };\r\n    } catch (error) {\r\n      console.error(\"Error processing search request:\", error);\r\n      return this.getFallbackResults(query);\r\n    }\r\n  };\r\n  \r\n  // Extract citations from OpenAI response\r\n  private extractRealCitations(text: string): string[] {\r\n    // Simple extraction of citations - improve as needed\r\n    const citations: string[] = [];\r\n    const lines = text.split('\\n');\r\n    \r\n    for (const line of lines) {\r\n      if (line.match(/^\\d+\\.\\s/) || line.includes('Source:') || line.includes('Reference:')) {\r\n        citations.push(line.trim());\r\n      }\r\n    }\r\n    \r\n    return citations;\r\n  }\r\n\r\n  // Add helper methods to extract information from the response\r\n  private extractSummary(content: string): string {\r\n    const firstParagraph = content.split('\\n\\n')[0];\r\n    return firstParagraph || `Information about the requested topic`;\r\n  }\r\n\r\n  private extractDetails(content: string): string {\r\n    // Skip the first paragraph (summary) and take the rest for details\r\n    const paragraphs = content.split('\\n\\n');\r\n    if (paragraphs.length > 1) {\r\n      return paragraphs.slice(1).join('\\n\\n');\r\n    }\r\n    return content;\r\n  }\r\n\r\n  private extractRecommendations(content: string): string[] {\r\n    const recommendations: string[] = [];\r\n    const lines = content.split('\\n');\r\n    \r\n    let inRecommendationsSection = false;\r\n    \r\n    for (const line of lines) {\r\n      if (line.toLowerCase().includes('recommendation') && line.includes(':')) {\r\n        inRecommendationsSection = true;\r\n        continue;\r\n      }\r\n      \r\n      if (inRecommendationsSection && line.trim() && line.match(/^[•\\-\\*]/)) {\r\n        recommendations.push(line.replace(/^[•\\-\\*]\\s*/, '').trim());\r\n      } else if (inRecommendationsSection && line.trim() === '') {\r\n        inRecommendationsSection = false;\r\n      }\r\n    }\r\n    \r\n    // If no recommendations found, generate some generic ones\r\n    if (recommendations.length === 0) {\r\n      recommendations.push(`Consult healthcare professionals for personalized advice`);\r\n      recommendations.push(`Research from reliable medical sources for more information`);\r\n    }\r\n    \r\n    return recommendations;\r\n  }\r\n\r\n  private generateRelatedTopics(query: string): string[] {\r\n    const baseTopics = [\"Nutrition\", \"Health Benefits\", \"Dietary Considerations\", \"Research\"];\r\n    return baseTopics.map(topic => `${query} ${topic}`);\r\n  }\r\n\r\n  // Create a fallback response for when API calls fail\r\n  private getFallbackResults(query: string): ChatGPTResponse {\r\n    return {\r\n      summary: `Information about ${query}`,\r\n      details: `${query} is a topic related to health or nutrition. While we couldn't retrieve specific information at this moment, it's generally recommended to consider how any food or health practice fits within a balanced lifestyle.\r\n\r\nCommon nutritional advice includes eating a varied diet rich in fruits, vegetables, whole grains, lean proteins, and healthy fats. Moderation is key with most foods and health practices.\r\n\r\nFor specific health conditions or concerns, consulting with healthcare professionals is always recommended.`,\r\n      sources: [\r\n        \"General nutrition guidelines\",\r\n        \"Medical consensus on balanced diets\",\r\n        \"USDA Dietary Guidelines\"\r\n      ],\r\n      relatedTopics: [\r\n        `${query} nutrition facts`,\r\n        `${query} health impact`,\r\n        `${query} in balanced diet`,\r\n        `${query} research`\r\n      ],\r\n      recommendations: [\r\n        \"Consider how this fits within your overall balanced diet\",\r\n        \"Consult healthcare professionals for personalized advice\",\r\n        \"Research from reliable medical sources for more information\"\r\n      ],\r\n      medicalDisclaimer: \"This information is for educational purposes only and not intended as medical advice.\"\r\n    };\r\n  }\r\n\r\n  // Response for inappropriate content\r\n  private getInappropriateContentResponse(): ChatGPTResponse {\r\n    return {\r\n      summary: \"We're unable to provide information on this topic\",\r\n      details: \"The requested information appears to be outside the scope of general health and nutrition advice that we can provide. Our service focuses on evidence-based health and nutrition information.\",\r\n      sources: [\"Medical ethics guidelines\", \"Content policy\"],\r\n      relatedTopics: [\r\n        \"General nutrition guidelines\",\r\n        \"Balanced diet principles\",\r\n        \"Recommended daily nutrition\"\r\n      ],\r\n      recommendations: [\r\n        \"Consider searching for general health and nutrition topics\",\r\n        \"Consult healthcare professionals for specific medical advice\",\r\n        \"Refer to reputable health resources for specialized information\"\r\n      ],\r\n      medicalDisclaimer: \"This information is for educational purposes only and not intended as medical advice.\"\r\n    };\r\n  }\r\n}\r\n\r\nexport default new OpenAIHealthService();\r\nexport const openaiAPI = new OpenAIHealthService();"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}