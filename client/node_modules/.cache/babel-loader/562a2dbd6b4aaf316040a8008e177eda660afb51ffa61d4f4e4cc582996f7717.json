{"ast":null,"code":"var _jsxFileName = \"C:\\\\repo\\\\wihy_ui\\\\client\\\\src\\\\SearchResults.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { searchCache } from './services/searchCache';\nimport ImageUploadModal from './components/ImageUploadModal';\nimport ResultQualityPie from './components/ResultQualityPie';\nimport NutritionChart from './components/NutritionChart';\nimport NovaChart from './components/NovaChart';\nimport ChatWidget from './components/ChatWidget';\nimport './styles/VHealthSearch.css';\nimport Header from './components/shared/components/Header';\nimport Spinner from './components/Spinner';\n\n/* Define default topics and resources */\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst defaultRelatedTopics = [\"Nutrition and Diet Guidelines\", \"Exercise and Physical Activity\", \"Mental Health and Wellness\", \"Preventive Care and Screenings\", \"Chronic Disease Management\", \"Healthy Lifestyle Choices\"];\nconst defaultResources = [{\n  text: \"Nutrition ED - Learn More\",\n  url: \"https://vowels.com\"\n}, {\n  text: \"Nutrition 101\",\n  url: \"https://members.vowels.com\"\n}, {\n  text: \"The World Counts\",\n  url: \"https://www.theworldcounts.com/\"\n}];\n\n// Define the dummy data for \"test\" queries\nconst dummyTestData = {\n  query: \"test\",\n  healthInfo: `I'm sorry, but your query \"test\" is too vague. Could you please provide more details or specify the type of test you are interested in? It could be a medical test, a psychological test, or a physical fitness test, among others. Please provide more context so I can give you a more accurate and helpful response.\n\n**Recommendations:**\n• Consult healthcare professionals for personalized medical advice\n• Verify information with your doctor or medical provider\n• Follow evidence-based medical guidelines\n• Seek regular medical check-ups and screenings\n\n**Sources:** NIH Guidelines, CDC & WHO Publications, PubMed and peer-reviewed studies, Academic Medical Journals, Evidence-Based Clinical Reviews\n\nThis information is based on research from reputable medical institutions and peer-reviewed journals including NIH, CDC, WHO, JAMA, NEJM, and other academic publications. It is for educational purposes only and should not replace professional medical advice, diagnosis, or treatment. Always consult with qualified healthcare providers for medical concerns.`,\n  relatedTopics: [\"Nutrition and Diet Guidelines\", \"Exercise and Physical Activity\", \"Mental Health and Wellness\", \"Preventive Care and Screenings\", \"Chronic Disease Management\", \"Healthy Lifestyle Choices\"],\n  resources: [{\n    text: \"🩺 mHealth - Mobile Health Solutions\",\n    url: \"#\"\n  }, {\n    text: \"🏥 CDC - Health Guidelines\",\n    url: \"#\"\n  }, {\n    text: \"🌍 WHO - Global Health Information\",\n    url: \"#\"\n  }]\n};\n\n// Update the SearchResultsProps interface to include the new properties\n\n// Add this function before the SearchResults component\nconst convertLinksToClickable = text => {\n  // Handle non-string inputs\n  if (!text) return null;\n\n  // If text is not a string, convert it to string first\n  if (typeof text !== 'string') {\n    // If it's an object, try to stringify it or extract meaningful content\n    if (typeof text === 'object') {\n      // If it has specific properties we can use\n      if (text.content) {\n        text = text.content;\n      } else if (text.message) {\n        text = text.message;\n      } else if (text.details) {\n        text = text.details;\n      } else {\n        // Last resort - stringify the object\n        text = JSON.stringify(text);\n      }\n    } else {\n      // Convert other types to string\n      text = String(text);\n    }\n  }\n\n  // Now we're sure text is a string, proceed with original logic\n  const urlRegex = /(https?:\\/\\/[^\\s]+)/g;\n  const parts = text.split(urlRegex);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: parts.map((part, index) => urlRegex.test(part) ? /*#__PURE__*/_jsxDEV(\"a\", {\n      href: part,\n      target: \"_blank\",\n      rel: \"noopener noreferrer\",\n      style: {\n        color: '#2563eb',\n        textDecoration: 'underline'\n      },\n      children: part\n    }, index, false, {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 11\n    }, this) : part)\n  }, void 0, false);\n};\nconst SearchResults = ({\n  query,\n  results,\n  onBackToSearch,\n  onNewSearch,\n  isLoading,\n  dataSource,\n  citations = [],\n  recommendations = [],\n  disclaimer = \"\"\n}) => {\n  _s();\n  const [input, setInput] = useState('');\n  const [image, setImage] = useState(null);\n  const [currentPhotoId, setCurrentPhotoId] = useState(null);\n  const [newQuery, setNewQuery] = useState('');\n  const [isListening, setIsListening] = useState(false);\n  const [isUploadModalOpen, setIsUploadModalOpen] = useState(false);\n  const [notification, setNotification] = useState(null);\n  const [isUploadLoading, setUploadLoading] = useState(false);\n  const [lastProcessedQuery, setLastProcessedQuery] = useState('');\n  const [imageError, setImageError] = useState(false);\n  const [isSearching, setIsSearching] = useState(false);\n  const [currentContext, setCurrentContext] = useState('search results');\n  const [windowWidth, setWindowWidth] = useState(typeof window !== 'undefined' ? window.innerWidth : 1200);\n  const [isMobile, setIsMobile] = useState(false);\n  const recognitionRef = useRef(null);\n\n  // Handle window resize for responsive layout and detect mobile\n  useEffect(() => {\n    const handleResize = () => {\n      setWindowWidth(window.innerWidth);\n    };\n    const detectMobile = () => {\n      const userAgent = navigator.userAgent || navigator.vendor;\n      const isMobileDevice = /android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(userAgent);\n      setIsMobile(isMobileDevice || window.innerWidth <= 768);\n    };\n    detectMobile();\n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Prevent body scroll when component mounts\n  useEffect(() => {\n    document.body.style.overflow = 'hidden';\n    // Add mobile viewport meta tag if not present\n    const viewportMeta = document.querySelector('meta[name=\"viewport\"]');\n    if (!viewportMeta) {\n      const meta = document.createElement('meta');\n      meta.name = 'viewport';\n      meta.content = 'width=device-width, initial-scale=1.0, viewport-fit=cover';\n      document.head.appendChild(meta);\n    }\n    return () => {\n      document.body.style.overflow = 'auto';\n    };\n  }, []);\n\n  // Check if we have valid results to display\n  const hasValidResults = results && results.trim() !== '' && !isLoading;\n\n  // Cache results when they change\n  useEffect(() => {\n    if (query && results && !isLoading) {\n      searchCache.setCachedResult(query, results, window.location.href);\n    }\n  }, [query, results, isLoading]);\n\n  // Add effect to manage body class when modal opens/closes\n  useEffect(() => {\n    if (isUploadModalOpen) {\n      document.body.classList.add('modal-open');\n    } else {\n      document.body.classList.remove('modal-open');\n    }\n    return () => {\n      document.body.classList.remove('modal-open');\n    };\n  }, [isUploadModalOpen]);\n\n  // Add cleanup effect\n  useEffect(() => {\n    return () => {\n      if (typeof image === 'string' && image.startsWith('blob:')) {\n        URL.revokeObjectURL(image);\n      }\n    };\n  }, [image]);\n\n  // Add this effect\n  useEffect(() => {\n    if (notification) {\n      const timer = setTimeout(() => {\n        setNotification(null);\n      }, 5000);\n      return () => clearTimeout(timer);\n    }\n  }, [notification]);\n\n  // Handle new search submission\n  const handleTextSubmit = async e => {\n    e.preventDefault();\n    if (!input.trim() || isLoading) return;\n    const trimmedQuery = input.trim();\n    if (trimmedQuery === lastProcessedQuery || trimmedQuery === query) {\n      console.log('Preventing duplicate search for:', trimmedQuery);\n      return;\n    }\n    console.log('User explicit search from results page:', trimmedQuery);\n    setLastProcessedQuery(trimmedQuery);\n    setIsSearching(true);\n    onNewSearch(trimmedQuery);\n  };\n\n  // Handle voice input (placeholder for now)\n  const handleVoiceInput = () => {\n    setIsListening(!isListening);\n  };\n\n  // Handle image upload\n  const handleImageUpload = event => {\n    var _event$target$files;\n    const file = (_event$target$files = event.target.files) === null || _event$target$files === void 0 ? void 0 : _event$target$files[0];\n    if (file) {\n      setImage(file);\n      setIsUploadModalOpen(true);\n    }\n  };\n\n  // Handle image upload completion\n  const handleAnalysisComplete = results => {\n    setIsUploadModalOpen(false);\n    if (results) {\n      onNewSearch(JSON.stringify(results));\n    }\n  };\n\n  // Check if this is a test query\n  const isTestQuery = query.toLowerCase() === 'test';\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"search-results-container\",\n    style: {\n      height: '100vh',\n      overflow: 'hidden'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: 'fixed',\n        top: 0,\n        left: 0,\n        right: 0,\n        zIndex: 1000,\n        backgroundColor: 'white',\n        borderBottom: '1px solid #e5e7eb',\n        paddingTop: isMobile ? 'env(safe-area-inset-top, 0px)' : '0px'\n      },\n      children: /*#__PURE__*/_jsxDEV(Header, {\n        variant: \"results\",\n        showLogin: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 285,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 275,\n      columnNumber: 7\n    }, this), (isLoading || isSearching) && /*#__PURE__*/_jsxDEV(Spinner, {\n      overlay: true,\n      title: \"Analyzing with AI...\",\n      subtitle: \"Processing your health query...\",\n      disableEsc: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 293,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: 'absolute',\n        top: isMobile ? '130px' : '80px',\n        // More space on mobile devices\n        left: '0',\n        right: '0',\n        bottom: '0',\n        overflow: 'hidden',\n        padding: isMobile ? '8px' : '20px',\n        paddingLeft: isMobile ? 'max(8px, env(safe-area-inset-left, 8px))' : '20px',\n        paddingRight: isMobile ? 'max(8px, env(safe-area-inset-right, 8px))' : '20px',\n        paddingBottom: isMobile ? 'max(8px, env(safe-area-inset-bottom, 8px))' : '20px',\n        backgroundColor: '#f8fafc'\n      },\n      children: hasValidResults ? /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'grid',\n          gridTemplateColumns: windowWidth <= 768 ? '1fr' : '2fr 1fr',\n          gridTemplateRows: windowWidth <= 768 ? '1fr 300px' : '1fr',\n          gap: '20px',\n          maxWidth: '1200px',\n          margin: '0 auto',\n          height: '100%',\n          overflow: 'hidden'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            backgroundColor: 'white',\n            borderRadius: '12px',\n            border: '1px solid #e5e7eb',\n            boxShadow: '0 1px 3px rgba(0, 0, 0, 0.1)',\n            padding: windowWidth <= 768 ? '12px' : '24px',\n            display: 'flex',\n            flexDirection: 'column',\n            overflow: 'hidden'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'space-between',\n              marginBottom: '20px'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n              style: {\n                margin: 0,\n                fontSize: '20px',\n                fontWeight: '600',\n                color: '#1f2937'\n              },\n              children: \"Health Assistant Chat\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 345,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              style: {\n                fontSize: '12px',\n                color: '#6b7280',\n                backgroundColor: '#f3f4f6',\n                padding: '4px 8px',\n                borderRadius: '4px'\n              },\n              children: dataSource.toUpperCase()\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 353,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 339,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              flex: 1,\n              overflow: 'hidden'\n            },\n            children: /*#__PURE__*/_jsxDEV(ChatWidget, {\n              isOpen: true,\n              onToggle: () => {},\n              onClose: () => {},\n              currentContext: currentContext,\n              inline: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 366,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 365,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 329,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            padding: windowWidth <= 768 ? '12px' : '20px',\n            backgroundColor: '#ffffff',\n            borderRadius: '12px',\n            boxShadow: '0 1px 3px rgba(0, 0, 0, 0.1)',\n            display: 'flex',\n            flexDirection: 'column',\n            overflow: 'hidden'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            style: {\n              marginBottom: '20px',\n              color: '#1f2937',\n              fontSize: '18px',\n              fontWeight: '600',\n              flexShrink: 0\n            },\n            children: \"Analysis Charts\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 386,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              display: 'flex',\n              flexDirection: 'column',\n              gap: '20px',\n              flex: 1,\n              overflow: 'auto',\n              paddingRight: '4px'\n            },\n            children: results && /*#__PURE__*/_jsxDEV(_Fragment, {\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                  style: {\n                    marginBottom: '12px',\n                    color: '#374151',\n                    fontSize: '14px'\n                  },\n                  children: \"Quality Analysis\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 400,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(ResultQualityPie, {\n                  query: query,\n                  results: results,\n                  dataSource: dataSource === 'wihy' ? 'vnutrition' : dataSource\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 401,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 399,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                  style: {\n                    marginBottom: '12px',\n                    color: '#374151',\n                    fontSize: '14px'\n                  },\n                  children: \"Nutrition Breakdown\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 408,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(NutritionChart, {\n                  query: query,\n                  results: results,\n                  dataSource: dataSource === 'wihy' ? 'vnutrition' : dataSource\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 409,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 407,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                  style: {\n                    marginBottom: '12px',\n                    color: '#374151',\n                    fontSize: '14px'\n                  },\n                  children: \"Processing Level\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 416,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(NovaChart, {\n                  query: query,\n                  results: results,\n                  dataSource: dataSource === 'wihy' ? 'vnutrition' : dataSource\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 417,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 415,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 389,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 377,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 317,\n        columnNumber: 11\n      }, this) : !isLoading && !isSearching && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          height: '100%',\n          textAlign: 'center',\n          padding: '40px',\n          color: '#6b7280'\n        },\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"No results to display. Try searching for something else.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 439,\n          columnNumber: 15\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 430,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 302,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(ImageUploadModal, {\n      isOpen: isUploadModalOpen,\n      onClose: () => setIsUploadModalOpen(false),\n      onAnalysisComplete: handleAnalysisComplete,\n      title: \"Upload Image\",\n      subtitle: \"Upload images for analysis\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 446,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 271,\n    columnNumber: 5\n  }, this);\n};\n_s(SearchResults, \"OwuZkD5Ow+ZvFJZKRejFejgD1ig=\");\n_c = SearchResults;\nexport default SearchResults;\nvar _c;\n$RefreshReg$(_c, \"SearchResults\");","map":{"version":3,"names":["React","useState","useEffect","useRef","searchCache","ImageUploadModal","ResultQualityPie","NutritionChart","NovaChart","ChatWidget","Header","Spinner","jsxDEV","_jsxDEV","Fragment","_Fragment","defaultRelatedTopics","defaultResources","text","url","dummyTestData","query","healthInfo","relatedTopics","resources","convertLinksToClickable","content","message","details","JSON","stringify","String","urlRegex","parts","split","children","map","part","index","test","href","target","rel","style","color","textDecoration","fileName","_jsxFileName","lineNumber","columnNumber","SearchResults","results","onBackToSearch","onNewSearch","isLoading","dataSource","citations","recommendations","disclaimer","_s","input","setInput","image","setImage","currentPhotoId","setCurrentPhotoId","newQuery","setNewQuery","isListening","setIsListening","isUploadModalOpen","setIsUploadModalOpen","notification","setNotification","isUploadLoading","setUploadLoading","lastProcessedQuery","setLastProcessedQuery","imageError","setImageError","isSearching","setIsSearching","currentContext","setCurrentContext","windowWidth","setWindowWidth","window","innerWidth","isMobile","setIsMobile","recognitionRef","handleResize","detectMobile","userAgent","navigator","vendor","isMobileDevice","addEventListener","removeEventListener","document","body","overflow","viewportMeta","querySelector","meta","createElement","name","head","appendChild","hasValidResults","trim","setCachedResult","location","classList","add","remove","startsWith","URL","revokeObjectURL","timer","setTimeout","clearTimeout","handleTextSubmit","e","preventDefault","trimmedQuery","console","log","handleVoiceInput","handleImageUpload","event","_event$target$files","file","files","handleAnalysisComplete","isTestQuery","toLowerCase","className","height","position","top","left","right","zIndex","backgroundColor","borderBottom","paddingTop","variant","showLogin","overlay","title","subtitle","disableEsc","bottom","padding","paddingLeft","paddingRight","paddingBottom","display","gridTemplateColumns","gridTemplateRows","gap","maxWidth","margin","borderRadius","border","boxShadow","flexDirection","alignItems","justifyContent","marginBottom","fontSize","fontWeight","toUpperCase","flex","isOpen","onToggle","onClose","inline","flexShrink","textAlign","onAnalysisComplete","_c","$RefreshReg$"],"sources":["C:/repo/wihy_ui/client/src/SearchResults.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport { searchCache } from './services/searchCache';\r\nimport { photoStorageService } from './services/photoStorageService';\r\nimport { foodAnalysisService } from './components/foodAnalysisService';\r\nimport ImageUploadModal from './components/ImageUploadModal';\r\nimport MultiAuthLogin from './components/shared/components/MultiAuthLogin';\r\nimport ResultQualityPie from './components/ResultQualityPie';\r\nimport NutritionChart from './components/NutritionChart';\r\nimport NovaChart from './components/NovaChart';\r\nimport ChatWidget from './components/ChatWidget';\r\nimport './styles/VHealthSearch.css';\r\nimport Header from './components/shared/components/Header';\r\nimport Spinner from './components/Spinner';\r\n\r\n/* Define default topics and resources */\r\nconst defaultRelatedTopics = [\r\n  \"Nutrition and Diet Guidelines\",\r\n  \"Exercise and Physical Activity\", \r\n  \"Mental Health and Wellness\",\r\n  \"Preventive Care and Screenings\",\r\n  \"Chronic Disease Management\",\r\n  \"Healthy Lifestyle Choices\"\r\n];\r\n\r\nconst defaultResources = [\r\n  { text: \"Nutrition ED - Learn More\", url: \"https://vowels.com\" },\r\n  { text: \"Nutrition 101\", url: \"https://members.vowels.com\" },\r\n  { text: \"The World Counts\", url: \"https://www.theworldcounts.com/\" }\r\n];\r\n\r\n// Define the dummy data for \"test\" queries\r\nconst dummyTestData = {\r\n  query: \"test\",\r\n  healthInfo: `I'm sorry, but your query \"test\" is too vague. Could you please provide more details or specify the type of test you are interested in? It could be a medical test, a psychological test, or a physical fitness test, among others. Please provide more context so I can give you a more accurate and helpful response.\r\n\r\n**Recommendations:**\r\n• Consult healthcare professionals for personalized medical advice\r\n• Verify information with your doctor or medical provider\r\n• Follow evidence-based medical guidelines\r\n• Seek regular medical check-ups and screenings\r\n\r\n**Sources:** NIH Guidelines, CDC & WHO Publications, PubMed and peer-reviewed studies, Academic Medical Journals, Evidence-Based Clinical Reviews\r\n\r\nThis information is based on research from reputable medical institutions and peer-reviewed journals including NIH, CDC, WHO, JAMA, NEJM, and other academic publications. It is for educational purposes only and should not replace professional medical advice, diagnosis, or treatment. Always consult with qualified healthcare providers for medical concerns.`,\r\n  relatedTopics: [\r\n    \"Nutrition and Diet Guidelines\",\r\n    \"Exercise and Physical Activity\", \r\n    \"Mental Health and Wellness\",\r\n    \"Preventive Care and Screenings\",\r\n    \"Chronic Disease Management\",\r\n    \"Healthy Lifestyle Choices\"\r\n  ],\r\n  resources: [\r\n    { text: \"🩺 mHealth - Mobile Health Solutions\", url: \"#\" },\r\n    { text: \"🏥 CDC - Health Guidelines\", url: \"#\" },\r\n    { text: \"🌍 WHO - Global Health Information\", url: \"#\" }\r\n  ]\r\n};\r\n\r\n// Update the SearchResultsProps interface to include the new properties\r\ninterface SearchResultsProps {\r\n  query: string;\r\n  results: string;\r\n  onBackToSearch: () => void;\r\n  onNewSearch: (query: string) => void;\r\n  isLoading: boolean;\r\n  dataSource: \"error\" | \"openai\" | \"local\" | \"vnutrition\" | \"wihy\";\r\n  citations?: string[];\r\n  recommendations?: string[];\r\n  disclaimer?: string;\r\n}\r\n\r\n// Add this function before the SearchResults component\r\nconst convertLinksToClickable = (text: any): React.ReactNode => {\r\n  // Handle non-string inputs\r\n  if (!text) return null;\r\n  \r\n  // If text is not a string, convert it to string first\r\n  if (typeof text !== 'string') {\r\n    // If it's an object, try to stringify it or extract meaningful content\r\n    if (typeof text === 'object') {\r\n      // If it has specific properties we can use\r\n      if (text.content) {\r\n        text = text.content;\r\n      } else if (text.message) {\r\n        text = text.message;\r\n      } else if (text.details) {\r\n        text = text.details;\r\n      } else {\r\n        // Last resort - stringify the object\r\n        text = JSON.stringify(text);\r\n      }\r\n    } else {\r\n      // Convert other types to string\r\n      text = String(text);\r\n    }\r\n  }\r\n\r\n  // Now we're sure text is a string, proceed with original logic\r\n  const urlRegex = /(https?:\\/\\/[^\\s]+)/g;\r\n  const parts = text.split(urlRegex);\r\n  \r\n  return (\r\n    <>\r\n      {parts.map((part, index) => (\r\n        urlRegex.test(part) ? (\r\n          <a \r\n            key={index} \r\n            href={part} \r\n            target=\"_blank\" \r\n            rel=\"noopener noreferrer\"\r\n            style={{ color: '#2563eb', textDecoration: 'underline' }}\r\n          >\r\n            {part}\r\n          </a>\r\n        ) : (\r\n          part\r\n        )\r\n      ))}\r\n    </>\r\n  );\r\n};\r\n\r\nconst SearchResults: React.FC<SearchResultsProps> = ({\r\n  query,\r\n  results,\r\n  onBackToSearch,\r\n  onNewSearch,\r\n  isLoading,\r\n  dataSource,\r\n  citations = [],\r\n  recommendations = [],\r\n  disclaimer = \"\"\r\n}) => {\r\n  const [input, setInput] = useState('');\r\n  const [image, setImage] = useState<File | string | null>(null);\r\n  const [currentPhotoId, setCurrentPhotoId] = useState<string | null>(null);\r\n  const [newQuery, setNewQuery] = useState('');\r\n  const [isListening, setIsListening] = useState(false);\r\n  const [isUploadModalOpen, setIsUploadModalOpen] = useState(false);\r\n  const [notification, setNotification] = useState<{message: string, type: string} | null>(null);\r\n  const [isUploadLoading, setUploadLoading] = useState(false);\r\n  const [lastProcessedQuery, setLastProcessedQuery] = useState<string>('');\r\n  const [imageError, setImageError] = useState(false);\r\n  const [isSearching, setIsSearching] = useState(false);\r\n  const [currentContext, setCurrentContext] = useState<string>('search results');\r\n  const [windowWidth, setWindowWidth] = useState(typeof window !== 'undefined' ? window.innerWidth : 1200);\r\n  const [isMobile, setIsMobile] = useState(false);\r\n  const recognitionRef = useRef<any>(null);\r\n\r\n  // Handle window resize for responsive layout and detect mobile\r\n  useEffect(() => {\r\n    const handleResize = () => {\r\n      setWindowWidth(window.innerWidth);\r\n    };\r\n\r\n    const detectMobile = () => {\r\n      const userAgent = navigator.userAgent || navigator.vendor;\r\n      const isMobileDevice = /android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(userAgent);\r\n      setIsMobile(isMobileDevice || window.innerWidth <= 768);\r\n    };\r\n\r\n    detectMobile();\r\n    window.addEventListener('resize', handleResize);\r\n    return () => window.removeEventListener('resize', handleResize);\r\n  }, []);\r\n\r\n  // Prevent body scroll when component mounts\r\n  useEffect(() => {\r\n    document.body.style.overflow = 'hidden';\r\n    // Add mobile viewport meta tag if not present\r\n    const viewportMeta = document.querySelector('meta[name=\"viewport\"]');\r\n    if (!viewportMeta) {\r\n      const meta = document.createElement('meta');\r\n      meta.name = 'viewport';\r\n      meta.content = 'width=device-width, initial-scale=1.0, viewport-fit=cover';\r\n      document.head.appendChild(meta);\r\n    }\r\n    \r\n    return () => {\r\n      document.body.style.overflow = 'auto';\r\n    };\r\n  }, []);\r\n\r\n  // Check if we have valid results to display\r\n  const hasValidResults = results && results.trim() !== '' && !isLoading;\r\n  \r\n  // Cache results when they change\r\n  useEffect(() => {\r\n    if (query && results && !isLoading) {\r\n      searchCache.setCachedResult(query, results, window.location.href);\r\n    }\r\n  }, [query, results, isLoading]);\r\n\r\n  // Add effect to manage body class when modal opens/closes\r\n  useEffect(() => {\r\n    if (isUploadModalOpen) {\r\n      document.body.classList.add('modal-open');\r\n    } else {\r\n      document.body.classList.remove('modal-open');\r\n    }\r\n    \r\n    return () => {\r\n      document.body.classList.remove('modal-open');\r\n    };\r\n  }, [isUploadModalOpen]);\r\n\r\n  // Add cleanup effect\r\n  useEffect(() => {\r\n    return () => {\r\n      if (typeof image === 'string' && image.startsWith('blob:')) {\r\n        URL.revokeObjectURL(image);\r\n      }\r\n    };\r\n  }, [image]);\r\n\r\n  // Add this effect\r\n  useEffect(() => {\r\n    if (notification) {\r\n      const timer = setTimeout(() => {\r\n        setNotification(null);\r\n      }, 5000);\r\n      return () => clearTimeout(timer);\r\n    }\r\n  }, [notification]);\r\n\r\n  // Handle new search submission\r\n  const handleTextSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    if (!input.trim() || isLoading) return;\r\n    \r\n    const trimmedQuery = input.trim();\r\n    \r\n    if (trimmedQuery === lastProcessedQuery || trimmedQuery === query) {\r\n      console.log('Preventing duplicate search for:', trimmedQuery);\r\n      return;\r\n    }\r\n    \r\n    console.log('User explicit search from results page:', trimmedQuery);\r\n    setLastProcessedQuery(trimmedQuery);\r\n    setIsSearching(true);\r\n    onNewSearch(trimmedQuery);\r\n  };\r\n\r\n  // Handle voice input (placeholder for now)\r\n  const handleVoiceInput = () => {\r\n    setIsListening(!isListening);\r\n  };\r\n\r\n  // Handle image upload\r\n  const handleImageUpload = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = event.target.files?.[0];\r\n    if (file) {\r\n      setImage(file);\r\n      setIsUploadModalOpen(true);\r\n    }\r\n  };\r\n\r\n  // Handle image upload completion\r\n  const handleAnalysisComplete = (results: any) => {\r\n    setIsUploadModalOpen(false);\r\n    if (results) {\r\n      onNewSearch(JSON.stringify(results));\r\n    }\r\n  };\r\n\r\n  // Check if this is a test query\r\n  const isTestQuery = query.toLowerCase() === 'test';\r\n\r\n  return (\r\n    <div className=\"search-results-container\" style={{ \r\n      height: '100vh', \r\n      overflow: 'hidden'\r\n    }}>\r\n      <div style={{ \r\n        position: 'fixed',\r\n        top: 0,\r\n        left: 0,\r\n        right: 0,\r\n        zIndex: 1000, \r\n        backgroundColor: 'white',\r\n        borderBottom: '1px solid #e5e7eb',\r\n        paddingTop: isMobile ? 'env(safe-area-inset-top, 0px)' : '0px'\r\n      }}>\r\n        <Header\r\n          variant=\"results\"\r\n          showLogin={true}\r\n        />\r\n      </div>\r\n\r\n      {/* Show spinner when searching from header */}\r\n      {(isLoading || isSearching) && (\r\n        <Spinner\r\n          overlay={true}\r\n          title=\"Analyzing with AI...\"\r\n          subtitle=\"Processing your health query...\"\r\n          disableEsc={true}\r\n        />\r\n      )}\r\n      \r\n      {/* Main Content Area with Dashboard Layout - Fixed below header */}\r\n      <div style={{ \r\n        position: 'absolute',\r\n        top: isMobile ? '130px' : '80px', // More space on mobile devices\r\n        left: '0',\r\n        right: '0',\r\n        bottom: '0',\r\n        overflow: 'hidden',\r\n        padding: isMobile ? '8px' : '20px',\r\n        paddingLeft: isMobile ? 'max(8px, env(safe-area-inset-left, 8px))' : '20px',\r\n        paddingRight: isMobile ? 'max(8px, env(safe-area-inset-right, 8px))' : '20px',\r\n        paddingBottom: isMobile ? 'max(8px, env(safe-area-inset-bottom, 8px))' : '20px',\r\n        backgroundColor: '#f8fafc'\r\n      }}>\r\n        \r\n        {hasValidResults ? (\r\n          <div style={{\r\n            display: 'grid',\r\n            gridTemplateColumns: windowWidth <= 768 ? '1fr' : '2fr 1fr',\r\n            gridTemplateRows: windowWidth <= 768 ? '1fr 300px' : '1fr',\r\n            gap: '20px',\r\n            maxWidth: '1200px',\r\n            margin: '0 auto',\r\n            height: '100%',\r\n            overflow: 'hidden'\r\n          }}>\r\n            \r\n            {/* Chat Widget as Main Content */}\r\n            <div style={{\r\n              backgroundColor: 'white',\r\n              borderRadius: '12px',\r\n              border: '1px solid #e5e7eb',\r\n              boxShadow: '0 1px 3px rgba(0, 0, 0, 0.1)',\r\n              padding: windowWidth <= 768 ? '12px' : '24px',\r\n              display: 'flex',\r\n              flexDirection: 'column',\r\n              overflow: 'hidden'\r\n            }}>\r\n              <div style={{\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                justifyContent: 'space-between',\r\n                marginBottom: '20px'\r\n              }}>\r\n                <h2 style={{\r\n                  margin: 0,\r\n                  fontSize: '20px',\r\n                  fontWeight: '600',\r\n                  color: '#1f2937'\r\n                }}>\r\n                  Health Assistant Chat\r\n                </h2>\r\n                <span style={{\r\n                  fontSize: '12px',\r\n                  color: '#6b7280',\r\n                  backgroundColor: '#f3f4f6',\r\n                  padding: '4px 8px',\r\n                  borderRadius: '4px'\r\n                }}>\r\n                  {dataSource.toUpperCase()}\r\n                </span>\r\n              </div>\r\n\r\n              {/* Chat Widget */}\r\n              <div style={{ flex: 1, overflow: 'hidden' }}>\r\n                <ChatWidget\r\n                  isOpen={true}\r\n                  onToggle={() => {}}\r\n                  onClose={() => {}}\r\n                  currentContext={currentContext}\r\n                  inline={true}\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            {/* Charts Sidebar */}\r\n            <div style={{\r\n              padding: windowWidth <= 768 ? '12px' : '20px',\r\n              backgroundColor: '#ffffff',\r\n              borderRadius: '12px',\r\n              boxShadow: '0 1px 3px rgba(0, 0, 0, 0.1)',\r\n              display: 'flex',\r\n              flexDirection: 'column',\r\n              overflow: 'hidden'\r\n            }}>\r\n              <h3 style={{ marginBottom: '20px', color: '#1f2937', fontSize: '18px', fontWeight: '600', flexShrink: 0 }}>\r\n                Analysis Charts\r\n              </h3>\r\n              <div style={{ \r\n                display: 'flex', \r\n                flexDirection: 'column', \r\n                gap: '20px',\r\n                flex: 1,\r\n                overflow: 'auto',\r\n                paddingRight: '4px'\r\n              }}>\r\n                {results && (\r\n                  <>\r\n                    <div>\r\n                      <h4 style={{ marginBottom: '12px', color: '#374151', fontSize: '14px' }}>Quality Analysis</h4>\r\n                      <ResultQualityPie \r\n                        query={query}\r\n                        results={results} \r\n                        dataSource={dataSource === 'wihy' ? 'vnutrition' : dataSource}\r\n                      />\r\n                    </div>\r\n                    <div>\r\n                      <h4 style={{ marginBottom: '12px', color: '#374151', fontSize: '14px' }}>Nutrition Breakdown</h4>\r\n                      <NutritionChart \r\n                        query={query}\r\n                        results={results}\r\n                        dataSource={dataSource === 'wihy' ? 'vnutrition' : dataSource}\r\n                      />\r\n                    </div>\r\n                    <div>\r\n                      <h4 style={{ marginBottom: '12px', color: '#374151', fontSize: '14px' }}>Processing Level</h4>\r\n                      <NovaChart \r\n                        query={query}\r\n                        results={results}\r\n                        dataSource={dataSource === 'wihy' ? 'vnutrition' : dataSource}\r\n                      />\r\n                    </div>\r\n                  </>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        ) : (\r\n          !isLoading && !isSearching && (\r\n            <div style={{ \r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              justifyContent: 'center',\r\n              height: '100%',\r\n              textAlign: 'center', \r\n              padding: '40px',\r\n              color: '#6b7280'\r\n            }}>\r\n              <p>No results to display. Try searching for something else.</p>\r\n            </div>\r\n          )\r\n        )}\r\n      </div>\r\n\r\n      {/* ImageUploadModal - always available */}\r\n      <ImageUploadModal\r\n        isOpen={isUploadModalOpen}\r\n        onClose={() => setIsUploadModalOpen(false)}\r\n        onAnalysisComplete={handleAnalysisComplete}\r\n        title=\"Upload Image\"\r\n        subtitle=\"Upload images for analysis\"\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SearchResults;"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,EAAEC,MAAM,QAAQ,OAAO;AAC1D,SAASC,WAAW,QAAQ,wBAAwB;AAGpD,OAAOC,gBAAgB,MAAM,+BAA+B;AAE5D,OAAOC,gBAAgB,MAAM,+BAA+B;AAC5D,OAAOC,cAAc,MAAM,6BAA6B;AACxD,OAAOC,SAAS,MAAM,wBAAwB;AAC9C,OAAOC,UAAU,MAAM,yBAAyB;AAChD,OAAO,4BAA4B;AACnC,OAAOC,MAAM,MAAM,uCAAuC;AAC1D,OAAOC,OAAO,MAAM,sBAAsB;;AAE1C;AAAA,SAAAC,MAAA,IAAAC,OAAA,EAAAC,QAAA,IAAAC,SAAA;AACA,MAAMC,oBAAoB,GAAG,CAC3B,+BAA+B,EAC/B,gCAAgC,EAChC,4BAA4B,EAC5B,gCAAgC,EAChC,4BAA4B,EAC5B,2BAA2B,CAC5B;AAED,MAAMC,gBAAgB,GAAG,CACvB;EAAEC,IAAI,EAAE,2BAA2B;EAAEC,GAAG,EAAE;AAAqB,CAAC,EAChE;EAAED,IAAI,EAAE,eAAe;EAAEC,GAAG,EAAE;AAA6B,CAAC,EAC5D;EAAED,IAAI,EAAE,kBAAkB;EAAEC,GAAG,EAAE;AAAkC,CAAC,CACrE;;AAED;AACA,MAAMC,aAAa,GAAG;EACpBC,KAAK,EAAE,MAAM;EACbC,UAAU,EAAE;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qWAAqW;EACnWC,aAAa,EAAE,CACb,+BAA+B,EAC/B,gCAAgC,EAChC,4BAA4B,EAC5B,gCAAgC,EAChC,4BAA4B,EAC5B,2BAA2B,CAC5B;EACDC,SAAS,EAAE,CACT;IAAEN,IAAI,EAAE,sCAAsC;IAAEC,GAAG,EAAE;EAAI,CAAC,EAC1D;IAAED,IAAI,EAAE,4BAA4B;IAAEC,GAAG,EAAE;EAAI,CAAC,EAChD;IAAED,IAAI,EAAE,oCAAoC;IAAEC,GAAG,EAAE;EAAI,CAAC;AAE5D,CAAC;;AAED;;AAaA;AACA,MAAMM,uBAAuB,GAAIP,IAAS,IAAsB;EAC9D;EACA,IAAI,CAACA,IAAI,EAAE,OAAO,IAAI;;EAEtB;EACA,IAAI,OAAOA,IAAI,KAAK,QAAQ,EAAE;IAC5B;IACA,IAAI,OAAOA,IAAI,KAAK,QAAQ,EAAE;MAC5B;MACA,IAAIA,IAAI,CAACQ,OAAO,EAAE;QAChBR,IAAI,GAAGA,IAAI,CAACQ,OAAO;MACrB,CAAC,MAAM,IAAIR,IAAI,CAACS,OAAO,EAAE;QACvBT,IAAI,GAAGA,IAAI,CAACS,OAAO;MACrB,CAAC,MAAM,IAAIT,IAAI,CAACU,OAAO,EAAE;QACvBV,IAAI,GAAGA,IAAI,CAACU,OAAO;MACrB,CAAC,MAAM;QACL;QACAV,IAAI,GAAGW,IAAI,CAACC,SAAS,CAACZ,IAAI,CAAC;MAC7B;IACF,CAAC,MAAM;MACL;MACAA,IAAI,GAAGa,MAAM,CAACb,IAAI,CAAC;IACrB;EACF;;EAEA;EACA,MAAMc,QAAQ,GAAG,sBAAsB;EACvC,MAAMC,KAAK,GAAGf,IAAI,CAACgB,KAAK,CAACF,QAAQ,CAAC;EAElC,oBACEnB,OAAA,CAAAE,SAAA;IAAAoB,QAAA,EACGF,KAAK,CAACG,GAAG,CAAC,CAACC,IAAI,EAAEC,KAAK,KACrBN,QAAQ,CAACO,IAAI,CAACF,IAAI,CAAC,gBACjBxB,OAAA;MAEE2B,IAAI,EAAEH,IAAK;MACXI,MAAM,EAAC,QAAQ;MACfC,GAAG,EAAC,qBAAqB;MACzBC,KAAK,EAAE;QAAEC,KAAK,EAAE,SAAS;QAAEC,cAAc,EAAE;MAAY,CAAE;MAAAV,QAAA,EAExDE;IAAI,GANAC,KAAK;MAAAQ,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAOT,CAAC,GAEJZ,IAEH;EAAC,gBACF,CAAC;AAEP,CAAC;AAED,MAAMa,aAA2C,GAAGA,CAAC;EACnD7B,KAAK;EACL8B,OAAO;EACPC,cAAc;EACdC,WAAW;EACXC,SAAS;EACTC,UAAU;EACVC,SAAS,GAAG,EAAE;EACdC,eAAe,GAAG,EAAE;EACpBC,UAAU,GAAG;AACf,CAAC,KAAK;EAAAC,EAAA;EACJ,MAAM,CAACC,KAAK,EAAEC,QAAQ,CAAC,GAAG5D,QAAQ,CAAC,EAAE,CAAC;EACtC,MAAM,CAAC6D,KAAK,EAAEC,QAAQ,CAAC,GAAG9D,QAAQ,CAAuB,IAAI,CAAC;EAC9D,MAAM,CAAC+D,cAAc,EAAEC,iBAAiB,CAAC,GAAGhE,QAAQ,CAAgB,IAAI,CAAC;EACzE,MAAM,CAACiE,QAAQ,EAAEC,WAAW,CAAC,GAAGlE,QAAQ,CAAC,EAAE,CAAC;EAC5C,MAAM,CAACmE,WAAW,EAAEC,cAAc,CAAC,GAAGpE,QAAQ,CAAC,KAAK,CAAC;EACrD,MAAM,CAACqE,iBAAiB,EAAEC,oBAAoB,CAAC,GAAGtE,QAAQ,CAAC,KAAK,CAAC;EACjE,MAAM,CAACuE,YAAY,EAAEC,eAAe,CAAC,GAAGxE,QAAQ,CAAyC,IAAI,CAAC;EAC9F,MAAM,CAACyE,eAAe,EAAEC,gBAAgB,CAAC,GAAG1E,QAAQ,CAAC,KAAK,CAAC;EAC3D,MAAM,CAAC2E,kBAAkB,EAAEC,qBAAqB,CAAC,GAAG5E,QAAQ,CAAS,EAAE,CAAC;EACxE,MAAM,CAAC6E,UAAU,EAAEC,aAAa,CAAC,GAAG9E,QAAQ,CAAC,KAAK,CAAC;EACnD,MAAM,CAAC+E,WAAW,EAAEC,cAAc,CAAC,GAAGhF,QAAQ,CAAC,KAAK,CAAC;EACrD,MAAM,CAACiF,cAAc,EAAEC,iBAAiB,CAAC,GAAGlF,QAAQ,CAAS,gBAAgB,CAAC;EAC9E,MAAM,CAACmF,WAAW,EAAEC,cAAc,CAAC,GAAGpF,QAAQ,CAAC,OAAOqF,MAAM,KAAK,WAAW,GAAGA,MAAM,CAACC,UAAU,GAAG,IAAI,CAAC;EACxG,MAAM,CAACC,QAAQ,EAAEC,WAAW,CAAC,GAAGxF,QAAQ,CAAC,KAAK,CAAC;EAC/C,MAAMyF,cAAc,GAAGvF,MAAM,CAAM,IAAI,CAAC;;EAExC;EACAD,SAAS,CAAC,MAAM;IACd,MAAMyF,YAAY,GAAGA,CAAA,KAAM;MACzBN,cAAc,CAACC,MAAM,CAACC,UAAU,CAAC;IACnC,CAAC;IAED,MAAMK,YAAY,GAAGA,CAAA,KAAM;MACzB,MAAMC,SAAS,GAAGC,SAAS,CAACD,SAAS,IAAIC,SAAS,CAACC,MAAM;MACzD,MAAMC,cAAc,GAAG,gEAAgE,CAACzD,IAAI,CAACsD,SAAS,CAAC;MACvGJ,WAAW,CAACO,cAAc,IAAIV,MAAM,CAACC,UAAU,IAAI,GAAG,CAAC;IACzD,CAAC;IAEDK,YAAY,CAAC,CAAC;IACdN,MAAM,CAACW,gBAAgB,CAAC,QAAQ,EAAEN,YAAY,CAAC;IAC/C,OAAO,MAAML,MAAM,CAACY,mBAAmB,CAAC,QAAQ,EAAEP,YAAY,CAAC;EACjE,CAAC,EAAE,EAAE,CAAC;;EAEN;EACAzF,SAAS,CAAC,MAAM;IACdiG,QAAQ,CAACC,IAAI,CAACzD,KAAK,CAAC0D,QAAQ,GAAG,QAAQ;IACvC;IACA,MAAMC,YAAY,GAAGH,QAAQ,CAACI,aAAa,CAAC,uBAAuB,CAAC;IACpE,IAAI,CAACD,YAAY,EAAE;MACjB,MAAME,IAAI,GAAGL,QAAQ,CAACM,aAAa,CAAC,MAAM,CAAC;MAC3CD,IAAI,CAACE,IAAI,GAAG,UAAU;MACtBF,IAAI,CAAC9E,OAAO,GAAG,2DAA2D;MAC1EyE,QAAQ,CAACQ,IAAI,CAACC,WAAW,CAACJ,IAAI,CAAC;IACjC;IAEA,OAAO,MAAM;MACXL,QAAQ,CAACC,IAAI,CAACzD,KAAK,CAAC0D,QAAQ,GAAG,MAAM;IACvC,CAAC;EACH,CAAC,EAAE,EAAE,CAAC;;EAEN;EACA,MAAMQ,eAAe,GAAG1D,OAAO,IAAIA,OAAO,CAAC2D,IAAI,CAAC,CAAC,KAAK,EAAE,IAAI,CAACxD,SAAS;;EAEtE;EACApD,SAAS,CAAC,MAAM;IACd,IAAImB,KAAK,IAAI8B,OAAO,IAAI,CAACG,SAAS,EAAE;MAClClD,WAAW,CAAC2G,eAAe,CAAC1F,KAAK,EAAE8B,OAAO,EAAEmC,MAAM,CAAC0B,QAAQ,CAACxE,IAAI,CAAC;IACnE;EACF,CAAC,EAAE,CAACnB,KAAK,EAAE8B,OAAO,EAAEG,SAAS,CAAC,CAAC;;EAE/B;EACApD,SAAS,CAAC,MAAM;IACd,IAAIoE,iBAAiB,EAAE;MACrB6B,QAAQ,CAACC,IAAI,CAACa,SAAS,CAACC,GAAG,CAAC,YAAY,CAAC;IAC3C,CAAC,MAAM;MACLf,QAAQ,CAACC,IAAI,CAACa,SAAS,CAACE,MAAM,CAAC,YAAY,CAAC;IAC9C;IAEA,OAAO,MAAM;MACXhB,QAAQ,CAACC,IAAI,CAACa,SAAS,CAACE,MAAM,CAAC,YAAY,CAAC;IAC9C,CAAC;EACH,CAAC,EAAE,CAAC7C,iBAAiB,CAAC,CAAC;;EAEvB;EACApE,SAAS,CAAC,MAAM;IACd,OAAO,MAAM;MACX,IAAI,OAAO4D,KAAK,KAAK,QAAQ,IAAIA,KAAK,CAACsD,UAAU,CAAC,OAAO,CAAC,EAAE;QAC1DC,GAAG,CAACC,eAAe,CAACxD,KAAK,CAAC;MAC5B;IACF,CAAC;EACH,CAAC,EAAE,CAACA,KAAK,CAAC,CAAC;;EAEX;EACA5D,SAAS,CAAC,MAAM;IACd,IAAIsE,YAAY,EAAE;MAChB,MAAM+C,KAAK,GAAGC,UAAU,CAAC,MAAM;QAC7B/C,eAAe,CAAC,IAAI,CAAC;MACvB,CAAC,EAAE,IAAI,CAAC;MACR,OAAO,MAAMgD,YAAY,CAACF,KAAK,CAAC;IAClC;EACF,CAAC,EAAE,CAAC/C,YAAY,CAAC,CAAC;;EAElB;EACA,MAAMkD,gBAAgB,GAAG,MAAOC,CAAkB,IAAK;IACrDA,CAAC,CAACC,cAAc,CAAC,CAAC;IAClB,IAAI,CAAChE,KAAK,CAACkD,IAAI,CAAC,CAAC,IAAIxD,SAAS,EAAE;IAEhC,MAAMuE,YAAY,GAAGjE,KAAK,CAACkD,IAAI,CAAC,CAAC;IAEjC,IAAIe,YAAY,KAAKjD,kBAAkB,IAAIiD,YAAY,KAAKxG,KAAK,EAAE;MACjEyG,OAAO,CAACC,GAAG,CAAC,kCAAkC,EAAEF,YAAY,CAAC;MAC7D;IACF;IAEAC,OAAO,CAACC,GAAG,CAAC,yCAAyC,EAAEF,YAAY,CAAC;IACpEhD,qBAAqB,CAACgD,YAAY,CAAC;IACnC5C,cAAc,CAAC,IAAI,CAAC;IACpB5B,WAAW,CAACwE,YAAY,CAAC;EAC3B,CAAC;;EAED;EACA,MAAMG,gBAAgB,GAAGA,CAAA,KAAM;IAC7B3D,cAAc,CAAC,CAACD,WAAW,CAAC;EAC9B,CAAC;;EAED;EACA,MAAM6D,iBAAiB,GAAIC,KAA0C,IAAK;IAAA,IAAAC,mBAAA;IACxE,MAAMC,IAAI,IAAAD,mBAAA,GAAGD,KAAK,CAACzF,MAAM,CAAC4F,KAAK,cAAAF,mBAAA,uBAAlBA,mBAAA,CAAqB,CAAC,CAAC;IACpC,IAAIC,IAAI,EAAE;MACRrE,QAAQ,CAACqE,IAAI,CAAC;MACd7D,oBAAoB,CAAC,IAAI,CAAC;IAC5B;EACF,CAAC;;EAED;EACA,MAAM+D,sBAAsB,GAAInF,OAAY,IAAK;IAC/CoB,oBAAoB,CAAC,KAAK,CAAC;IAC3B,IAAIpB,OAAO,EAAE;MACXE,WAAW,CAACxB,IAAI,CAACC,SAAS,CAACqB,OAAO,CAAC,CAAC;IACtC;EACF,CAAC;;EAED;EACA,MAAMoF,WAAW,GAAGlH,KAAK,CAACmH,WAAW,CAAC,CAAC,KAAK,MAAM;EAElD,oBACE3H,OAAA;IAAK4H,SAAS,EAAC,0BAA0B;IAAC9F,KAAK,EAAE;MAC/C+F,MAAM,EAAE,OAAO;MACfrC,QAAQ,EAAE;IACZ,CAAE;IAAAlE,QAAA,gBACAtB,OAAA;MAAK8B,KAAK,EAAE;QACVgG,QAAQ,EAAE,OAAO;QACjBC,GAAG,EAAE,CAAC;QACNC,IAAI,EAAE,CAAC;QACPC,KAAK,EAAE,CAAC;QACRC,MAAM,EAAE,IAAI;QACZC,eAAe,EAAE,OAAO;QACxBC,YAAY,EAAE,mBAAmB;QACjCC,UAAU,EAAE1D,QAAQ,GAAG,+BAA+B,GAAG;MAC3D,CAAE;MAAArD,QAAA,eACAtB,OAAA,CAACH,MAAM;QACLyI,OAAO,EAAC,SAAS;QACjBC,SAAS,EAAE;MAAK;QAAAtG,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACjB;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACC,CAAC,EAGL,CAACK,SAAS,IAAI0B,WAAW,kBACxBnE,OAAA,CAACF,OAAO;MACN0I,OAAO,EAAE,IAAK;MACdC,KAAK,EAAC,sBAAsB;MAC5BC,QAAQ,EAAC,iCAAiC;MAC1CC,UAAU,EAAE;IAAK;MAAA1G,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAClB,CACF,eAGDpC,OAAA;MAAK8B,KAAK,EAAE;QACVgG,QAAQ,EAAE,UAAU;QACpBC,GAAG,EAAEpD,QAAQ,GAAG,OAAO,GAAG,MAAM;QAAE;QAClCqD,IAAI,EAAE,GAAG;QACTC,KAAK,EAAE,GAAG;QACVW,MAAM,EAAE,GAAG;QACXpD,QAAQ,EAAE,QAAQ;QAClBqD,OAAO,EAAElE,QAAQ,GAAG,KAAK,GAAG,MAAM;QAClCmE,WAAW,EAAEnE,QAAQ,GAAG,0CAA0C,GAAG,MAAM;QAC3EoE,YAAY,EAAEpE,QAAQ,GAAG,2CAA2C,GAAG,MAAM;QAC7EqE,aAAa,EAAErE,QAAQ,GAAG,4CAA4C,GAAG,MAAM;QAC/EwD,eAAe,EAAE;MACnB,CAAE;MAAA7G,QAAA,EAEC0E,eAAe,gBACdhG,OAAA;QAAK8B,KAAK,EAAE;UACVmH,OAAO,EAAE,MAAM;UACfC,mBAAmB,EAAE3E,WAAW,IAAI,GAAG,GAAG,KAAK,GAAG,SAAS;UAC3D4E,gBAAgB,EAAE5E,WAAW,IAAI,GAAG,GAAG,WAAW,GAAG,KAAK;UAC1D6E,GAAG,EAAE,MAAM;UACXC,QAAQ,EAAE,QAAQ;UAClBC,MAAM,EAAE,QAAQ;UAChBzB,MAAM,EAAE,MAAM;UACdrC,QAAQ,EAAE;QACZ,CAAE;QAAAlE,QAAA,gBAGAtB,OAAA;UAAK8B,KAAK,EAAE;YACVqG,eAAe,EAAE,OAAO;YACxBoB,YAAY,EAAE,MAAM;YACpBC,MAAM,EAAE,mBAAmB;YAC3BC,SAAS,EAAE,8BAA8B;YACzCZ,OAAO,EAAEtE,WAAW,IAAI,GAAG,GAAG,MAAM,GAAG,MAAM;YAC7C0E,OAAO,EAAE,MAAM;YACfS,aAAa,EAAE,QAAQ;YACvBlE,QAAQ,EAAE;UACZ,CAAE;UAAAlE,QAAA,gBACAtB,OAAA;YAAK8B,KAAK,EAAE;cACVmH,OAAO,EAAE,MAAM;cACfU,UAAU,EAAE,QAAQ;cACpBC,cAAc,EAAE,eAAe;cAC/BC,YAAY,EAAE;YAChB,CAAE;YAAAvI,QAAA,gBACAtB,OAAA;cAAI8B,KAAK,EAAE;gBACTwH,MAAM,EAAE,CAAC;gBACTQ,QAAQ,EAAE,MAAM;gBAChBC,UAAU,EAAE,KAAK;gBACjBhI,KAAK,EAAE;cACT,CAAE;cAAAT,QAAA,EAAC;YAEH;cAAAW,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,eACLpC,OAAA;cAAM8B,KAAK,EAAE;gBACXgI,QAAQ,EAAE,MAAM;gBAChB/H,KAAK,EAAE,SAAS;gBAChBoG,eAAe,EAAE,SAAS;gBAC1BU,OAAO,EAAE,SAAS;gBAClBU,YAAY,EAAE;cAChB,CAAE;cAAAjI,QAAA,EACCoB,UAAU,CAACsH,WAAW,CAAC;YAAC;cAAA/H,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACrB,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACJ,CAAC,eAGNpC,OAAA;YAAK8B,KAAK,EAAE;cAAEmI,IAAI,EAAE,CAAC;cAAEzE,QAAQ,EAAE;YAAS,CAAE;YAAAlE,QAAA,eAC1CtB,OAAA,CAACJ,UAAU;cACTsK,MAAM,EAAE,IAAK;cACbC,QAAQ,EAAEA,CAAA,KAAM,CAAC,CAAE;cACnBC,OAAO,EAAEA,CAAA,KAAM,CAAC,CAAE;cAClB/F,cAAc,EAAEA,cAAe;cAC/BgG,MAAM,EAAE;YAAK;cAAApI,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACd;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACC,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH,CAAC,eAGNpC,OAAA;UAAK8B,KAAK,EAAE;YACV+G,OAAO,EAAEtE,WAAW,IAAI,GAAG,GAAG,MAAM,GAAG,MAAM;YAC7C4D,eAAe,EAAE,SAAS;YAC1BoB,YAAY,EAAE,MAAM;YACpBE,SAAS,EAAE,8BAA8B;YACzCR,OAAO,EAAE,MAAM;YACfS,aAAa,EAAE,QAAQ;YACvBlE,QAAQ,EAAE;UACZ,CAAE;UAAAlE,QAAA,gBACAtB,OAAA;YAAI8B,KAAK,EAAE;cAAE+H,YAAY,EAAE,MAAM;cAAE9H,KAAK,EAAE,SAAS;cAAE+H,QAAQ,EAAE,MAAM;cAAEC,UAAU,EAAE,KAAK;cAAEO,UAAU,EAAE;YAAE,CAAE;YAAAhJ,QAAA,EAAC;UAE3G;YAAAW,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,eACLpC,OAAA;YAAK8B,KAAK,EAAE;cACVmH,OAAO,EAAE,MAAM;cACfS,aAAa,EAAE,QAAQ;cACvBN,GAAG,EAAE,MAAM;cACXa,IAAI,EAAE,CAAC;cACPzE,QAAQ,EAAE,MAAM;cAChBuD,YAAY,EAAE;YAChB,CAAE;YAAAzH,QAAA,EACCgB,OAAO,iBACNtC,OAAA,CAAAE,SAAA;cAAAoB,QAAA,gBACEtB,OAAA;gBAAAsB,QAAA,gBACEtB,OAAA;kBAAI8B,KAAK,EAAE;oBAAE+H,YAAY,EAAE,MAAM;oBAAE9H,KAAK,EAAE,SAAS;oBAAE+H,QAAQ,EAAE;kBAAO,CAAE;kBAAAxI,QAAA,EAAC;gBAAgB;kBAAAW,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAI,CAAC,eAC9FpC,OAAA,CAACP,gBAAgB;kBACfe,KAAK,EAAEA,KAAM;kBACb8B,OAAO,EAAEA,OAAQ;kBACjBI,UAAU,EAAEA,UAAU,KAAK,MAAM,GAAG,YAAY,GAAGA;gBAAW;kBAAAT,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAC/D,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACC,CAAC,eACNpC,OAAA;gBAAAsB,QAAA,gBACEtB,OAAA;kBAAI8B,KAAK,EAAE;oBAAE+H,YAAY,EAAE,MAAM;oBAAE9H,KAAK,EAAE,SAAS;oBAAE+H,QAAQ,EAAE;kBAAO,CAAE;kBAAAxI,QAAA,EAAC;gBAAmB;kBAAAW,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAI,CAAC,eACjGpC,OAAA,CAACN,cAAc;kBACbc,KAAK,EAAEA,KAAM;kBACb8B,OAAO,EAAEA,OAAQ;kBACjBI,UAAU,EAAEA,UAAU,KAAK,MAAM,GAAG,YAAY,GAAGA;gBAAW;kBAAAT,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAC/D,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACC,CAAC,eACNpC,OAAA;gBAAAsB,QAAA,gBACEtB,OAAA;kBAAI8B,KAAK,EAAE;oBAAE+H,YAAY,EAAE,MAAM;oBAAE9H,KAAK,EAAE,SAAS;oBAAE+H,QAAQ,EAAE;kBAAO,CAAE;kBAAAxI,QAAA,EAAC;gBAAgB;kBAAAW,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAI,CAAC,eAC9FpC,OAAA,CAACL,SAAS;kBACRa,KAAK,EAAEA,KAAM;kBACb8B,OAAO,EAAEA,OAAQ;kBACjBI,UAAU,EAAEA,UAAU,KAAK,MAAM,GAAG,YAAY,GAAGA;gBAAW;kBAAAT,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAC/D,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACC,CAAC;YAAA,eACN;UACH;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACE,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CAAC,GAEN,CAACK,SAAS,IAAI,CAAC0B,WAAW,iBACxBnE,OAAA;QAAK8B,KAAK,EAAE;UACVmH,OAAO,EAAE,MAAM;UACfU,UAAU,EAAE,QAAQ;UACpBC,cAAc,EAAE,QAAQ;UACxB/B,MAAM,EAAE,MAAM;UACd0C,SAAS,EAAE,QAAQ;UACnB1B,OAAO,EAAE,MAAM;UACf9G,KAAK,EAAE;QACT,CAAE;QAAAT,QAAA,eACAtB,OAAA;UAAAsB,QAAA,EAAG;QAAwD;UAAAW,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAG;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC5D;IAER;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACE,CAAC,eAGNpC,OAAA,CAACR,gBAAgB;MACf0K,MAAM,EAAEzG,iBAAkB;MAC1B2G,OAAO,EAAEA,CAAA,KAAM1G,oBAAoB,CAAC,KAAK,CAAE;MAC3C8G,kBAAkB,EAAE/C,sBAAuB;MAC3CgB,KAAK,EAAC,cAAc;MACpBC,QAAQ,EAAC;IAA4B;MAAAzG,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACtC,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACC,CAAC;AAEV,CAAC;AAACU,EAAA,CA3UIT,aAA2C;AAAAoI,EAAA,GAA3CpI,aAA2C;AA6UjD,eAAeA,aAAa;AAAC,IAAAoI,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}