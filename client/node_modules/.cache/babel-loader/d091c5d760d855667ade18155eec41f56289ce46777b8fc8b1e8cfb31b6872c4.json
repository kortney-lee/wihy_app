{"ast":null,"code":"import axios from 'axios';\n\n// Define trusted domains directly here instead of importing from self\nexport const TRUSTED_DOMAINS = {\n  'nih.gov': 1,\n  'ncbi.nlm.nih.gov': 1,\n  // PubMed\n  'who.int': 1,\n  'cdc.gov': 1,\n  'fda.gov': 1,\n  'usda.gov': 1,\n  'jamanetwork.com': 1,\n  'nejm.org': 1,\n  'thelancet.com': 1,\n  'bmj.com': 1,\n  'nature.com': 1,\n  'mayoclinic.org': 1,\n  'health.harvard.edu': 1\n};\nclass NewsService {\n  constructor() {\n    this.apiUrl = '/api/news';\n  }\n  /**\r\n   * Fetch news articles based on provided parameters\r\n   */\n  async getArticles(params = {}) {\n    try {\n      // Set defaults\n      const queryParams = {\n        limit: 500,\n        country: 'US',\n        feed_priority: '1-10',\n        flat: true,\n        page: 1,\n        per_page: 12,\n        ...params // Override with any provided params\n      };\n      console.log('Fetching news with params:', queryParams);\n      const response = await axios.get(`${this.apiUrl}/articles`, {\n        params: queryParams\n      });\n\n      // Type assertion for correct response type\n      return response.data;\n    } catch (error) {\n      console.error('Error fetching news articles:', error);\n      return {\n        success: false,\n        articles: [],\n        count: 0,\n        pagination: {\n          total_items: 0,\n          total_pages: 0,\n          current_page: 1,\n          per_page: 12,\n          has_next_page: false,\n          has_prev_page: false\n        },\n        filters_applied: {\n          category: null,\n          country: null,\n          feed_id: null,\n          limit: 0\n        },\n        error: error instanceof Error ? error.message : 'Unknown error'\n      };\n    }\n  }\n\n  /**\r\n   * Get available news categories\r\n   */\n  async getCategories() {\n    try {\n      const response = await axios.get(`${this.apiUrl}/categories`);\n      // Type assertion for correct response type\n      return response.data.categories || [];\n    } catch (error) {\n      console.error('Error fetching news categories:', error);\n      return [];\n    }\n  }\n\n  /**\r\n   * Get available countries\r\n   */\n  async getCountries() {\n    try {\n      const response = await axios.get(`${this.apiUrl}/countries`);\n      // Type assertion for correct response type\n      return response.data.countries || [];\n    } catch (error) {\n      console.error('Error fetching countries:', error);\n      return [];\n    }\n  }\n\n  /**\r\n   * Calculate trust score based on domain\r\n   */\n  calculateTrustScore(article) {\n    if (!article.domain) return 0.5;\n    return TRUSTED_DOMAINS[article.domain] || TRUSTED_DOMAINS[`www.${article.domain}`] || 0.5;\n  }\n}\nexport const newsService = new NewsService();\n\n// Export the missing functions that are used elsewhere\nexport const fetchNewsFeed = async (categories, limit) => {\n  const params = {};\n  if (categories && categories.length > 0 && categories[0] !== 'all') {\n    params.category = categories.join(',');\n  }\n  if (limit) {\n    params.limit = limit;\n  }\n  return await newsService.getArticles(params);\n};\nexport const getArticlesByCategory = async (category, limit) => {\n  if (category === 'all') {\n    return fetchNewsFeed();\n  }\n  return await newsService.getArticles({\n    category,\n    limit\n  });\n};\nexport const refreshNewsFeed = async () => {\n  // Force refresh by adding timestamp\n  return await newsService.getArticles({\n    timestamp: Date.now()\n  });\n};\nexport const searchNewsArticles = async (query, limit = 10) => {\n  return await newsService.getArticles({\n    query,\n    limit\n  });\n};","map":{"version":3,"names":["axios","TRUSTED_DOMAINS","NewsService","constructor","apiUrl","getArticles","params","queryParams","limit","country","feed_priority","flat","page","per_page","console","log","response","get","data","error","success","articles","count","pagination","total_items","total_pages","current_page","has_next_page","has_prev_page","filters_applied","category","feed_id","Error","message","getCategories","categories","getCountries","countries","calculateTrustScore","article","domain","newsService","fetchNewsFeed","length","join","getArticlesByCategory","refreshNewsFeed","timestamp","Date","now","searchNewsArticles","query"],"sources":["C:/vHealth/vhealth/client/src/services/newsService.ts"],"sourcesContent":["import axios from 'axios';\r\n\r\n// Define trusted domains directly here instead of importing from self\r\nexport const TRUSTED_DOMAINS: Record<string, number> = {\r\n  'nih.gov': 1,\r\n  'ncbi.nlm.nih.gov': 1,  // PubMed\r\n  'who.int': 1,\r\n  'cdc.gov': 1,\r\n  'fda.gov': 1,\r\n  'usda.gov': 1,\r\n  'jamanetwork.com': 1,\r\n  'nejm.org': 1,\r\n  'thelancet.com': 1,\r\n  'bmj.com': 1,\r\n  'nature.com': 1,\r\n  'mayoclinic.org': 1,\r\n  'health.harvard.edu': 1\r\n};\r\n\r\nexport interface NewsArticle {\r\n  id: string;\r\n  title: string;\r\n  description: string;\r\n  link: string;\r\n  author: string;\r\n  published_date: string;\r\n  thumbnail: string;\r\n  image_url: string;\r\n  has_image: boolean;\r\n  has_author: boolean;\r\n  category: string;\r\n  source: string;\r\n  feed_id: number;\r\n  feed_priority: string;\r\n  reading_time: number;\r\n  word_count: number;\r\n  time_ago: string;\r\n  is_recent: boolean;\r\n  content_quality: string;\r\n  completeness: string;\r\n  domain: string;\r\n  extracted_at: string;\r\n  \r\n  // Compatibility fields for existing client code\r\n  url?: string;\r\n  summary?: string;\r\n  publishedDate?: string;\r\n  thumbnailUrl?: string;\r\n  tags?: string[];\r\n  relevanceScore?: number;\r\n  hasMedia?: boolean;  // Added this field to fix HealthNewsFeed errors\r\n  hasAuthor?: boolean; // Added this field to fix HealthNewsFeed errors\r\n}\r\n\r\nexport interface NewsFeedResponse {\r\n  success: boolean;\r\n  articles: NewsArticle[];\r\n  count: number;\r\n  pagination: {\r\n    total_items: number;\r\n    total_pages: number;\r\n    current_page: number;\r\n    per_page: number;\r\n    has_next_page: boolean;\r\n    has_prev_page: boolean;\r\n  };\r\n  filters_applied: {\r\n    category: string | null;\r\n    country: string | null;\r\n    feed_id: number | null;\r\n    limit: number;\r\n  };\r\n  error?: string; // Added to handle errors from the API\r\n}\r\n\r\nexport interface NewsQueryParams {\r\n  limit?: number;\r\n  country?: string;\r\n  category?: string;\r\n  feed_id?: number;\r\n  feed_priority?: string;\r\n  flat?: boolean;\r\n  page?: number;\r\n  per_page?: number;\r\n  timestamp?: number; // Added to support refreshNewsFeed\r\n  query?: string;     // Added to support searchNewsArticles\r\n}\r\n\r\nclass NewsService {\r\n  private apiUrl = '/api/news';\r\n  \r\n  /**\r\n   * Fetch news articles based on provided parameters\r\n   */\r\n  async getArticles(params: NewsQueryParams = {}): Promise<NewsFeedResponse> {\r\n    try {\r\n      // Set defaults\r\n      const queryParams: NewsQueryParams = {\r\n        limit: 500,\r\n        country: 'US',\r\n        feed_priority: '1-10',\r\n        flat: true,\r\n        page: 1,\r\n        per_page: 12,\r\n        ...params // Override with any provided params\r\n      };\r\n\r\n      console.log('Fetching news with params:', queryParams);\r\n      \r\n      const response = await axios.get(`${this.apiUrl}/articles`, { params: queryParams });\r\n      \r\n      // Type assertion for correct response type\r\n      return response.data as NewsFeedResponse;\r\n    } catch (error) {\r\n      console.error('Error fetching news articles:', error);\r\n      return {\r\n        success: false,\r\n        articles: [],\r\n        count: 0,\r\n        pagination: {\r\n          total_items: 0,\r\n          total_pages: 0,\r\n          current_page: 1,\r\n          per_page: 12,\r\n          has_next_page: false,\r\n          has_prev_page: false\r\n        },\r\n        filters_applied: {\r\n          category: null,\r\n          country: null,\r\n          feed_id: null,\r\n          limit: 0\r\n        },\r\n        error: error instanceof Error ? error.message : 'Unknown error'\r\n      };\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get available news categories\r\n   */\r\n  async getCategories(): Promise<string[]> {\r\n    try {\r\n      const response = await axios.get(`${this.apiUrl}/categories`);\r\n      // Type assertion for correct response type\r\n      return (response.data as any).categories || [];\r\n    } catch (error) {\r\n      console.error('Error fetching news categories:', error);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get available countries\r\n   */\r\n  async getCountries(): Promise<{code: string, name: string}[]> {\r\n    try {\r\n      const response = await axios.get(`${this.apiUrl}/countries`);\r\n      // Type assertion for correct response type\r\n      return (response.data as any).countries || [];\r\n    } catch (error) {\r\n      console.error('Error fetching countries:', error);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Calculate trust score based on domain\r\n   */\r\n  calculateTrustScore(article: NewsArticle): number {\r\n    if (!article.domain) return 0.5;\r\n    \r\n    return TRUSTED_DOMAINS[article.domain] || \r\n           TRUSTED_DOMAINS[`www.${article.domain}`] || \r\n           0.5;\r\n  }\r\n}\r\n\r\nexport const newsService = new NewsService();\r\n\r\n// Export the missing functions that are used elsewhere\r\nexport const fetchNewsFeed = async (categories?: string[], limit?: number): Promise<NewsFeedResponse> => {\r\n  const params: NewsQueryParams = {};\r\n  if (categories && categories.length > 0 && categories[0] !== 'all') {\r\n    params.category = categories.join(',');\r\n  }\r\n  if (limit) {\r\n    params.limit = limit;\r\n  }\r\n  return await newsService.getArticles(params);\r\n};\r\n\r\nexport const getArticlesByCategory = async (category: string, limit?: number): Promise<NewsFeedResponse> => {\r\n  if (category === 'all') {\r\n    return fetchNewsFeed();\r\n  }\r\n  return await newsService.getArticles({ category, limit });\r\n};\r\n\r\nexport const refreshNewsFeed = async (): Promise<NewsFeedResponse> => {\r\n  // Force refresh by adding timestamp\r\n  return await newsService.getArticles({ timestamp: Date.now() });\r\n};\r\n\r\nexport const searchNewsArticles = async (query: string, limit = 10): Promise<NewsFeedResponse> => {\r\n  return await newsService.getArticles({ query, limit });\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}