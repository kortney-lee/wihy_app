{"ast":null,"code":"import React,{useState,useRef,useEffect}from'react';import{useNavigate}from'react-router-dom';import'./styles/VHealthSearch.css';import ImageUploadModal from'./components/ImageUploadModal';import MultiAuthLogin from'./components/shared/components/MultiAuthLogin';import{wihyAPI}from'./services/wihyAPI';import HealthNewsFeed from'./components/HealthNewsFeed';import{getApiEndpoint}from'./config/apiConfig';import{logger}from'./utils/logger';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const VHealthSearch=()=>{// ================================\n// STATE MANAGEMENT\n// ================================\nconst[searchQuery,setSearchQuery]=useState('');const[isListening,setIsListening]=useState(false);const[isUploadModalOpen,setIsUploadModalOpen]=useState(false);const[isLoading,setIsLoading]=useState(false);const[imageError,setImageError]=useState(false);const[loadingMessage,setLoadingMessage]=useState('Searching...');const[showFeelingHealthyContent,setShowFeelingHealthyContent]=useState(false);const navigate=useNavigate();const searchInputRef=useRef(null);const recognitionRef=useRef(null);const abortControllerRef=useRef(null);// ================================\n// FORCE MOBILE ANIMATION\n// ================================\nuseEffect(()=>{// Force the animation to work on mobile by applying it directly\nconst forceAnimation=()=>{const container=document.querySelector('.search-input-container');if(container){// Try a simpler animation approach for mobile\nif('ontouchstart'in window||navigator.maxTouchPoints>0){// Mobile-specific animation using background-position sweep (matching desktop pattern)\ncontainer.style.setProperty('border','2px solid transparent','important');container.style.setProperty('background',\"\\n            linear-gradient(#fff, #fff) padding-box,\\n            linear-gradient(90deg, #fa5f06, #ffffff, #C0C0C0, #4cbb17, #1a73e8) border-box\\n          \",'important');container.style.setProperty('background-size','100% 100%, 200% 100%','important');container.style.setProperty('animation','none','important');// Use background-position animation to match desktop sweep pattern\nlet position=0;const animateSweep=()=>{position=(position+1)%200;// 0 to 200% like the original\ncontainer.style.setProperty('background-position',\"0 0, \".concat(position,\"% 0\"),'important');setTimeout(()=>requestAnimationFrame(animateSweep),22);// ~2.2s for full cycle (200 * 22ms ≈ 4.4s)\n};animateSweep();container.classList.add('force-mobile-animation');logger.debug('Mobile device detected - custom gradient animation started');}else{// Desktop - use CSS animation\ncontainer.style.setProperty('animation','wiH-border-sweep 2.2s linear infinite','important');container.style.setProperty('background',\"\\n            linear-gradient(#fff, #fff) padding-box,\\n            linear-gradient(90deg, #fa5f06, #ffffff, #C0C0C0, #4cbb17, #1a73e8) border-box\\n          \",'important');container.style.setProperty('background-size','100% 100%, 200% 100%','important');container.style.setProperty('border','2px solid transparent','important');logger.debug('Desktop animation applied');}logger.debug('Forced animation applied to search container');}};// Apply immediately and also after a short delay to ensure it sticks\nforceAnimation();const timeoutId=setTimeout(forceAnimation,100);// Also apply when the component mounts fully\nconst mountTimeout=setTimeout(forceAnimation,500);return()=>{clearTimeout(timeoutId);clearTimeout(mountTimeout);};},[]);// ================================\n// UTILITY FUNCTIONS\n// ================================\n/**\r\n   * PROGRESS CALCULATOR\r\n   * Converts loading message text to progress percentage for UI feedback\r\n   * @param msg - The current loading message\r\n   * @returns Progress percentage (0-100)\r\n   */const progressFromMessage=msg=>{if(msg.includes('Initializing'))return 10;if(msg.includes('Checking cache'))return 25;if(msg.includes('Analyzing with AI'))return 55;if(msg.includes('Processing results'))return 75;if(msg.includes('Results ready')||msg.includes('Response ready'))return 95;if(msg.includes('Processing image'))return 35;if(msg.includes('Checking nutrition'))return 45;if(msg.includes('Analyzing nutrition'))return 60;if(msg.includes('Processing nutrition'))return 80;if(msg.includes('complete'))return 95;if(msg.includes('failed'))return 100;// will close shortly\nreturn 40;// default midpoint\n};/**\r\n   * AUTO-SIZE TEXT AREA\r\n   * Dynamically adjusts the height of the search input based on content\r\n   */const autoSize=()=>{const el=document.querySelector('.search-input');if(!el)return;// Reset to default height when empty\nif(!searchQuery.trim()){el.style.height='44px';// Default height\nel.style.overflowY='hidden';return;}// Otherwise handle auto-sizing as before\nel.style.height=\"auto\";const next=el.scrollHeight;el.style.height=next+\"px\";// Check if we've hit max height\nconst max=parseFloat(getComputedStyle(el).maxHeight);el.style.overflowY=next>max?\"auto\":\"hidden\";};/**\r\n   * CLEAR SEARCH INPUT\r\n   * Clears search input and resets its height to default\r\n   */const handleClearSearch=()=>{setSearchQuery('');// Force a reset after state update\nsetTimeout(()=>{const el=document.querySelector('.search-input');if(el)el.style.height='44px';},10);};// ================================\n// AUTHENTICATION HANDLERS\n// ================================\n/**\r\n   * USER CHANGE HANDLER\r\n   * Handles when user authentication state changes\r\n   * @param user - User object from auth service\r\n   */const handleUserChange=user=>{console.log('User changed:',user);};/**\r\n   * SIGN IN HANDLER\r\n   * Handles successful user sign-in\r\n   * @param user - Authenticated user object\r\n   */const handleSignIn=user=>{console.log('User signed in:',user);};/**\r\n   * SIGN OUT HANDLER\r\n   * Handles user sign-out action\r\n   */const handleSignOut=()=>{console.log('User signed out');};// ================================\n// MAIN SEARCH FUNCTIONALITY\n// ================================\n/**\r\n   * MAIN SEARCH HANDLER\r\n   * Primary search function that handles text-based health queries\r\n   * Flow: Check cache → API call → Save to cache → Navigate to results\r\n   * Uses 4-step fallback strategy for reliability\r\n   */const handleSearch=async queryParam=>{const queryToUse=queryParam||searchQuery;if(!queryToUse.trim()||isLoading)return;// Create new AbortController for this request\nabortControllerRef.current=new AbortController();const signal=abortControllerRef.current.signal;setIsLoading(true);setLoadingMessage('Initializing search...');try{// Step 1: Check database cache first\nsetLoadingMessage('Checking cache...');try{const response=await fetch(getApiEndpoint(\"/cache/get?q=\".concat(encodeURIComponent(queryToUse))),{signal});if(response.ok){const cachedData=await response.json();console.log('Using cached results from database');setLoadingMessage('Loading cached results...');await new Promise(resolve=>setTimeout(resolve,300));setIsLoading(false);// Pass the cached data via navigation state\nnavigate(\"/results?q=\".concat(encodeURIComponent(queryToUse)),{state:{results:cachedData.results,dataSource:cachedData.source||'cache',fromSearch:true}});return;}}catch(cacheError){// Handle AbortError specifically\nif(cacheError.name==='AbortError'){console.log('Cache request was cancelled');return;// Exit early\n}logger.debug('No cache found, proceeding with API call');}// Step 2: Get fresh results from API\nsetLoadingMessage('Analyzing with AI...');logger.debug('Getting fresh results for query',{query:queryToUse});try{// Use WiHy Unified API for search\nlogger.apiRequest('WiHy API search',{query:queryToUse});const wihyResponse=await wihyAPI.searchHealth(queryToUse);if(wihyResponse.success){// Convert WiHy response to expected format\nconst searchResults={summary:wihyResponse.wihy_response.core_principle,details:wihyAPI.formatWihyResponse(wihyResponse),sources:wihyAPI.extractCitations(wihyResponse),recommendations:wihyAPI.extractRecommendations(wihyResponse),relatedTopics:[],medicalDisclaimer:'This guidance is based on evidence-based health principles. Always consult healthcare professionals for personalized medical advice.',dataSource:'wihy'};console.log('WiHy search results received:',searchResults);const isValidResult=searchResults&&typeof searchResults==='object'&&searchResults!==null&&(searchResults.summary||searchResults.details||Object.keys(searchResults).length>0);if(isValidResult){logger.info('Valid search results confirmed');// Step 3: Save to database cache (async, don't wait)\nsetLoadingMessage('Caching results...');fetch(getApiEndpoint('/cache/save'),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({query:queryToUse,results:searchResults,source:'wihy'})}).then(response=>{if(response.ok){logger.cache('Results saved to database cache');}else{logger.warn('Failed to save to cache');}}).catch(err=>{logger.warn('Cache save error',{error:err});});setLoadingMessage('Results ready!');await new Promise(resolve=>setTimeout(resolve,300));setIsLoading(false);logger.debug('Navigating to results page with data');// Pass the fresh results via navigation state\nnavigate(\"/results?q=\".concat(encodeURIComponent(queryToUse)),{state:{results:searchResults,dataSource:'wihy',fromSearch:true}});return;}else{throw new Error('WiHy API returned invalid results');}}else{throw new Error('WiHy API request failed');}}catch(apiError){var _apiError$message,_apiError$message2,_apiError$message3,_apiError$message4,_apiError$message5,_apiError$message6;// Handle AbortError specifically\nif(apiError.name==='AbortError'){logger.debug('API request was cancelled');return;// Exit early\n}const isNetworkError=((_apiError$message=apiError.message)===null||_apiError$message===void 0?void 0:_apiError$message.includes('NETWORK_ERROR'))||((_apiError$message2=apiError.message)===null||_apiError$message2===void 0?void 0:_apiError$message2.includes('TIMEOUT_ERROR'))||((_apiError$message3=apiError.message)===null||_apiError$message3===void 0?void 0:_apiError$message3.includes('fetch'))||((_apiError$message4=apiError.message)===null||_apiError$message4===void 0?void 0:_apiError$message4.includes('network'))||apiError.name==='TypeError'||((_apiError$message5=apiError.message)===null||_apiError$message5===void 0?void 0:_apiError$message5.includes('Failed to fetch'));const isServerError=(_apiError$message6=apiError.message)===null||_apiError$message6===void 0?void 0:_apiError$message6.includes('SERVER_ERROR');if(isNetworkError){logger.error('Network error in health search:',apiError);setLoadingMessage('Connection trouble! 🌐 Our servers might be napping...');}else if(isServerError){logger.error('Server error in health search:',apiError);setLoadingMessage('Our servers are taking a coffee break ☕ Come back in a few minutes!');}else{logger.error('Health search service failed:',apiError);setLoadingMessage('Search hit a snag! 🔍 Trying backup options...');}// Step 4: Try similar results as fallback\nsetTimeout(()=>{setLoadingMessage('Searching for similar results...');},2000);try{const similarResponse=await fetch(getApiEndpoint(\"/cache/similar?q=\".concat(encodeURIComponent(queryToUse))));if(similarResponse.ok){const similarResults=await similarResponse.json();if(similarResults.length>0){console.log('Using similar cached results');setLoadingMessage('Loading similar results...');await new Promise(resolve=>setTimeout(resolve,300));setIsLoading(false);// Pass similar results via navigation state\nnavigate(\"/results?q=\".concat(encodeURIComponent(queryToUse)),{state:{results:similarResults[0].results,dataSource:'similar',fromSearch:true}});return;}}}catch(similarError){console.warn('Similar results search failed:',similarError);}setLoadingMessage('No results found. Please try a different search.');setTimeout(()=>{setIsLoading(false);setLoadingMessage('Searching...');},3000);return;}}catch(error){// Handle AbortError specifically\nif(error.name==='AbortError'){logger.debug('Search request was cancelled');return;// Exit early\n}logger.error(\"Search error:\",error);// Check for specific error types\nconst errorMessage=error.message||'';if(errorMessage.includes('NETWORK_ERROR')||errorMessage.includes('TIMEOUT_ERROR')){setLoadingMessage('Oops! Our servers are taking a coffee break ☕ Come back in a few minutes!');}else if(errorMessage.includes('SERVER_ERROR')){setLoadingMessage('Server hiccup! 🤖 Please try again in a moment.');}else if(errorMessage.includes('fetch')||errorMessage.includes('network')||error.name==='TypeError'){setLoadingMessage('Connection trouble! 📡 Please check your internet and try again.');}else{setLoadingMessage('Something went wrong! Please try your search again 🔄');}setTimeout(()=>{setIsLoading(false);setLoadingMessage('Searching...');},4000);// Give a bit more time to read the friendly message\n}};/**\r\n   * SEARCH CANCELLATION HANDLER\r\n   * Cancels in-progress search requests and resets loading state\r\n   * Called when user clicks the cancel button in loading overlay\r\n   */const handleCancelSearch=()=>{if(abortControllerRef.current){abortControllerRef.current.abort();abortControllerRef.current=null;}setIsLoading(false);setLoadingMessage('Searching...');};// ================================\n// IMAGE ANALYSIS FUNCTIONALITY\n// ================================\n/**\r\n   * IMAGE ANALYSIS COMPLETION HANDLER\r\n   * Processes results from image upload and food recognition\r\n   * Triggered when ImageUploadModal completes food detection\r\n   * @param foodName - The detected food name from image analysis\r\n   */const handleAnalysisComplete=async foodName=>{if(!foodName||isLoading){setIsUploadModalOpen(false);return;}// Create abort controller for this request too\nabortControllerRef.current=new AbortController();const signal=abortControllerRef.current.signal;setIsLoading(true);setLoadingMessage('Processing image analysis...');try{console.log(\"Image analysis completed, food detected:\",foodName);setSearchQuery(foodName);// Step 1: Check database cache for nutrition data\nsetLoadingMessage('Checking nutrition database...');try{const response=await fetch(getApiEndpoint(\"/cache/get?q=\".concat(encodeURIComponent(foodName))));if(response.ok){const cachedData=await response.json();console.log('Using cached nutrition data');setLoadingMessage('Loading cached nutrition data...');await new Promise(resolve=>setTimeout(resolve,300));setIsLoading(false);// Pass the cached data via navigation state\nnavigate(\"/results?q=\".concat(encodeURIComponent(foodName)),{state:{results:cachedData.results,dataSource:cachedData.source||'cache',fromSearch:true}});return;}}catch(cacheError){console.log('No cached nutrition data found');}// Step 2: Get fresh nutrition data\nsetLoadingMessage('Analyzing nutrition content...');try{console.log('Making WiHy API nutrition search for:',foodName);const wihyResponse=await wihyAPI.searchNutrition(foodName);if(wihyResponse.success){// Convert WiHy response to expected format\nconst nutritionResults={summary:wihyResponse.wihy_response.core_principle,details:wihyAPI.formatWihyResponse(wihyResponse),sources:wihyAPI.extractCitations(wihyResponse),recommendations:wihyAPI.extractRecommendations(wihyResponse),relatedTopics:[],medicalDisclaimer:'This guidance is based on evidence-based health principles. Always consult healthcare professionals for personalized medical advice.',dataSource:'wihy'};const isValidResult=nutritionResults&&typeof nutritionResults==='object'&&nutritionResults!==null&&(nutritionResults.summary||nutritionResults.details||Object.keys(nutritionResults).length>0);if(isValidResult){// Step 3: Save to database cache (async, don't wait)\nsetLoadingMessage('Caching nutrition data...');fetch(getApiEndpoint('/cache/save'),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({query:foodName,results:nutritionResults,source:'wihy'})}).then(response=>{if(response.ok){console.log('Nutrition data saved to cache');}else{console.warn('Failed to save nutrition data to cache');}}).catch(err=>{console.warn('Nutrition cache save error:',err);});setLoadingMessage('Nutrition analysis complete!');await new Promise(resolve=>setTimeout(resolve,300));setIsLoading(false);// Pass the fresh nutrition results via navigation state\nnavigate(\"/results?q=\".concat(encodeURIComponent(foodName)),{state:{results:nutritionResults,dataSource:'wihy',fromSearch:true}});return;}else{throw new Error('WiHy API returned invalid nutrition results');}}else{throw new Error('WiHy nutrition API request failed');}}catch(nutritionError){console.error('Nutrition analysis failed:',nutritionError);// Try similar results as fallback\ntry{const similarResponse=await fetch(getApiEndpoint(\"/cache/similar?q=\".concat(encodeURIComponent(foodName))));if(similarResponse.ok){const similarResults=await similarResponse.json();if(similarResults.length>0){console.log('Using similar nutrition data');setLoadingMessage('Loading similar nutrition data...');await new Promise(resolve=>setTimeout(resolve,300));setIsLoading(false);navigate(\"/results?q=\".concat(encodeURIComponent(foodName)));return;}}}catch(similarError){console.warn('Similar nutrition search failed:',similarError);}setLoadingMessage('Hmm, we couldn\\'t figure out what that food is 🤔 Try a different photo or search manually!');setTimeout(()=>{setIsLoading(false);setLoadingMessage('Searching...');},4000);return;}}catch(error){var _error$message,_error$message2;logger.error(\"Error processing analyzed food:\",error);const isNetworkError=((_error$message=error.message)===null||_error$message===void 0?void 0:_error$message.includes('fetch'))||((_error$message2=error.message)===null||_error$message2===void 0?void 0:_error$message2.includes('network'))||error.name==='TypeError';if(isNetworkError){setLoadingMessage('Oops! Connection hiccup 📡 Please try again in a moment!');}else{setLoadingMessage('Food analysis had a little hiccup 🍎 Please try again!');}setTimeout(()=>{setIsLoading(false);setLoadingMessage('Searching...');},2000);}finally{setIsUploadModalOpen(false);}};// ================================\n// LIFECYCLE HOOKS\n// ================================\n/**\r\n   * CLEANUP EFFECT\r\n   * Resets loading state when component unmounts\r\n   * Prevents memory leaks and state persistence issues\r\n   */useEffect(()=>{return()=>{setIsLoading(false);setLoadingMessage('Searching...');};},[]);// Add this with your other useEffects\nuseEffect(()=>{// Call autoSize whenever searchQuery changes\nif(searchQuery!==undefined){autoSize();}},[searchQuery]);// ================================\n// UI COMPONENTS\n// ================================\n/**\r\n   * LOADING OVERLAY COMPONENT\r\n   * Shows animated loading screen with progress bar during search operations\r\n   * @param message - Current loading message to display\r\n   * @param progress - Progress percentage (0-100) for progress bar\r\n   */const LoadingOverlay=_ref=>{let{message,progress}=_ref;return/*#__PURE__*/_jsx(\"div\",{style:{position:'fixed',top:0,left:0,right:0,bottom:0,backgroundColor:'rgba(0, 0, 0, 0.5)',display:'flex',alignItems:'center',justifyContent:'center',zIndex:9999},children:/*#__PURE__*/_jsxs(\"div\",{style:{backgroundColor:'white',borderRadius:'12px',padding:'40px',textAlign:'center',minWidth:'320px',boxShadow:'0 10px 25px rgba(0, 0, 0, 0.2)'},children:[/*#__PURE__*/_jsx(\"div\",{style:{margin:'0 auto 24px auto'},children:/*#__PURE__*/_jsx(\"img\",{src:\"/assets/whatishealthyspinner.gif\",alt:\"Loading...\",style:{width:'48px',height:'48px',objectFit:'contain'}})}),/*#__PURE__*/_jsx(\"h3\",{style:{margin:'0 0 8px 0',fontSize:'24px',fontWeight:'600',color:'#1f2937'},children:\"Loading Content\"}),/*#__PURE__*/_jsx(\"p\",{style:{margin:'0 0 24px 0',fontSize:'16px',color:'#6b7280'},children:\"Please wait while we process your request...\"}),/*#__PURE__*/_jsx(\"div\",{style:{width:'100%',height:'8px',backgroundColor:'#e5e7eb',borderRadius:'4px',overflow:'hidden',marginBottom:'12px'},children:/*#__PURE__*/_jsx(\"div\",{style:{width:\"\".concat(progress,\"%\"),height:'100%',backgroundColor:'#3b82f6',borderRadius:'4px',transition:'width 0.3s ease'}})}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',justifyContent:'space-between',marginTop:'16px'},children:[/*#__PURE__*/_jsxs(\"p\",{style:{margin:0,fontSize:'14px',color:'#6b7280'},children:[progress,\"% Complete\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleCancelSearch,style:{backgroundColor:'transparent',color:'#555',border:'1px solid #ccc',borderRadius:'16px',padding:'8px 16px',fontSize:'14px',fontWeight:'500',cursor:'pointer',transition:'all 0.2s ease'},onMouseOver:e=>{e.currentTarget.style.backgroundColor='#f1f1f1';e.currentTarget.style.color='#333';e.currentTarget.style.borderColor='#aaa';},onMouseOut:e=>{e.currentTarget.style.backgroundColor='transparent';e.currentTarget.style.color='#555';e.currentTarget.style.borderColor='#ccc';},children:\"Cancel\"})]})]})});};// ================================\n// MAIN COMPONENT RENDER\n// ================================\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"search-landing\",children:[isLoading&&/*#__PURE__*/_jsx(LoadingOverlay,{message:loadingMessage,progress:progressFromMessage(loadingMessage)}),/*#__PURE__*/_jsx(\"div\",{style:{position:'fixed',top:'20px',right:'20px',zIndex:1000},children:/*#__PURE__*/_jsx(MultiAuthLogin,{className:\"main-login-button\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"search-container-centered\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"logo-container\",children:!imageError?/*#__PURE__*/_jsx(\"img\",{src:\"/assets/wihylogo.png\",alt:\"What is Healthy?\",className:\"search-logo-image\",onError:()=>setImageError(true),onLoad:()=>setImageError(false),onClick:()=>navigate('/'),style:{cursor:'pointer'}}):/*#__PURE__*/_jsx(\"h1\",{className:\"search-logo\",onClick:()=>navigate('/'),style:{cursor:'pointer'},children:\"What is Healthy?\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"search-input-container\",children:[/*#__PURE__*/_jsx(\"form\",{onSubmit:e=>{e.preventDefault();handleSearch();},children:/*#__PURE__*/_jsx(\"textarea\",{value:searchQuery,onChange:e=>{setSearchQuery(e.target.value);},onKeyDown:e=>{if(e.key==='Enter'&&!e.shiftKey){e.preventDefault();handleSearch();}},placeholder:\"Ask anything about health...\",className:\"search-input\",autoFocus:true,disabled:isLoading,rows:1,style:{resize:'none',overflow:'hidden',minHeight:'44px',height:'auto',paddingRight:'100px',width:'100%',// Use full width of container\nboxSizing:'border-box'// Include padding in width calculation\n},onInput:e=>{// Auto-resize height algorithm\nconst target=e.target;target.style.height='0';const scrollHeight=target.scrollHeight;target.style.height=scrollHeight+'px';}})}),/*#__PURE__*/_jsxs(\"div\",{className:\"search-icons\",children:[searchQuery&&/*#__PURE__*/_jsx(\"button\",{className:\"icon-button clear-button\",onClick:handleClearSearch,\"aria-label\":\"Clear\",children:/*#__PURE__*/_jsx(\"svg\",{viewBox:\"0 0 24 24\",width:\"24\",height:\"24\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z\",fill:\"currentColor\"})})}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setIsUploadModalOpen(true),className:\"icon-button\",\"aria-label\":\"Upload image\",disabled:isLoading,children:/*#__PURE__*/_jsx(\"svg\",{viewBox:\"0 0 24 24\",fill:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M9 2L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2H9zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5z\"})})}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>{if(isLoading)return;if(!('webkitSpeechRecognition'in window)){alert('Speech recognition not supported in this browser');return;}if(!recognitionRef.current){const recognition=new window.webkitSpeechRecognition();recognition.continuous=false;recognition.interimResults=false;recognition.lang='en-US';recognition.onstart=()=>setIsListening(true);recognition.onresult=event=>{const transcript=event.results[0][0].transcript;setSearchQuery(transcript);setIsListening(false);};recognition.onerror=()=>setIsListening(false);recognition.onend=()=>setIsListening(false);recognitionRef.current=recognition;}if(!isListening){recognitionRef.current.start();}else{recognitionRef.current.stop();setIsListening(false);}},className:\"icon-button \".concat(isListening?'listening':''),\"aria-label\":isListening?'Stop listening':'Start voice input',disabled:isLoading,children:/*#__PURE__*/_jsxs(\"svg\",{viewBox:\"0 0 24 24\",fill:\"currentColor\",children:[/*#__PURE__*/_jsx(\"path\",{d:\"M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.28c3.39-.49 6-3.3 6-6.72h-2z\"})]})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"search-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.preventDefault();handleSearch();},className:\"search-btn primary\",disabled:!searchQuery.trim()||isLoading,children:isLoading?loadingMessage:'Analyze Nutrition'}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{if(isLoading)return;if(showFeelingHealthyContent){// If news is showing, close it and set \"What is Healthy?\" in search\nsetShowFeelingHealthyContent(false);setSearchQuery('What is Healthy?');}else{// Show the news feed\nsetShowFeelingHealthyContent(true);}},className:\"search-btn secondary\",type:\"button\",style:{color:'#000000'},disabled:isLoading,children:\"I'm Feeling Healthy\"})]})]}),showFeelingHealthyContent&&/*#__PURE__*/_jsx(\"div\",{className:\"feeling-healthy-section\",onClick:e=>{// Close if clicking on the background, not the content\nif(e.target===e.currentTarget){setShowFeelingHealthyContent(false);setSearchQuery('What is Healthy?');}},children:/*#__PURE__*/_jsx(\"div\",{onClick:e=>e.stopPropagation(),children:/*#__PURE__*/_jsx(HealthNewsFeed,{maxArticles:6,setSearchQuery:setSearchQuery,triggerSearch:customQuery=>{setShowFeelingHealthyContent(false);// Close news feed\n// Use the custom query if provided, otherwise use current searchQuery\nif(customQuery){handleSearch(customQuery);}else{handleSearch();}}})})}),/*#__PURE__*/_jsx(ImageUploadModal,{isOpen:isUploadModalOpen,onClose:()=>setIsUploadModalOpen(false)// FIXED: Changed from setIsUploadModal to setIsUploadModalOpen\n,onAnalysisComplete:handleAnalysisComplete,title:\"Upload Image\",subtitle:\"Upload Image for Analysis\"})]});};export default VHealthSearch;/* Add this CSS to your styles\r\n@keyframes spin {\r\n  0% { transform: rotate(0deg); }\r\n  100% { transform: rotate(360deg); }\r\n}\r\n*/","map":{"version":3,"names":["React","useState","useRef","useEffect","useNavigate","ImageUploadModal","MultiAuthLogin","wihyAPI","HealthNewsFeed","getApiEndpoint","logger","jsx","_jsx","jsxs","_jsxs","VHealthSearch","searchQuery","setSearchQuery","isListening","setIsListening","isUploadModalOpen","setIsUploadModalOpen","isLoading","setIsLoading","imageError","setImageError","loadingMessage","setLoadingMessage","showFeelingHealthyContent","setShowFeelingHealthyContent","navigate","searchInputRef","recognitionRef","abortControllerRef","forceAnimation","container","document","querySelector","window","navigator","maxTouchPoints","style","setProperty","position","animateSweep","concat","setTimeout","requestAnimationFrame","classList","add","debug","timeoutId","mountTimeout","clearTimeout","progressFromMessage","msg","includes","autoSize","el","trim","height","overflowY","next","scrollHeight","max","parseFloat","getComputedStyle","maxHeight","handleClearSearch","handleUserChange","user","console","log","handleSignIn","handleSignOut","handleSearch","queryParam","queryToUse","current","AbortController","signal","response","fetch","encodeURIComponent","ok","cachedData","json","Promise","resolve","state","results","dataSource","source","fromSearch","cacheError","name","query","apiRequest","wihyResponse","searchHealth","success","searchResults","summary","wihy_response","core_principle","details","formatWihyResponse","sources","extractCitations","recommendations","extractRecommendations","relatedTopics","medicalDisclaimer","isValidResult","Object","keys","length","info","method","headers","body","JSON","stringify","then","cache","warn","catch","err","error","Error","apiError","_apiError$message","_apiError$message2","_apiError$message3","_apiError$message4","_apiError$message5","_apiError$message6","isNetworkError","message","isServerError","similarResponse","similarResults","similarError","errorMessage","handleCancelSearch","abort","handleAnalysisComplete","foodName","searchNutrition","nutritionResults","nutritionError","_error$message","_error$message2","undefined","LoadingOverlay","_ref","progress","top","left","right","bottom","backgroundColor","display","alignItems","justifyContent","zIndex","children","borderRadius","padding","textAlign","minWidth","boxShadow","margin","src","alt","width","objectFit","fontSize","fontWeight","color","overflow","marginBottom","transition","marginTop","onClick","border","cursor","onMouseOver","e","currentTarget","borderColor","onMouseOut","className","onError","onLoad","onSubmit","preventDefault","value","onChange","target","onKeyDown","key","shiftKey","placeholder","autoFocus","disabled","rows","resize","minHeight","paddingRight","boxSizing","onInput","viewBox","d","fill","type","alert","recognition","webkitSpeechRecognition","continuous","interimResults","lang","onstart","onresult","event","transcript","onerror","onend","start","stop","stopPropagation","maxArticles","triggerSearch","customQuery","isOpen","onClose","onAnalysisComplete","title","subtitle"],"sources":["C:/repo/wihy_ui/client/src/VHealthSearch.tsx"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport './styles/VHealthSearch.css';\r\nimport ImageUploadModal from './components/ImageUploadModal';\r\nimport MultiAuthLogin from './components/shared/components/MultiAuthLogin';\r\nimport { wihyAPI } from './services/wihyAPI';\r\nimport { searchCache } from './services/searchCache';\r\nimport { foodAnalysisService } from './components/foodAnalysisService';\r\nimport HealthNewsFeed from './components/HealthNewsFeed';\r\nimport { getApiEndpoint } from './config/apiConfig';\r\nimport { logger } from './utils/logger';\r\n\r\nconst VHealthSearch: React.FC = () => {\r\n  // ================================\r\n  // STATE MANAGEMENT\r\n  // ================================\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [isListening, setIsListening] = useState(false);\r\n  const [isUploadModalOpen, setIsUploadModalOpen] = useState(false);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [imageError, setImageError] = useState(false);\r\n  const [loadingMessage, setLoadingMessage] = useState('Searching...');\r\n  const [showFeelingHealthyContent, setShowFeelingHealthyContent] = useState(false);\r\n  \r\n  const navigate = useNavigate();\r\n  const searchInputRef = useRef<HTMLInputElement>(null);\r\n  const recognitionRef = useRef<any>(null);\r\n  const abortControllerRef = useRef<AbortController | null>(null);\r\n\r\n  // ================================\r\n  // FORCE MOBILE ANIMATION\r\n  // ================================\r\n  useEffect(() => {\r\n    // Force the animation to work on mobile by applying it directly\r\n    const forceAnimation = () => {\r\n      const container = document.querySelector('.search-input-container') as HTMLElement;\r\n      if (container) {\r\n        // Try a simpler animation approach for mobile\r\n        if ('ontouchstart' in window || navigator.maxTouchPoints > 0) {\r\n          // Mobile-specific animation using background-position sweep (matching desktop pattern)\r\n          container.style.setProperty('border', '2px solid transparent', 'important');\r\n          container.style.setProperty('background', `\r\n            linear-gradient(#fff, #fff) padding-box,\r\n            linear-gradient(90deg, #fa5f06, #ffffff, #C0C0C0, #4cbb17, #1a73e8) border-box\r\n          `, 'important');\r\n          container.style.setProperty('background-size', '100% 100%, 200% 100%', 'important');\r\n          container.style.setProperty('animation', 'none', 'important');\r\n          \r\n          // Use background-position animation to match desktop sweep pattern\r\n          let position = 0;\r\n          const animateSweep = () => {\r\n            position = (position + 1) % 200; // 0 to 200% like the original\r\n            container.style.setProperty('background-position', `0 0, ${position}% 0`, 'important');\r\n            setTimeout(() => requestAnimationFrame(animateSweep), 22); // ~2.2s for full cycle (200 * 22ms ≈ 4.4s)\r\n          };\r\n          animateSweep();\r\n          \r\n          container.classList.add('force-mobile-animation');\r\n          logger.debug('Mobile device detected - custom gradient animation started');\r\n        } else {\r\n          // Desktop - use CSS animation\r\n          container.style.setProperty('animation', 'wiH-border-sweep 2.2s linear infinite', 'important');\r\n          container.style.setProperty('background', `\r\n            linear-gradient(#fff, #fff) padding-box,\r\n            linear-gradient(90deg, #fa5f06, #ffffff, #C0C0C0, #4cbb17, #1a73e8) border-box\r\n          `, 'important');\r\n          container.style.setProperty('background-size', '100% 100%, 200% 100%', 'important');\r\n          container.style.setProperty('border', '2px solid transparent', 'important');\r\n          logger.debug('Desktop animation applied');\r\n        }\r\n        \r\n        logger.debug('Forced animation applied to search container');\r\n      }\r\n    };\r\n\r\n    // Apply immediately and also after a short delay to ensure it sticks\r\n    forceAnimation();\r\n    const timeoutId = setTimeout(forceAnimation, 100);\r\n    \r\n    // Also apply when the component mounts fully\r\n    const mountTimeout = setTimeout(forceAnimation, 500);\r\n    \r\n    return () => {\r\n      clearTimeout(timeoutId);\r\n      clearTimeout(mountTimeout);\r\n    };\r\n  }, []);\r\n\r\n  // ================================\r\n  // UTILITY FUNCTIONS\r\n  // ================================\r\n\r\n  /**\r\n   * PROGRESS CALCULATOR\r\n   * Converts loading message text to progress percentage for UI feedback\r\n   * @param msg - The current loading message\r\n   * @returns Progress percentage (0-100)\r\n   */\r\n  const progressFromMessage = (msg: string) => {\r\n    if (msg.includes('Initializing')) return 10;\r\n    if (msg.includes('Checking cache')) return 25;\r\n    if (msg.includes('Analyzing with AI')) return 55;\r\n    if (msg.includes('Processing results')) return 75;\r\n    if (msg.includes('Results ready') || msg.includes('Response ready')) return 95;\r\n\r\n    if (msg.includes('Processing image')) return 35;\r\n    if (msg.includes('Checking nutrition')) return 45;\r\n    if (msg.includes('Analyzing nutrition')) return 60;\r\n    if (msg.includes('Processing nutrition')) return 80;\r\n    if (msg.includes('complete')) return 95;\r\n\r\n    if (msg.includes('failed')) return 100; // will close shortly\r\n    return 40; // default midpoint\r\n  };\r\n\r\n  /**\r\n   * AUTO-SIZE TEXT AREA\r\n   * Dynamically adjusts the height of the search input based on content\r\n   */\r\n  const autoSize = () => {\r\n    const el = document.querySelector('.search-input') as HTMLTextAreaElement;\r\n    if (!el) return;\r\n    \r\n    // Reset to default height when empty\r\n    if (!searchQuery.trim()) {\r\n      el.style.height = '44px'; // Default height\r\n      el.style.overflowY = 'hidden';\r\n      return;\r\n    }\r\n    \r\n    // Otherwise handle auto-sizing as before\r\n    el.style.height = \"auto\";\r\n    const next = el.scrollHeight;\r\n    el.style.height = next + \"px\";\r\n    \r\n    // Check if we've hit max height\r\n    const max = parseFloat(getComputedStyle(el).maxHeight);\r\n    el.style.overflowY = next > max ? \"auto\" : \"hidden\";\r\n  };\r\n  \r\n  /**\r\n   * CLEAR SEARCH INPUT\r\n   * Clears search input and resets its height to default\r\n   */\r\n  const handleClearSearch = () => {\r\n    setSearchQuery('');\r\n    // Force a reset after state update\r\n    setTimeout(() => {\r\n      const el = document.querySelector('.search-input') as HTMLTextAreaElement;\r\n      if (el) el.style.height = '44px';\r\n    }, 10);\r\n  };\r\n\r\n  // ================================\r\n  // AUTHENTICATION HANDLERS\r\n  // ================================\r\n\r\n  /**\r\n   * USER CHANGE HANDLER\r\n   * Handles when user authentication state changes\r\n   * @param user - User object from auth service\r\n   */\r\n  const handleUserChange = (user: any) => {\r\n    console.log('User changed:', user);\r\n  };\r\n\r\n  /**\r\n   * SIGN IN HANDLER\r\n   * Handles successful user sign-in\r\n   * @param user - Authenticated user object\r\n   */\r\n  const handleSignIn = (user: any) => {\r\n    console.log('User signed in:', user);\r\n  };\r\n\r\n  /**\r\n   * SIGN OUT HANDLER\r\n   * Handles user sign-out action\r\n   */\r\n  const handleSignOut = () => {\r\n    console.log('User signed out');\r\n  };\r\n\r\n  // ================================\r\n  // MAIN SEARCH FUNCTIONALITY\r\n  // ================================\r\n\r\n  /**\r\n   * MAIN SEARCH HANDLER\r\n   * Primary search function that handles text-based health queries\r\n   * Flow: Check cache → API call → Save to cache → Navigate to results\r\n   * Uses 4-step fallback strategy for reliability\r\n   */\r\n  const handleSearch = async (queryParam?: string) => {\r\n    const queryToUse = queryParam || searchQuery;\r\n    if (!queryToUse.trim() || isLoading) return;\r\n    \r\n    // Create new AbortController for this request\r\n    abortControllerRef.current = new AbortController();\r\n    const signal = abortControllerRef.current.signal;\r\n    \r\n    setIsLoading(true);\r\n    setLoadingMessage('Initializing search...');\r\n    \r\n    try {\r\n      // Step 1: Check database cache first\r\n      setLoadingMessage('Checking cache...');\r\n      \r\n      try {\r\n        const response = await fetch(getApiEndpoint(`/cache/get?q=${encodeURIComponent(queryToUse)}`), { signal });\r\n        \r\n        if (response.ok) {\r\n          const cachedData = await response.json();\r\n          console.log('Using cached results from database');\r\n          setLoadingMessage('Loading cached results...');\r\n          await new Promise(resolve => setTimeout(resolve, 300));\r\n          \r\n          setIsLoading(false);\r\n          // Pass the cached data via navigation state\r\n          navigate(`/results?q=${encodeURIComponent(queryToUse)}`, {\r\n            state: {\r\n              results: cachedData.results,\r\n              dataSource: cachedData.source || 'cache',\r\n              fromSearch: true\r\n            }\r\n          });\r\n          return;\r\n        }\r\n      } catch (cacheError) {\r\n        // Handle AbortError specifically\r\n        if (cacheError.name === 'AbortError') {\r\n          console.log('Cache request was cancelled');\r\n          return; // Exit early\r\n        }\r\n        logger.debug('No cache found, proceeding with API call');\r\n      }\r\n\r\n      // Step 2: Get fresh results from API\r\n      setLoadingMessage('Analyzing with AI...');\r\n      logger.debug('Getting fresh results for query', { query: queryToUse });\r\n      \r\n      try {\r\n        // Use WiHy Unified API for search\r\n        logger.apiRequest('WiHy API search', { query: queryToUse });\r\n        const wihyResponse = await wihyAPI.searchHealth(queryToUse);\r\n        \r\n        if (wihyResponse.success) {\r\n          // Convert WiHy response to expected format\r\n          const searchResults = {\r\n            summary: wihyResponse.wihy_response.core_principle,\r\n            details: wihyAPI.formatWihyResponse(wihyResponse),\r\n            sources: wihyAPI.extractCitations(wihyResponse),\r\n            recommendations: wihyAPI.extractRecommendations(wihyResponse),\r\n            relatedTopics: [],\r\n            medicalDisclaimer: 'This guidance is based on evidence-based health principles. Always consult healthcare professionals for personalized medical advice.',\r\n            dataSource: 'wihy'\r\n          };\r\n          \r\n          console.log('WiHy search results received:', searchResults);\r\n        \r\n          const isValidResult = searchResults && \r\n            typeof searchResults === 'object' && \r\n            searchResults !== null &&\r\n            (searchResults.summary || searchResults.details || Object.keys(searchResults).length > 0);\r\n          \r\n          if (isValidResult) {\r\n            logger.info('Valid search results confirmed');\r\n            \r\n            // Step 3: Save to database cache (async, don't wait)\r\n            setLoadingMessage('Caching results...');\r\n            \r\n            fetch(getApiEndpoint('/cache/save'), {\r\n              method: 'POST',\r\n              headers: {\r\n                'Content-Type': 'application/json',\r\n              },\r\n              body: JSON.stringify({\r\n                query: queryToUse,\r\n                results: searchResults,\r\n                source: 'wihy'\r\n              })\r\n            }).then(response => {\r\n              if (response.ok) {\r\n                logger.cache('Results saved to database cache');\r\n              } else {\r\n                logger.warn('Failed to save to cache');\r\n              }\r\n            }).catch(err => {\r\n              logger.warn('Cache save error', { error: err });\r\n            });\r\n            \r\n            setLoadingMessage('Results ready!');\r\n            await new Promise(resolve => setTimeout(resolve, 300));\r\n            \r\n            setIsLoading(false);\r\n            logger.debug('Navigating to results page with data');\r\n            \r\n            // Pass the fresh results via navigation state\r\n            navigate(`/results?q=${encodeURIComponent(queryToUse)}`, {\r\n              state: {\r\n                results: searchResults,\r\n                dataSource: 'wihy',\r\n                fromSearch: true\r\n              }\r\n            });\r\n            return;\r\n          } else {\r\n            throw new Error('WiHy API returned invalid results');\r\n          }\r\n        } else {\r\n          throw new Error('WiHy API request failed');\r\n        }\r\n        \r\n      } catch (apiError) {\r\n        // Handle AbortError specifically\r\n        if (apiError.name === 'AbortError') {\r\n          logger.debug('API request was cancelled');\r\n          return; // Exit early\r\n        }\r\n        \r\n        const isNetworkError = apiError.message?.includes('NETWORK_ERROR') || \r\n                              apiError.message?.includes('TIMEOUT_ERROR') ||\r\n                              apiError.message?.includes('fetch') || \r\n                              apiError.message?.includes('network') || \r\n                              apiError.name === 'TypeError' ||\r\n                              apiError.message?.includes('Failed to fetch');\r\n        \r\n        const isServerError = apiError.message?.includes('SERVER_ERROR');\r\n        \r\n        if (isNetworkError) {\r\n          logger.error('Network error in health search:', apiError);\r\n          setLoadingMessage('Connection trouble! 🌐 Our servers might be napping...');\r\n        } else if (isServerError) {\r\n          logger.error('Server error in health search:', apiError);\r\n          setLoadingMessage('Our servers are taking a coffee break ☕ Come back in a few minutes!');\r\n        } else {\r\n          logger.error('Health search service failed:', apiError);\r\n          setLoadingMessage('Search hit a snag! 🔍 Trying backup options...');\r\n        }\r\n        \r\n        // Step 4: Try similar results as fallback\r\n        setTimeout(() => {\r\n          setLoadingMessage('Searching for similar results...');\r\n        }, 2000);\r\n        \r\n        try {\r\n          const similarResponse = await fetch(getApiEndpoint(`/cache/similar?q=${encodeURIComponent(queryToUse)}`));\r\n          \r\n          if (similarResponse.ok) {\r\n            const similarResults = await similarResponse.json();\r\n            \r\n            if (similarResults.length > 0) {\r\n              console.log('Using similar cached results');\r\n              setLoadingMessage('Loading similar results...');\r\n              await new Promise(resolve => setTimeout(resolve, 300));\r\n              \r\n              setIsLoading(false);\r\n              // Pass similar results via navigation state\r\n              navigate(`/results?q=${encodeURIComponent(queryToUse)}`, {\r\n                state: {\r\n                  results: similarResults[0].results,\r\n                  dataSource: 'similar',\r\n                  fromSearch: true\r\n                }\r\n              });\r\n              return;\r\n            }\r\n          }\r\n        } catch (similarError) {\r\n          console.warn('Similar results search failed:', similarError);\r\n        }\r\n        \r\n        setLoadingMessage('No results found. Please try a different search.');\r\n        setTimeout(() => {\r\n          setIsLoading(false);\r\n          setLoadingMessage('Searching...');\r\n        }, 3000);\r\n        return;\r\n      }\r\n        \r\n    } catch (error) {\r\n      // Handle AbortError specifically\r\n      if (error.name === 'AbortError') {\r\n        logger.debug('Search request was cancelled');\r\n        return; // Exit early\r\n      }\r\n      \r\n      logger.error(\"Search error:\", error);\r\n      \r\n      // Check for specific error types\r\n      const errorMessage = error.message || '';\r\n      \r\n      if (errorMessage.includes('NETWORK_ERROR') || errorMessage.includes('TIMEOUT_ERROR')) {\r\n        setLoadingMessage('Oops! Our servers are taking a coffee break ☕ Come back in a few minutes!');\r\n      } else if (errorMessage.includes('SERVER_ERROR')) {\r\n        setLoadingMessage('Server hiccup! 🤖 Please try again in a moment.');\r\n      } else if (errorMessage.includes('fetch') || \r\n                 errorMessage.includes('network') || \r\n                 error.name === 'TypeError') {\r\n        setLoadingMessage('Connection trouble! 📡 Please check your internet and try again.');\r\n      } else {\r\n        setLoadingMessage('Something went wrong! Please try your search again 🔄');\r\n      }\r\n      \r\n      setTimeout(() => {\r\n        setIsLoading(false);\r\n        setLoadingMessage('Searching...');\r\n      }, 4000); // Give a bit more time to read the friendly message\r\n    }\r\n  };\r\n\r\n  /**\r\n   * SEARCH CANCELLATION HANDLER\r\n   * Cancels in-progress search requests and resets loading state\r\n   * Called when user clicks the cancel button in loading overlay\r\n   */\r\n  const handleCancelSearch = () => {\r\n    if (abortControllerRef.current) {\r\n      abortControllerRef.current.abort();\r\n      abortControllerRef.current = null;\r\n    }\r\n    setIsLoading(false);\r\n    setLoadingMessage('Searching...');\r\n  };\r\n\r\n  // ================================\r\n  // IMAGE ANALYSIS FUNCTIONALITY\r\n  // ================================\r\n\r\n  /**\r\n   * IMAGE ANALYSIS COMPLETION HANDLER\r\n   * Processes results from image upload and food recognition\r\n   * Triggered when ImageUploadModal completes food detection\r\n   * @param foodName - The detected food name from image analysis\r\n   */\r\n  const handleAnalysisComplete = async (foodName: string): Promise<void> => {\r\n    if (!foodName || isLoading) {\r\n      setIsUploadModalOpen(false);\r\n      return;\r\n    }\r\n\r\n    // Create abort controller for this request too\r\n    abortControllerRef.current = new AbortController();\r\n    const signal = abortControllerRef.current.signal;\r\n    \r\n    setIsLoading(true);\r\n    setLoadingMessage('Processing image analysis...');\r\n    \r\n    try {\r\n      console.log(\"Image analysis completed, food detected:\", foodName);\r\n      setSearchQuery(foodName);\r\n      \r\n      // Step 1: Check database cache for nutrition data\r\n      setLoadingMessage('Checking nutrition database...');\r\n      \r\n      try {\r\n        const response = await fetch(getApiEndpoint(`/cache/get?q=${encodeURIComponent(foodName)}`));\r\n        \r\n        if (response.ok) {\r\n          const cachedData = await response.json();\r\n          console.log('Using cached nutrition data');\r\n          setLoadingMessage('Loading cached nutrition data...');\r\n          await new Promise(resolve => setTimeout(resolve, 300));\r\n          \r\n          setIsLoading(false);\r\n          // Pass the cached data via navigation state\r\n          navigate(`/results?q=${encodeURIComponent(foodName)}`, {\r\n            state: {\r\n              results: cachedData.results,\r\n              dataSource: cachedData.source || 'cache',\r\n              fromSearch: true\r\n            }\r\n          });\r\n          return;\r\n        }\r\n      } catch (cacheError) {\r\n        console.log('No cached nutrition data found');\r\n      }\r\n      \r\n      // Step 2: Get fresh nutrition data\r\n      setLoadingMessage('Analyzing nutrition content...');\r\n      \r\n      try {\r\n        console.log('Making WiHy API nutrition search for:', foodName);\r\n        const wihyResponse = await wihyAPI.searchNutrition(foodName);\r\n        \r\n        if (wihyResponse.success) {\r\n          // Convert WiHy response to expected format\r\n          const nutritionResults = {\r\n            summary: wihyResponse.wihy_response.core_principle,\r\n            details: wihyAPI.formatWihyResponse(wihyResponse),\r\n            sources: wihyAPI.extractCitations(wihyResponse),\r\n            recommendations: wihyAPI.extractRecommendations(wihyResponse),\r\n            relatedTopics: [],\r\n            medicalDisclaimer: 'This guidance is based on evidence-based health principles. Always consult healthcare professionals for personalized medical advice.',\r\n            dataSource: 'wihy'\r\n          };\r\n          \r\n          const isValidResult = nutritionResults && \r\n            typeof nutritionResults === 'object' && \r\n            nutritionResults !== null &&\r\n            (nutritionResults.summary || nutritionResults.details || Object.keys(nutritionResults).length > 0);\r\n          \r\n          if (isValidResult) {\r\n            // Step 3: Save to database cache (async, don't wait)\r\n            setLoadingMessage('Caching nutrition data...');\r\n            \r\n            fetch(getApiEndpoint('/cache/save'), {\r\n              method: 'POST',\r\n              headers: {\r\n                'Content-Type': 'application/json',\r\n              },\r\n              body: JSON.stringify({\r\n                query: foodName,\r\n                results: nutritionResults,\r\n                source: 'wihy'\r\n              })\r\n            }).then(response => {\r\n              if (response.ok) {\r\n                console.log('Nutrition data saved to cache');\r\n              } else {\r\n                console.warn('Failed to save nutrition data to cache');\r\n              }\r\n            }).catch(err => {\r\n              console.warn('Nutrition cache save error:', err);\r\n            });\r\n            \r\n            setLoadingMessage('Nutrition analysis complete!');\r\n            await new Promise(resolve => setTimeout(resolve, 300));\r\n            \r\n            setIsLoading(false);\r\n            // Pass the fresh nutrition results via navigation state\r\n            navigate(`/results?q=${encodeURIComponent(foodName)}`, {\r\n              state: {\r\n                results: nutritionResults,\r\n                dataSource: 'wihy',\r\n                fromSearch: true\r\n              }\r\n            });\r\n            return;\r\n          } else {\r\n            throw new Error('WiHy API returned invalid nutrition results');\r\n          }\r\n        } else {\r\n          throw new Error('WiHy nutrition API request failed');\r\n        }\r\n        \r\n      } catch (nutritionError) {\r\n        console.error('Nutrition analysis failed:', nutritionError);\r\n        \r\n        // Try similar results as fallback\r\n        try {\r\n          const similarResponse = await fetch(getApiEndpoint(`/cache/similar?q=${encodeURIComponent(foodName)}`));\r\n          \r\n          if (similarResponse.ok) {\r\n            const similarResults = await similarResponse.json();\r\n            \r\n            if (similarResults.length > 0) {\r\n              console.log('Using similar nutrition data');\r\n              setLoadingMessage('Loading similar nutrition data...');\r\n              await new Promise(resolve => setTimeout(resolve, 300));\r\n              \r\n              setIsLoading(false);\r\n              navigate(`/results?q=${encodeURIComponent(foodName)}`);\r\n              return;\r\n            }\r\n          }\r\n        } catch (similarError) {\r\n          console.warn('Similar nutrition search failed:', similarError);\r\n        }\r\n        \r\n        setLoadingMessage('Hmm, we couldn\\'t figure out what that food is 🤔 Try a different photo or search manually!');\r\n        setTimeout(() => {\r\n          setIsLoading(false);\r\n          setLoadingMessage('Searching...');\r\n        }, 4000);\r\n        return;\r\n      }\r\n      \r\n    } catch (error) {\r\n      logger.error(\"Error processing analyzed food:\", error);\r\n      \r\n      const isNetworkError = error.message?.includes('fetch') || \r\n                            error.message?.includes('network') || \r\n                            error.name === 'TypeError';\r\n      \r\n      if (isNetworkError) {\r\n        setLoadingMessage('Oops! Connection hiccup 📡 Please try again in a moment!');\r\n      } else {\r\n        setLoadingMessage('Food analysis had a little hiccup 🍎 Please try again!');\r\n      }\r\n      \r\n      setTimeout(() => {\r\n        setIsLoading(false);\r\n        setLoadingMessage('Searching...');\r\n      }, 2000);\r\n    } finally {\r\n      setIsUploadModalOpen(false);\r\n    }\r\n  };\r\n\r\n  // ================================\r\n  // LIFECYCLE HOOKS\r\n  // ================================\r\n\r\n  /**\r\n   * CLEANUP EFFECT\r\n   * Resets loading state when component unmounts\r\n   * Prevents memory leaks and state persistence issues\r\n   */\r\n  useEffect(() => {\r\n    return () => {\r\n      setIsLoading(false);\r\n      setLoadingMessage('Searching...');\r\n    };\r\n  }, []);\r\n\r\n  // Add this with your other useEffects\r\n  useEffect(() => {\r\n    // Call autoSize whenever searchQuery changes\r\n    if (searchQuery !== undefined) {\r\n      autoSize();\r\n    }\r\n  }, [searchQuery]);\r\n\r\n  // ================================\r\n  // UI COMPONENTS\r\n  // ================================\r\n\r\n  /**\r\n   * LOADING OVERLAY COMPONENT\r\n   * Shows animated loading screen with progress bar during search operations\r\n   * @param message - Current loading message to display\r\n   * @param progress - Progress percentage (0-100) for progress bar\r\n   */\r\n  const LoadingOverlay: React.FC<{ message: string; progress: number }> = ({ message, progress }) => (\r\n    <div style={{\r\n      position: 'fixed',\r\n      top: 0,\r\n      left: 0,\r\n      right: 0,\r\n      bottom: 0,\r\n      backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n      display: 'flex',\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n      zIndex: 9999\r\n    }}>\r\n      <div style={{\r\n        backgroundColor: 'white',\r\n        borderRadius: '12px',\r\n        padding: '40px',\r\n        textAlign: 'center',\r\n        minWidth: '320px',\r\n        boxShadow: '0 10px 25px rgba(0, 0, 0, 0.2)'\r\n      }}>\r\n      \r\n        {/* Spinner */}\r\n        <div style={{ margin: '0 auto 24px auto' }}>\r\n          <img \r\n            src=\"/assets/whatishealthyspinner.gif\" \r\n            alt=\"Loading...\" \r\n            style={{\r\n              width: '48px',\r\n              height: '48px',\r\n              objectFit: 'contain'\r\n            }}\r\n          />\r\n        </div>\r\n        \r\n        {/* Title */}\r\n        <h3 style={{\r\n          margin: '0 0 8px 0',\r\n          fontSize: '24px',\r\n          fontWeight: '600',\r\n          color: '#1f2937'\r\n        }}>\r\n          Loading Content\r\n        </h3>\r\n        \r\n        {/* Subtitle */}\r\n        <p style={{\r\n          margin: '0 0 24px 0',\r\n          fontSize: '16px',\r\n          color: '#6b7280'\r\n        }}>\r\n          Please wait while we process your request...\r\n        </p>\r\n        \r\n        {/* Progress Bar */}\r\n        <div style={{\r\n          width: '100%',\r\n          height: '8px',\r\n          backgroundColor: '#e5e7eb',\r\n          borderRadius: '4px',\r\n          overflow: 'hidden',\r\n          marginBottom: '12px'\r\n        }}>\r\n          <div style={{\r\n            width: `${progress}%`,\r\n            height: '100%',\r\n            backgroundColor: '#3b82f6',\r\n            borderRadius: '4px',\r\n            transition: 'width 0.3s ease'\r\n          }} />\r\n        </div>\r\n        \r\n        <div style={{\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          justifyContent: 'space-between',\r\n          marginTop: '16px'\r\n        }}>\r\n          <p style={{\r\n            margin: 0,\r\n            fontSize: '14px',\r\n            color: '#6b7280'\r\n          }}>\r\n            {progress}% Complete\r\n          </p>\r\n          \r\n          {/* Cancel button */}\r\n          <button\r\n            onClick={handleCancelSearch}\r\n            style={{\r\n              backgroundColor: 'transparent',\r\n              color: '#555',\r\n              border: '1px solid #ccc',\r\n              borderRadius: '16px',\r\n              padding: '8px 16px',\r\n              fontSize: '14px',\r\n              fontWeight: '500',\r\n              cursor: 'pointer',\r\n              transition: 'all 0.2s ease'\r\n            }}\r\n            onMouseOver={(e) => {\r\n              e.currentTarget.style.backgroundColor = '#f1f1f1';\r\n              e.currentTarget.style.color = '#333';\r\n              e.currentTarget.style.borderColor = '#aaa';\r\n            }}\r\n            onMouseOut={(e) => {\r\n              e.currentTarget.style.backgroundColor = 'transparent';\r\n              e.currentTarget.style.color = '#555';\r\n              e.currentTarget.style.borderColor = '#ccc';\r\n            }}\r\n          >\r\n            Cancel\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  // ================================\r\n  // MAIN COMPONENT RENDER\r\n  // ================================\r\n\r\n  return (\r\n    <div className=\"search-landing\">\r\n      {/* LOADING OVERLAY - Shows during search operations */}\r\n      {isLoading && (\r\n        <LoadingOverlay \r\n          message={loadingMessage}\r\n          progress={progressFromMessage(loadingMessage)}\r\n        />\r\n      )}\r\n      \r\n      {/* AUTHENTICATION COMPONENT - Top-right login/logout */}\r\n      <div style={{\r\n        position: 'fixed',\r\n        top: '20px',\r\n        right: '20px',\r\n        zIndex: 1000\r\n      }}>\r\n        <MultiAuthLogin className=\"main-login-button\" />\r\n      </div>\r\n\r\n      {/* MAIN SEARCH INTERFACE */}\r\n      <div className=\"search-container-centered\">\r\n        {/* LOGO SECTION - Shows either image logo or text fallback */}\r\n        <div className=\"logo-container\">\r\n          {!imageError ? (\r\n            <img \r\n              src=\"/assets/wihylogo.png\"\r\n              alt=\"What is Healthy?\"\r\n              className=\"search-logo-image\"\r\n              onError={() => setImageError(true)}\r\n              onLoad={() => setImageError(false)}\r\n              onClick={() => navigate('/')}\r\n              style={{ cursor: 'pointer' }}\r\n            />\r\n          ) : (\r\n            <h1 \r\n              className=\"search-logo\"\r\n              onClick={() => navigate('/')}\r\n              style={{ cursor: 'pointer' }}\r\n            >\r\n              What is Healthy?\r\n            </h1>\r\n          )}\r\n        </div>\r\n        \r\n        {/* SEARCH INPUT SECTION - Main search bar with icons */}\r\n        <div className=\"search-input-container\">\r\n          <form onSubmit={(e) => { \r\n            e.preventDefault();\r\n            handleSearch();\r\n          }}>\r\n            <textarea\r\n              value={searchQuery}\r\n              onChange={(e) => {\r\n                setSearchQuery(e.target.value);\r\n              }}\r\n              onKeyDown={(e) => {\r\n                if (e.key === 'Enter' && !e.shiftKey) {\r\n                  e.preventDefault();\r\n                  handleSearch();\r\n                }\r\n              }}\r\n              placeholder=\"Ask anything about health...\"\r\n              className=\"search-input\"\r\n              autoFocus\r\n              disabled={isLoading}\r\n              rows={1}\r\n              style={{\r\n                resize: 'none',\r\n                overflow: 'hidden',\r\n                minHeight: '44px',\r\n                height: 'auto',\r\n                paddingRight: '100px',\r\n                width: '100%', // Use full width of container\r\n                boxSizing: 'border-box' // Include padding in width calculation\r\n              }}\r\n              onInput={(e) => {\r\n                // Auto-resize height algorithm\r\n                const target = e.target as HTMLTextAreaElement;\r\n                target.style.height = '0';\r\n                const scrollHeight = target.scrollHeight;\r\n                target.style.height = scrollHeight + 'px';\r\n              }}\r\n            />\r\n          </form>\r\n\r\n          {/* SEARCH ICONS - Clear, Camera, Voice input buttons */}\r\n          <div className=\"search-icons\">\r\n            {/* CLEAR BUTTON - Clears current search query */}\r\n            {searchQuery && (\r\n              <button \r\n                className=\"icon-button clear-button\" \r\n                onClick={handleClearSearch}\r\n                aria-label=\"Clear\"\r\n              >\r\n                <svg viewBox=\"0 0 24 24\" width=\"24\" height=\"24\">\r\n                  <path d=\"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z\" fill=\"currentColor\" />\r\n                </svg>\r\n              </button>\r\n            )}\r\n            \r\n            {/* CAMERA BUTTON - Opens image upload modal */}\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => setIsUploadModalOpen(true)}\r\n              className=\"icon-button\"\r\n              aria-label=\"Upload image\"\r\n              disabled={isLoading}\r\n            >\r\n              <svg viewBox=\"0 0 24 24\" fill=\"currentColor\">\r\n                <path d=\"M9 2L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2H9zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5z\"/>\r\n              </svg>\r\n            </button>\r\n            \r\n            {/* VOICE INPUT BUTTON - Activates speech recognition */}\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => {\r\n                if (isLoading) return;\r\n                \r\n                if (!('webkitSpeechRecognition' in window)) {\r\n                  alert('Speech recognition not supported in this browser');\r\n                  return;\r\n                }\r\n\r\n                if (!recognitionRef.current) {\r\n                  const recognition = new (window as any).webkitSpeechRecognition();\r\n                  recognition.continuous = false;\r\n                  recognition.interimResults = false;\r\n                  recognition.lang = 'en-US';\r\n\r\n                  recognition.onstart = () => setIsListening(true);\r\n                  recognition.onresult = (event: any) => {\r\n                    const transcript = event.results[0][0].transcript;\r\n                    setSearchQuery(transcript);\r\n                    setIsListening(false);\r\n                  };\r\n                  recognition.onerror = () => setIsListening(false);\r\n                  recognition.onend = () => setIsListening(false);\r\n\r\n                  recognitionRef.current = recognition;\r\n                }\r\n\r\n                if (!isListening) {\r\n                  recognitionRef.current.start();\r\n                } else {\r\n                  recognitionRef.current.stop();\r\n                  setIsListening(false);\r\n                }\r\n              }}\r\n              className={`icon-button ${isListening ? 'listening' : ''}`}\r\n              aria-label={isListening ? 'Stop listening' : 'Start voice input'}\r\n              disabled={isLoading}\r\n            >\r\n              <svg viewBox=\"0 0 24 24\" fill=\"currentColor\">\r\n                <path d=\"M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z\"/>\r\n                <path d=\"M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.28c3.39-.49 6-3.3 6-6.72h-2z\"/>\r\n              </svg>\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* ACTION BUTTONS - Primary search and secondary \"feeling healthy\" */}\r\n        <div className=\"search-buttons\">\r\n          {/* PRIMARY SEARCH BUTTON - Triggers main search function */}\r\n          <button \r\n            onClick={(e) => {\r\n              e.preventDefault();\r\n              handleSearch();\r\n            }}\r\n            className=\"search-btn primary\"\r\n            disabled={!searchQuery.trim() || isLoading}\r\n          >\r\n            {isLoading ? loadingMessage : 'Analyze Nutrition'}\r\n          </button>\r\n          \r\n          {/* FEELING HEALTHY BUTTON - Shows/hides health news feed */}\r\n          <button \r\n            onClick={() => {\r\n              if (isLoading) return;\r\n              \r\n              if (showFeelingHealthyContent) {\r\n                // If news is showing, close it and set \"What is Healthy?\" in search\r\n                setShowFeelingHealthyContent(false);\r\n                setSearchQuery('What is Healthy?');\r\n              } else {\r\n                // Show the news feed\r\n                setShowFeelingHealthyContent(true);\r\n              }\r\n            }}\r\n            className=\"search-btn secondary\"\r\n            type=\"button\"\r\n            style={{ color: '#000000' }}\r\n            disabled={isLoading}\r\n          >\r\n            I'm Feeling Healthy\r\n          </button>\r\n        </div>\r\n      </div>\r\n      \r\n      {/* HEALTH NEWS FEED - Shows when \"I'm Feeling Healthy\" is active */}\r\n      {showFeelingHealthyContent && (\r\n        <div \r\n          className=\"feeling-healthy-section\"\r\n          onClick={(e) => {\r\n            // Close if clicking on the background, not the content\r\n            if (e.target === e.currentTarget) {\r\n              setShowFeelingHealthyContent(false);\r\n              setSearchQuery('What is Healthy?');\r\n            }\r\n          }}\r\n        >\r\n          <div onClick={(e) => e.stopPropagation()}>\r\n            <HealthNewsFeed \r\n              maxArticles={6}\r\n              setSearchQuery={setSearchQuery}\r\n              triggerSearch={(customQuery?: string) => {\r\n                setShowFeelingHealthyContent(false); // Close news feed\r\n                // Use the custom query if provided, otherwise use current searchQuery\r\n                if (customQuery) {\r\n                  handleSearch(customQuery);\r\n                } else {\r\n                  handleSearch();\r\n                }\r\n              }}\r\n            />\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* IMAGE UPLOAD MODAL - Opens when camera button is clicked */}\r\n      <ImageUploadModal\r\n        isOpen={isUploadModalOpen}\r\n        onClose={() => setIsUploadModalOpen(false)} // FIXED: Changed from setIsUploadModal to setIsUploadModalOpen\r\n        onAnalysisComplete={handleAnalysisComplete}\r\n        title=\"Upload Image\"\r\n        subtitle=\"Upload Image for Analysis\"\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default VHealthSearch;\r\n\r\n/* Add this CSS to your styles\r\n@keyframes spin {\r\n  0% { transform: rotate(0deg); }\r\n  100% { transform: rotate(360deg); }\r\n}\r\n*/"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}