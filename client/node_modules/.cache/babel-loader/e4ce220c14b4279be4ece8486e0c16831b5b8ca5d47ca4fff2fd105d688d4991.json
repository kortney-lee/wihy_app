{"ast":null,"code":"import React,{useEffect,useState}from'react';import{Chart as ChartJS,ArcElement,Tooltip,Legend}from'chart.js';import{Doughnut}from'react-chartjs-2';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";ChartJS.register(ArcElement,Tooltip,Legend);/* ====================== Evidence Confidence (Gated) ====================== *//** Trusted domains for quick credibility checks. Tune anytime. */const TRUSTED_DOMAINS={'nih.gov':1,'ncbi.nlm.nih.gov':1,// PubMed\n'who.int':1,'cdc.gov':1,'fda.gov':1,'usda.gov':1,'jamanetwork.com':1,'nejm.org':1,'thelancet.com':1,'bmj.com':1,'nature.com':1,'science.org':1,'mayoclinic.org':1,'harvard.edu':1,'stanford.edu':1,'clevelandclinic.org':1,'uptodate.com':1};const extractUrls=text=>{const urlRegex=/(https?:\\/\\/[^\\s)]+)(?=\\)|\\s|$)/g;return[...text.matchAll(urlRegex)].map(m=>m[1]);};const domainKey=url=>{try{const u=new URL(url);const parts=u.hostname.split('.');return parts.slice(-2).join('.');}catch(_unused){return null;}};const hasStrongId=text=>/doi\\.org\\/10\\./i.test(text)||/pubmed\\.ncbi\\.nlm\\.nih\\.gov\\/\\d+/i.test(text);const hasSpecificNumbers=lower=>/\\b\\d+(\\.\\d+)?\\s?(mg|g|mcg|iu|kcal|calories|%)\\b/.test(lower)||/\\b\\d+(\\.\\d+)?%/.test(lower);const hypeOrBS=lower=>/(miracle|cure-all|100% guaranteed|secret|instantly|revolutionary|breakthrough|detox scam|shocking)/i.test(lower);const contradictionWithoutRefs=lower=>/(contradictory|no consensus|insufficient evidence)/i.test(lower)&&!hasStrongId(lower)&&extractUrls(lower).length===0;const recencyOK=lower=>{const years=(lower.match(/\\b(20\\d{2}|19\\d{2})\\b/g)||[]).map(y=>parseInt(y,10));if(years.length===0)return true;// no year mentioned: don't punish\nconst mostRecent=Math.max(...years);return new Date().getFullYear()-mostRecent<=5;};const sourceGate=(text,dataSource)=>{// Database sources and WiHy count as trusted.\nif(dataSource==='vnutrition'||dataSource==='local'||dataSource==='wihy')return true;// Otherwise require a strong id or a trusted domain link.\nif(hasStrongId(text))return true;const urls=extractUrls(text);for(const u of urls){const key=domainKey(u);if(key&&TRUSTED_DOMAINS[key])return true;}return false;};/**\r\n * Evaluate evidence confidence with HARD GATES to reduce ambiguity.\r\n * Returns a discrete score for the ring (0.90 | 0.60 | 0.20) + verdict + reasons.\r\n */function evaluateEvidenceConfidence(query,results,dataSource,citations){const text=results||'';const lower=text.toLowerCase();// Short-circuit invalid answers/queries\nif(!text.trim()||/please (provide|clarify)/i.test(text)){return{score:0.20,verdict:'BAD',reasons:['No usable answer']};}if(/not (a|the) recognized|no information found|could not find|doesn'?t seem/i.test(text)){return{score:0.20,verdict:'BAD',reasons:['Unrecognized topic']};}if(/^[a-z0-9]{1,7}$/i.test(query)&&!/^(hiv|flu|cold|covid|bp|bmi|gerd|ibs|std|uti)$/i.test(query)){return{score:0.20,verdict:'BAD',reasons:['Query looks invalid']};}// Merge citations into text for gate checks\nconst citationsText=(citations||[]).join(' ');const textWithCites=text+' '+citationsText;// Gates\nconst gates={source:sourceGate(textWithCites,dataSource),citations:hasStrongId(textWithCites)||extractUrls(textWithCites).length>0,specificity:hasSpecificNumbers(lower),consistency:!(hypeOrBS(lower)||contradictionWithoutRefs(lower)),recency:recencyOK(lower)};const passed=Object.values(gates).filter(Boolean).length;const criticalOkay=(gates.source||gates.citations)&&gates.specificity;let verdict;if((dataSource==='vnutrition'||dataSource==='local'||dataSource==='wihy')&&criticalOkay){verdict='GOOD';}else if(passed>=4&&criticalOkay){verdict='GOOD';}else if(passed===3&&!hypeOrBS(lower)){verdict='REVIEW';// narrow gray zone\n}else{verdict='BAD';}// Discrete mapping to compress gray area\nconst score=verdict==='GOOD'?0.90:verdict==='REVIEW'?0.60:0.20;const reasons=[];if(!gates.source)reasons.push('Weak source');if(!gates.citations)reasons.push('No citations');if(!gates.specificity)reasons.push('Low numeric specificity');if(!gates.consistency)reasons.push('Inconsistent language');if(!gates.recency)reasons.push('Out-of-date');return{score,verdict,reasons};}/* ====================== Component ====================== */const ResultQualityPie=_ref=>{let{query,results,dataSource,citations}=_ref;const[evaluation,setEvaluation]=useState({score:0.20,verdict:'BAD',reasons:['Loading...']});// Debug logging to see what props are being received\nuseEffect(()=>{console.log('ResultQualityPie received props:',{query,results:(results===null||results===void 0?void 0:results.substring(0,100))+'...',dataSource,citations,hasResults:!!results&&results.trim()!==''});},[query,results,dataSource,citations]);// Evaluate when props change and we have valid data\nuseEffect(()=>{if(query&&results&&results.trim()!==''&&dataSource){console.log('Evaluating evidence confidence...');const newEvaluation=evaluateEvidenceConfidence(query,results,dataSource,citations);console.log('Evidence evaluation result:',newEvaluation);setEvaluation(newEvaluation);}else{console.log('Not evaluating - missing required props:',{hasQuery:!!query,hasResults:!!results&&results.trim()!=='',hasDataSource:!!dataSource});// Set a default evaluation for missing data\nsetEvaluation({score:0.20,verdict:'BAD',reasons:['Waiting for results...']});}},[query,results,dataSource,citations]);const{score,verdict,reasons}=evaluation;const percentage=Math.round(score*100);const remaining=100-percentage;// Colors by verdict (lock to clear categories)\nconst colorByVerdict=v=>v==='GOOD'?'#10B981':v==='REVIEW'?'#F59E0B':'#EF4444';const labelByVerdict=v=>v==='GOOD'?'Good':v==='REVIEW'?'Needs review':'Poor';const ringColor=colorByVerdict(verdict);const verdictLabel=labelByVerdict(verdict);const data={datasets:[{data:[percentage,remaining],backgroundColor:[ringColor,'#E5E7EB'],borderWidth:0,cutout:'70%'}]};const options={responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false},tooltip:{enabled:false}}};const legendGoodColor=verdict==='BAD'?'#E5E7EB':'#10B981';const legendBadColor=verdict==='BAD'?'#EF4444':'#E5E7EB';return/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:'center'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{position:'relative',height:'200px',width:'200px',margin:'0 auto'},children:[/*#__PURE__*/_jsx(Doughnut,{data:data,options:options}),/*#__PURE__*/_jsxs(\"div\",{style:{position:'absolute',top:'50%',left:'50%',transform:'translate(-50%, -50%)',textAlign:'center'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:'2rem',fontWeight:'bold',color:'#374151'},children:[percentage,\"%\"]}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'0.875rem',color:'#6B7280'},children:\"Evidence\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'1rem'},children:[/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',alignItems:'center',justifyContent:'center',marginBottom:'0.5rem'},children:/*#__PURE__*/_jsx(\"span\",{style:{fontWeight:500,color:ringColor,fontSize:'1rem'},children:verdictLabel})}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'center',gap:'1rem',fontSize:'0.875rem'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'0.25rem'},children:[/*#__PURE__*/_jsx(\"div\",{style:{width:'12px',height:'12px',backgroundColor:legendGoodColor,borderRadius:'2px'}}),/*#__PURE__*/_jsxs(\"span\",{children:[\"Good: \",percentage,\"%\"]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'0.25rem'},children:[/*#__PURE__*/_jsx(\"div\",{style:{width:'12px',height:'12px',backgroundColor:legendBadColor,borderRadius:'2px'}}),/*#__PURE__*/_jsxs(\"span\",{children:[\"Bad: \",remaining,\"%\"]})]})]}),reasons.length>0&&reasons[0]!=='Loading...'&&reasons[0]!=='Waiting for results...'&&/*#__PURE__*/_jsx(\"div\",{style:{marginTop:'0.5rem',fontSize:'0.85rem',color:'#6B7280'},children:reasons.slice(0,2).join(' â€¢ ')})]})]});};export default ResultQualityPie;","map":{"version":3,"names":["React","useEffect","useState","Chart","ChartJS","ArcElement","Tooltip","Legend","Doughnut","jsx","_jsx","jsxs","_jsxs","register","TRUSTED_DOMAINS","extractUrls","text","urlRegex","matchAll","map","m","domainKey","url","u","URL","parts","hostname","split","slice","join","_unused","hasStrongId","test","hasSpecificNumbers","lower","hypeOrBS","contradictionWithoutRefs","length","recencyOK","years","match","y","parseInt","mostRecent","Math","max","Date","getFullYear","sourceGate","dataSource","urls","key","evaluateEvidenceConfidence","query","results","citations","toLowerCase","trim","score","verdict","reasons","citationsText","textWithCites","gates","source","specificity","consistency","recency","passed","Object","values","filter","Boolean","criticalOkay","push","ResultQualityPie","_ref","evaluation","setEvaluation","console","log","substring","hasResults","newEvaluation","hasQuery","hasDataSource","percentage","round","remaining","colorByVerdict","v","labelByVerdict","ringColor","verdictLabel","data","datasets","backgroundColor","borderWidth","cutout","options","responsive","maintainAspectRatio","plugins","legend","display","tooltip","enabled","legendGoodColor","legendBadColor","style","textAlign","children","position","height","width","margin","top","left","transform","fontSize","fontWeight","color","marginTop","alignItems","justifyContent","marginBottom","gap","borderRadius"],"sources":["C:/repo/wihy_ui/client/src/components/ResultQualityPie.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport {\r\n  Chart as ChartJS,\r\n  ArcElement,\r\n  Tooltip,\r\n  Legend,\r\n} from 'chart.js';\r\nimport { Doughnut } from 'react-chartjs-2';\r\n\r\nChartJS.register(ArcElement, Tooltip, Legend);\r\n\r\ninterface ResultQualityPieProps {\r\n  query: string;\r\n  results: string;\r\n  dataSource: \"error\" | \"openai\" | \"local\" | \"vnutrition\" | \"wihy\";\r\n  citations?: string[];\r\n}\r\n\r\n/* ====================== Evidence Confidence (Gated) ====================== */\r\n\r\ntype Verdict = 'GOOD' | 'REVIEW' | 'BAD';\r\n\r\n/** Trusted domains for quick credibility checks. Tune anytime. */\r\nconst TRUSTED_DOMAINS: Record<string, number> = {\r\n  'nih.gov': 1,\r\n  'ncbi.nlm.nih.gov': 1,  // PubMed\r\n  'who.int': 1,\r\n  'cdc.gov': 1,\r\n  'fda.gov': 1,\r\n  'usda.gov': 1,\r\n  'jamanetwork.com': 1,\r\n  'nejm.org': 1,\r\n  'thelancet.com': 1,\r\n  'bmj.com': 1,\r\n  'nature.com': 1,\r\n  'science.org': 1,\r\n  'mayoclinic.org': 1,\r\n  'harvard.edu': 1,\r\n  'stanford.edu': 1,\r\n  'clevelandclinic.org': 1,\r\n  'uptodate.com': 1,\r\n};\r\n\r\nconst extractUrls = (text: string): string[] => {\r\n  const urlRegex = /(https?:\\/\\/[^\\s)]+)(?=\\)|\\s|$)/g;\r\n  return [...text.matchAll(urlRegex)].map(m => m[1]);\r\n};\r\n\r\nconst domainKey = (url: string): string | null => {\r\n  try {\r\n    const u = new URL(url);\r\n    const parts = u.hostname.split('.');\r\n    return parts.slice(-2).join('.');\r\n  } catch {\r\n    return null;\r\n  }\r\n};\r\n\r\nconst hasStrongId = (text: string) =>\r\n  /doi\\.org\\/10\\./i.test(text) || /pubmed\\.ncbi\\.nlm\\.nih\\.gov\\/\\d+/i.test(text);\r\n\r\nconst hasSpecificNumbers = (lower: string) =>\r\n  /\\b\\d+(\\.\\d+)?\\s?(mg|g|mcg|iu|kcal|calories|%)\\b/.test(lower) || /\\b\\d+(\\.\\d+)?%/.test(lower);\r\n\r\nconst hypeOrBS = (lower: string) =>\r\n  /(miracle|cure-all|100% guaranteed|secret|instantly|revolutionary|breakthrough|detox scam|shocking)/i.test(lower);\r\n\r\nconst contradictionWithoutRefs = (lower: string) =>\r\n  /(contradictory|no consensus|insufficient evidence)/i.test(lower) &&\r\n  !hasStrongId(lower) &&\r\n  extractUrls(lower).length === 0;\r\n\r\nconst recencyOK = (lower: string) => {\r\n  const years = (lower.match(/\\b(20\\d{2}|19\\d{2})\\b/g) || []).map(y => parseInt(y, 10));\r\n  if (years.length === 0) return true; // no year mentioned: don't punish\r\n  const mostRecent = Math.max(...years);\r\n  return new Date().getFullYear() - mostRecent <= 5;\r\n};\r\n\r\nconst sourceGate = (text: string, dataSource: ResultQualityPieProps['dataSource']) => {\r\n  // Database sources and WiHy count as trusted.\r\n  if (dataSource === 'vnutrition' || dataSource === 'local' || dataSource === 'wihy') return true;\r\n\r\n  // Otherwise require a strong id or a trusted domain link.\r\n  if (hasStrongId(text)) return true;\r\n  const urls = extractUrls(text);\r\n  for (const u of urls) {\r\n    const key = domainKey(u);\r\n    if (key && TRUSTED_DOMAINS[key]) return true;\r\n  }\r\n  return false;\r\n};\r\n\r\n/**\r\n * Evaluate evidence confidence with HARD GATES to reduce ambiguity.\r\n * Returns a discrete score for the ring (0.90 | 0.60 | 0.20) + verdict + reasons.\r\n */\r\nfunction evaluateEvidenceConfidence(\r\n  query: string,\r\n  results: string,\r\n  dataSource: ResultQualityPieProps['dataSource'],\r\n  citations?: string[]\r\n): { score: number; verdict: Verdict; reasons: string[] } {\r\n  const text = results || '';\r\n  const lower = text.toLowerCase();\r\n\r\n  // Short-circuit invalid answers/queries\r\n  if (!text.trim() || /please (provide|clarify)/i.test(text)) {\r\n    return { score: 0.20, verdict: 'BAD', reasons: ['No usable answer'] };\r\n  }\r\n  if (/not (a|the) recognized|no information found|could not find|doesn'?t seem/i.test(text)) {\r\n    return { score: 0.20, verdict: 'BAD', reasons: ['Unrecognized topic'] };\r\n  }\r\n  if (/^[a-z0-9]{1,7}$/i.test(query) && !/^(hiv|flu|cold|covid|bp|bmi|gerd|ibs|std|uti)$/i.test(query)) {\r\n    return { score: 0.20, verdict: 'BAD', reasons: ['Query looks invalid'] };\r\n  }\r\n\r\n  // Merge citations into text for gate checks\r\n  const citationsText = (citations || []).join(' ');\r\n  const textWithCites = text + ' ' + citationsText;\r\n\r\n  // Gates\r\n  const gates = {\r\n    source: sourceGate(textWithCites, dataSource),\r\n    citations: hasStrongId(textWithCites) || extractUrls(textWithCites).length > 0,\r\n    specificity: hasSpecificNumbers(lower),\r\n    consistency: !(hypeOrBS(lower) || contradictionWithoutRefs(lower)),\r\n    recency: recencyOK(lower),\r\n  };\r\n\r\n  const passed = Object.values(gates).filter(Boolean).length;\r\n  const criticalOkay = (gates.source || gates.citations) && gates.specificity;\r\n\r\n  let verdict: Verdict;\r\n  if ((dataSource === 'vnutrition' || dataSource === 'local' || dataSource === 'wihy') && criticalOkay) {\r\n    verdict = 'GOOD';\r\n  } else if (passed >= 4 && criticalOkay) {\r\n    verdict = 'GOOD';\r\n  } else if (passed === 3 && !hypeOrBS(lower)) {\r\n    verdict = 'REVIEW'; // narrow gray zone\r\n  } else {\r\n    verdict = 'BAD';\r\n  }\r\n\r\n  // Discrete mapping to compress gray area\r\n  const score = verdict === 'GOOD' ? 0.90 : verdict === 'REVIEW' ? 0.60 : 0.20;\r\n\r\n  const reasons: string[] = [];\r\n  if (!gates.source) reasons.push('Weak source');\r\n  if (!gates.citations) reasons.push('No citations');\r\n  if (!gates.specificity) reasons.push('Low numeric specificity');\r\n  if (!gates.consistency) reasons.push('Inconsistent language');\r\n  if (!gates.recency) reasons.push('Out-of-date');\r\n\r\n  return { score, verdict, reasons };\r\n}\r\n\r\n/* ====================== Component ====================== */\r\n\r\nconst ResultQualityPie: React.FC<ResultQualityPieProps> = ({\r\n  query,\r\n  results,\r\n  dataSource,\r\n  citations\r\n}) => {\r\n  const [evaluation, setEvaluation] = useState<{\r\n    score: number;\r\n    verdict: Verdict;\r\n    reasons: string[];\r\n  }>({ score: 0.20, verdict: 'BAD', reasons: ['Loading...'] });\r\n\r\n  // Debug logging to see what props are being received\r\n  useEffect(() => {\r\n    console.log('ResultQualityPie received props:', {\r\n      query,\r\n      results: results?.substring(0, 100) + '...',\r\n      dataSource,\r\n      citations,\r\n      hasResults: !!results && results.trim() !== ''\r\n    });\r\n  }, [query, results, dataSource, citations]);\r\n\r\n  // Evaluate when props change and we have valid data\r\n  useEffect(() => {\r\n    if (query && results && results.trim() !== '' && dataSource) {\r\n      console.log('Evaluating evidence confidence...');\r\n      const newEvaluation = evaluateEvidenceConfidence(query, results, dataSource, citations);\r\n      console.log('Evidence evaluation result:', newEvaluation);\r\n      setEvaluation(newEvaluation);\r\n    } else {\r\n      console.log('Not evaluating - missing required props:', {\r\n        hasQuery: !!query,\r\n        hasResults: !!results && results.trim() !== '',\r\n        hasDataSource: !!dataSource\r\n      });\r\n      // Set a default evaluation for missing data\r\n      setEvaluation({\r\n        score: 0.20,\r\n        verdict: 'BAD',\r\n        reasons: ['Waiting for results...']\r\n      });\r\n    }\r\n  }, [query, results, dataSource, citations]);\r\n\r\n  const { score, verdict, reasons } = evaluation;\r\n  const percentage = Math.round(score * 100);\r\n  const remaining = 100 - percentage;\r\n\r\n  // Colors by verdict (lock to clear categories)\r\n  const colorByVerdict = (v: Verdict) =>\r\n    v === 'GOOD' ? '#10B981' : v === 'REVIEW' ? '#F59E0B' : '#EF4444';\r\n\r\n  const labelByVerdict = (v: Verdict) =>\r\n    v === 'GOOD' ? 'Good' : v === 'REVIEW' ? 'Needs review' : 'Poor';\r\n\r\n  const ringColor = colorByVerdict(verdict);\r\n  const verdictLabel = labelByVerdict(verdict);\r\n\r\n  const data = {\r\n    datasets: [\r\n      {\r\n        data: [percentage, remaining],\r\n        backgroundColor: [ringColor, '#E5E7EB'],\r\n        borderWidth: 0,\r\n        cutout: '70%',\r\n      },\r\n    ],\r\n  };\r\n\r\n  const options = {\r\n    responsive: true,\r\n    maintainAspectRatio: false,\r\n    plugins: {\r\n      legend: { display: false },\r\n      tooltip: { enabled: false },\r\n    },\r\n  };\r\n\r\n  const legendGoodColor = verdict === 'BAD' ? '#E5E7EB' : '#10B981';\r\n  const legendBadColor = verdict === 'BAD' ? '#EF4444' : '#E5E7EB';\r\n\r\n  return (\r\n    <div style={{ textAlign: 'center' }}>\r\n      <div style={{ position: 'relative', height: '200px', width: '200px', margin: '0 auto' }}>\r\n        <Doughnut data={data} options={options} />\r\n        <div\r\n          style={{\r\n            position: 'absolute',\r\n            top: '50%',\r\n            left: '50%',\r\n            transform: 'translate(-50%, -50%)',\r\n            textAlign: 'center',\r\n          }}\r\n        >\r\n          <div style={{ fontSize: '2rem', fontWeight: 'bold', color: '#374151' }}>\r\n            {percentage}%\r\n          </div>\r\n          <div style={{ fontSize: '0.875rem', color: '#6B7280' }}>\r\n            Evidence\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div style={{ marginTop: '1rem' }}>\r\n        <div\r\n          style={{\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            justifyContent: 'center',\r\n            marginBottom: '0.5rem'\r\n          }}\r\n        >\r\n          <span\r\n            style={{\r\n              fontWeight: 500,\r\n              color: ringColor,\r\n              fontSize: '1rem'\r\n            }}\r\n          >\r\n            {verdictLabel}\r\n          </span>\r\n        </div>\r\n\r\n        <div\r\n          style={{\r\n            display: 'flex',\r\n            justifyContent: 'center',\r\n            gap: '1rem',\r\n            fontSize: '0.875rem'\r\n          }}\r\n        >\r\n          <div style={{ display: 'flex', alignItems: 'center', gap: '0.25rem' }}>\r\n            <div\r\n              style={{\r\n                width: '12px',\r\n                height: '12px',\r\n                backgroundColor: legendGoodColor,\r\n                borderRadius: '2px',\r\n              }}\r\n            />\r\n            <span>Good: {percentage}%</span>\r\n          </div>\r\n          <div style={{ display: 'flex', alignItems: 'center', gap: '0.25rem' }}>\r\n            <div\r\n              style={{\r\n                width: '12px',\r\n                height: '12px',\r\n                backgroundColor: legendBadColor,\r\n                borderRadius: '2px',\r\n              }}\r\n            />\r\n            <span>Bad: {remaining}%</span>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Tiny rationale (first 1â€“2 reasons) */}\r\n        {reasons.length > 0 && reasons[0] !== 'Loading...' && reasons[0] !== 'Waiting for results...' && (\r\n          <div\r\n            style={{\r\n              marginTop: '0.5rem',\r\n              fontSize: '0.85rem',\r\n              color: '#6B7280'\r\n            }}\r\n          >\r\n            {reasons.slice(0, 2).join(' â€¢ ')}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ResultQualityPie;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}