{"ast":null,"code":"/* filepath: c:\\vHealth\\vhealth\\client\\src\\components\\shared\\Header.tsx */import React,{useState,useRef,useEffect,useLayoutEffect}from'react';import{useNavigate}from'react-router-dom';import MultiAuthLogin from'./MultiAuthLogin';import ImageUploadModal from'../ui/ImageUploadModal';import{wihyAPI}from'../../services/wihyAPI';import{getApiEndpoint}from'../../config/apiConfig';import'../../styles/VHealthSearch.css';import'../../styles/search-components.css';import'./Header.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const Header=_ref=>{let{searchQuery='',onSearchSubmit,onVoiceInput,onImageUpload,onLogoClick,isListening=false,showSearchInput=true,variant='landing',className='',showLogin=true}=_ref;// ================================\n// STATE MANAGEMENT\n// ================================\nconst[input,setInput]=useState(searchQuery);const[internalIsListening,setInternalIsListening]=useState(false);const[isUploadModalOpen,setIsUploadModalOpen]=useState(false);const[isLoading,setIsLoading]=useState(false);const[loadingMessage,setLoadingMessage]=useState('Searching...');const[isScrolled,setIsScrolled]=useState(false);const navigate=useNavigate();const searchInputRef=useRef(null);const recognitionRef=useRef(null);const abortControllerRef=useRef(null);// Use internal listening state if onVoiceInput is not provided\nconst currentIsListening=onVoiceInput?isListening:internalIsListening;// ================================\n// SCROLL DETECTION FOR LOGIN BUTTON\n// ================================\nuseEffect(()=>{const handleScroll=()=>{const scrollY=window.scrollY;const threshold=10;// Hide login button when scrolled more than 10px (more aggressive)\nconsole.log('Scroll detected:',scrollY,'Threshold:',threshold,'Should hide:',scrollY>threshold);setIsScrolled(scrollY>threshold);};// Check initial scroll position\nhandleScroll();window.addEventListener('scroll',handleScroll,{passive:true});return()=>{window.removeEventListener('scroll',handleScroll);};},[]);// ================================\n// HEADER HEIGHT MEASUREMENT\n// ================================\n// Keep body offset equal to the real header height\nuseLayoutEffect(()=>{const header=document.querySelector('header.vhealth-header');if(!header)return;const apply=()=>{const h=Math.ceil(header.getBoundingClientRect().height);document.documentElement.style.setProperty('--vh-header-height',\"\".concat(h,\"px\"));};// Run once now\napply();// Update on header size change\nconst ro=new ResizeObserver(apply);ro.observe(header);// Update on viewport resize / orientation change\nwindow.addEventListener('resize',apply);return()=>{window.removeEventListener('resize',apply);ro.disconnect();};},[]);// ================================\n// FORCE HEADER ANIMATION WITH JAVASCRIPT\n// ================================\nuseEffect(()=>{// Force apply the rainbow border animation to header search bar using JavaScript\nconst container=document.querySelector('.vhealth-header .search-input-container');if(container){console.log('Applying JavaScript animation to header search bar, variant:',variant);// Set up the base styles\ncontainer.style.setProperty('border','2px solid transparent','important');container.style.setProperty('background',\"\\n        linear-gradient(#fff, #fff) padding-box,\\n        linear-gradient(90deg, #fa5f06, #ffffff, #C0C0C0, #4cbb17, #1a73e8) border-box\\n      \",'important');container.style.setProperty('background-size','100% 100%, 200% 100%','important');container.style.setProperty('border-radius','24px','important');// Remove CSS animation and use JavaScript instead\ncontainer.style.setProperty('animation','none','important');// JavaScript animation\nlet position=0;const animate=()=>{position+=1;if(position>=200)position=0;container.style.setProperty('background-position',\"0 0, \".concat(position,\"% 0\"),'important');requestAnimationFrame(animate);};animate();}},[variant]);// Re-run when variant changes\n// ================================\n// UTILITY FUNCTIONS\n// ================================\n/**\r\n   * AUTO-SIZE TEXT AREA\r\n   * Dynamically adjusts the height of the search input based on content\r\n   */const autoSize=()=>{const el=searchInputRef.current;if(!el)return;// Reset to default height when empty\nif(!input.trim()){el.style.height='44px';el.style.overflowY='hidden';return;}// Auto-expand height based on content\nel.style.height=\"0\";const next=el.scrollHeight;el.style.height=next+\"px\";// Enable scrolling if height exceeds max\nconst max=parseFloat(getComputedStyle(el).maxHeight);el.style.overflowY=next>max?\"auto\":\"hidden\";};/**\r\n   * CLEAR SEARCH INPUT\r\n   * Clears search input and resets its height to default\r\n   */const clearInput=()=>{setInput('');setTimeout(()=>{if(searchInputRef.current){searchInputRef.current.style.height='44px';}},10);};/**\r\n   * PROGRESS CALCULATOR\r\n   * Converts loading message text to progress percentage for UI feedback\r\n   */const progressFromMessage=msg=>{if(msg.includes('Initializing'))return 10;if(msg.includes('Checking cache'))return 25;if(msg.includes('Analyzing with AI'))return 55;if(msg.includes('Processing results'))return 75;if(msg.includes('Results ready')||msg.includes('Response ready'))return 95;if(msg.includes('Processing image'))return 35;if(msg.includes('Checking nutrition'))return 45;if(msg.includes('Analyzing nutrition'))return 60;if(msg.includes('Processing nutrition'))return 80;if(msg.includes('complete'))return 95;if(msg.includes('failed'))return 100;return 40;};// ================================\n// SEARCH FUNCTIONALITY\n// ================================\n/**\r\n   * MAIN SEARCH HANDLER\r\n   * Primary search function that handles text-based health queries\r\n   */const handleSearch=async queryParam=>{const queryToUse=queryParam||input;if(!queryToUse.trim()||isLoading)return;// If onSearchSubmit is provided, use it instead of internal search\nif(onSearchSubmit){onSearchSubmit(queryToUse.trim());return;}// Create new AbortController for this request\nabortControllerRef.current=new AbortController();const signal=abortControllerRef.current.signal;setIsLoading(true);setLoadingMessage('Initializing search...');try{// Step 1: Check database cache first\nsetLoadingMessage('Checking cache...');try{const response=await fetch(getApiEndpoint(\"/cache/get?q=\".concat(encodeURIComponent(queryToUse))),{signal});if(response.ok){const cachedData=await response.json();console.log('Using cached results from database');setLoadingMessage('Loading cached results...');await new Promise(resolve=>setTimeout(resolve,300));setIsLoading(false);navigate(\"/results?q=\".concat(encodeURIComponent(queryToUse)),{state:{results:cachedData.results,dataSource:cachedData.source||'cache',fromSearch:true}});return;}}catch(cacheError){if(cacheError.name==='AbortError'){console.log('Cache request was cancelled');return;}console.log('No cache found, proceeding with API call');}// Step 2: Get fresh results from WiHy API\nsetLoadingMessage('Analyzing with WiHy AI...');try{console.log('Making WiHy API search request from Header for:',queryToUse);const wihyResponse=await wihyAPI.searchHealth(queryToUse);if(wihyResponse.success){// Handle both unified and legacy response formats\nlet summary='Health information provided';let actualHealthResponse='Health information provided';if('data'in wihyResponse){var _data$ai_response;// New unified API response format\nconst data=wihyResponse.data;if(data!==null&&data!==void 0&&(_data$ai_response=data.ai_response)!==null&&_data$ai_response!==void 0&&_data$ai_response.response){actualHealthResponse=data.ai_response.response;summary=actualHealthResponse;}else if(data!==null&&data!==void 0&&data.response){// Handle JSON string responses\nif(typeof data.response==='string'){try{const parsed=JSON.parse(data.response.replace(/'/g,'\"'));actualHealthResponse=parsed.core_principle||parsed.message||data.response;}catch(_unused){actualHealthResponse=data.response;}}else{actualHealthResponse=data.response;}summary=actualHealthResponse;}}else{// Legacy WihyResponse format\nconst wihyResp=wihyResponse.wihy_response;if(wihyResp&&typeof wihyResp==='object'){actualHealthResponse=wihyResp.core_principle||wihyResp.message||'Health information provided';summary=actualHealthResponse;}}// Convert WiHy response to expected format - use actual health response instead of technical formatting\nconst searchResults={summary:summary,details:actualHealthResponse,// Use actual health response instead of formatted technical response\nsources:wihyAPI.extractCitations(wihyResponse),recommendations:wihyAPI.extractRecommendations(wihyResponse),relatedTopics:[],medicalDisclaimer:'This guidance is based on evidence-based health principles. Always consult healthcare professionals for personalized medical advice.',dataSource:'wihy'};const isValidResult=searchResults&&typeof searchResults==='object'&&searchResults!==null&&(searchResults.summary||searchResults.details||Object.keys(searchResults).length>0);if(isValidResult){// Step 3: Save to database cache (async, don't wait)\nsetLoadingMessage('Caching results...');fetch(getApiEndpoint('/cache/save'),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({query:queryToUse,results:searchResults,source:'openai'})}).catch(err=>console.warn('Cache save error:',err));setLoadingMessage('Results ready!');await new Promise(resolve=>setTimeout(resolve,300));setIsLoading(false);navigate(\"/results?q=\".concat(encodeURIComponent(queryToUse)),{state:{results:searchResults,apiResponse:wihyResponse,// Pass the original API response\ndataSource:'wihy',fromSearch:true}});return;}else{throw new Error('WiHy API returned invalid results');}}else{throw new Error('WiHy API request failed');}}catch(apiError){if(apiError.name==='AbortError'){console.log('API request was cancelled');return;}console.error('Health search service failed:',apiError);setLoadingMessage('No results found. Please try a different search.');setTimeout(()=>{setIsLoading(false);setLoadingMessage('Searching...');},3000);return;}}catch(error){if(error.name==='AbortError'){console.log('Search request was cancelled');return;}console.error(\"Search error:\",error);setLoadingMessage('Search failed. Please try again.');setTimeout(()=>{setIsLoading(false);setLoadingMessage('Searching...');},2000);}};/**\r\n   * SEARCH CANCELLATION HANDLER\r\n   */const handleCancelSearch=()=>{if(abortControllerRef.current){abortControllerRef.current.abort();abortControllerRef.current=null;}setIsLoading(false);setLoadingMessage('Searching...');};/**\r\n   * IMAGE ANALYSIS COMPLETION HANDLER\r\n   */const handleAnalysisComplete=async foodName=>{if(!foodName||isLoading){setIsUploadModalOpen(false);return;}if(onSearchSubmit){onSearchSubmit(foodName);setIsUploadModalOpen(false);return;}// Use internal search logic\nsetInput(foodName);await handleSearch(foodName);setIsUploadModalOpen(false);};/**\r\n   * VOICE INPUT HANDLER\r\n   */const handleVoiceInput=()=>{if(onVoiceInput){onVoiceInput();return;}// Internal voice input logic\nif(isLoading)return;if(!('webkitSpeechRecognition'in window)){alert('Speech recognition not supported in this browser');return;}if(!recognitionRef.current){const recognition=new window.webkitSpeechRecognition();recognition.continuous=false;recognition.interimResults=false;recognition.lang='en-US';recognition.onstart=()=>setInternalIsListening(true);recognition.onresult=event=>{const transcript=event.results[0][0].transcript;setInput(transcript);setInternalIsListening(false);};recognition.onerror=()=>setInternalIsListening(false);recognition.onend=()=>setInternalIsListening(false);recognitionRef.current=recognition;}if(!currentIsListening){recognitionRef.current.start();}else{recognitionRef.current.stop();setInternalIsListening(false);}};/**\r\n   * IMAGE UPLOAD HANDLER\r\n   */const handleImageUpload=()=>{if(onImageUpload){onImageUpload();return;}// Internal image upload logic\nsetIsUploadModalOpen(true);};// ================================\n// EVENT HANDLERS\n// ================================\n// Update sizing when input changes\nuseEffect(()=>{autoSize();},[input]);// Handle input changes\nconst handleInputChange=e=>{setInput(e.target.value);};const handleSubmit=e=>{e.preventDefault();handleSearch();};const handleKeyDown=e=>{if(e.key==='Enter'&&!e.shiftKey){e.preventDefault();handleSubmit(e);}};const handleLogoClick=()=>{if(onLogoClick){onLogoClick();}else{// Default behavior: navigate to home page\nnavigate('/');}};// ================================\n// LIFECYCLE HOOKS\n// ================================\n/**\r\n   * CLEANUP EFFECT\r\n   * Resets loading state when component unmounts\r\n   */useEffect(()=>{return()=>{setIsLoading(false);setLoadingMessage('Searching...');};},[]);// ================================\n// UI COMPONENTS\n// ================================\n/**\r\n   * LOADING OVERLAY COMPONENT\r\n   * Shows animated loading screen with progress bar during search operations\r\n   */const LoadingOverlay=_ref2=>{let{message,progress}=_ref2;return/*#__PURE__*/_jsx(\"div\",{style:{position:'fixed',top:0,left:0,right:0,bottom:0,backgroundColor:'rgba(0, 0, 0, 0.5)',display:'flex',alignItems:'center',justifyContent:'center',zIndex:9999},children:/*#__PURE__*/_jsxs(\"div\",{style:{backgroundColor:'white',borderRadius:'12px',padding:'40px',textAlign:'center',minWidth:'320px',boxShadow:'0 10px 25px rgba(0, 0, 0, 0.2)'},children:[/*#__PURE__*/_jsx(\"div\",{style:{margin:'0 auto 24px auto'},children:/*#__PURE__*/_jsx(\"img\",{src:\"/assets/whatishealthyspinner.gif\",alt:\"Loading...\",style:{width:'48px',height:'48px',objectFit:'contain'}})}),/*#__PURE__*/_jsx(\"h3\",{style:{margin:'0 0 8px 0',fontSize:'24px',fontWeight:'600',color:'#1f2937'},children:\"Loading Content\"}),/*#__PURE__*/_jsx(\"p\",{style:{margin:'0 0 24px 0',fontSize:'16px',color:'#6b7280'},children:\"Please wait while we process your request...\"}),/*#__PURE__*/_jsx(\"div\",{style:{width:'100%',height:'8px',backgroundColor:'#e5e7eb',borderRadius:'4px',overflow:'hidden',marginBottom:'12px'},children:/*#__PURE__*/_jsx(\"div\",{style:{width:\"\".concat(progress,\"%\"),height:'100%',backgroundColor:'#3b82f6',borderRadius:'4px',transition:'width 0.3s ease'}})}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',justifyContent:'space-between',marginTop:'16px'},children:[/*#__PURE__*/_jsxs(\"p\",{style:{margin:0,fontSize:'14px',color:'#6b7280'},children:[progress,\"% Complete\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleCancelSearch,style:{backgroundColor:'transparent',color:'#555',border:'1px solid #ccc',borderRadius:'16px',padding:'8px 16px',fontSize:'14px',fontWeight:'500',cursor:'pointer',transition:'all 0.2s ease'},children:\"Cancel\"})]})]})});};const headerClasses=\"vhealth-header \".concat(variant,\" \").concat(className).trim();return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"style\",{children:\"\\n          @keyframes wiH-border-sweep {\\n            0%   { background-position: 0 0, 0% 0; }\\n            100% { background-position: 0 0, 200% 0; }\\n          }\\n        \"}),isLoading&&/*#__PURE__*/_jsx(LoadingOverlay,{message:loadingMessage,progress:progressFromMessage(loadingMessage)}),/*#__PURE__*/_jsxs(\"header\",{className:headerClasses,children:[/*#__PURE__*/_jsx(\"div\",{className:\"vhealth-topbar\",children:/*#__PURE__*/_jsx(\"div\",{className:\"vhealth-topbar-right\",children:showLogin&&/*#__PURE__*/_jsx(\"div\",{className:\"header-auth-wrapper \".concat(isScrolled?'hidden-on-scroll':''),style:{minWidth:'48px',minHeight:'48px',padding:'4px',display:isScrolled?'none':'flex',alignItems:'center',justifyContent:'center',opacity:isScrolled?0:1,visibility:isScrolled?'hidden':'visible',transition:'all 0.2s ease'},children:/*#__PURE__*/_jsx(MultiAuthLogin,{position:\"inline\",onUserChange:user=>console.log('User changed in header:',user),onSignIn:user=>console.log('User signed in from header:',user),onSignOut:()=>console.log('User signed out from header')})})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"vhealth-mainbar\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"vhealth-logo-container\",children:/*#__PURE__*/_jsx(\"img\",{src:\"/assets/wihylogo.png\",alt:\"What is Healthy?\",className:\"vhealth-logo \".concat(variant,\"-logo\"),onClick:handleLogoClick,style:{cursor:onLogoClick?'pointer':'default'}})}),/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',alignItems:'center',gap:'20px',marginLeft:'20px'},children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate('/dashboard'),style:{background:'none',border:'none',color:'#374151',fontSize:'16px',fontWeight:'500',cursor:'pointer',padding:'8px 16px',borderRadius:'6px',transition:'all 0.2s ease'},onMouseOver:e=>{e.currentTarget.style.backgroundColor='#f3f4f6';e.currentTarget.style.color='#3b82f6';},onMouseOut:e=>{e.currentTarget.style.backgroundColor='transparent';e.currentTarget.style.color='#374151';},children:\"\\uD83D\\uDCCA Dashboard\"})}),showSearchInput&&/*#__PURE__*/_jsx(\"div\",{className:\"vhealth-search-section\",children:/*#__PURE__*/_jsx(\"form\",{className:\"vhealth-search-form\",onSubmit:handleSubmit,children:/*#__PURE__*/_jsxs(\"div\",{className:\"search-input-container\",style:{animation:'wiH-border-sweep 2.2s linear infinite !important',background:\"\\n                      linear-gradient(#fff, #fff) padding-box,\\n                      linear-gradient(90deg, #fa5f06, #ffffff, #C0C0C0, #4cbb17, #1a73e8) border-box\\n                    \",backgroundSize:'100% 100%, 200% 100%',border:'2px solid transparent',borderRadius:'24px',position:'relative',width:'100%',maxWidth:'800px',margin:'0 auto',boxShadow:'0 1px 6px rgba(32,33,36,0.28)'},children:[/*#__PURE__*/_jsx(\"textarea\",{ref:searchInputRef,value:input,onChange:handleInputChange,onKeyDown:handleKeyDown,placeholder:\"Ask anything about health...\",className:\"search-input\",disabled:isLoading,rows:1,style:{resize:'none',overflow:'hidden',minHeight:'44px',height:'auto',paddingRight:'100px'}}),/*#__PURE__*/_jsxs(\"div\",{className:\"search-icons\",children:[input&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"icon-button clear-button\",onClick:clearInput,title:\"Clear\",children:/*#__PURE__*/_jsx(\"svg\",{viewBox:\"0 0 24 24\",width:\"16\",height:\"16\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z\"})})}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"icon-button\",onClick:handleImageUpload,title:\"Upload image\",disabled:isLoading,children:/*#__PURE__*/_jsx(\"svg\",{viewBox:\"0 0 24 24\",width:\"20\",height:\"20\",fill:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M9 2L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2H9zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5z\"})})}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"icon-button \".concat(currentIsListening?'listening':''),onClick:handleVoiceInput,title:currentIsListening?'Stop listening':'Start voice input',disabled:isLoading,children:/*#__PURE__*/_jsx(\"svg\",{viewBox:\"0 0 24 24\",width:\"20\",height:\"20\",fill:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M12 14c1.66 0 2.99-1.34 2.99-3L15 5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.48 6-3.3 6-6.72h-1.7z\"})})})]})]})})})]})]}),/*#__PURE__*/_jsx(ImageUploadModal,{isOpen:isUploadModalOpen,onClose:()=>setIsUploadModalOpen(false),onAnalysisComplete:handleAnalysisComplete,title:\"Upload Image\",subtitle:\"Upload Image for Analysis\"})]});};export default Header;","map":{"version":3,"names":["React","useState","useRef","useEffect","useLayoutEffect","useNavigate","MultiAuthLogin","ImageUploadModal","wihyAPI","getApiEndpoint","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Header","_ref","searchQuery","onSearchSubmit","onVoiceInput","onImageUpload","onLogoClick","isListening","showSearchInput","variant","className","showLogin","input","setInput","internalIsListening","setInternalIsListening","isUploadModalOpen","setIsUploadModalOpen","isLoading","setIsLoading","loadingMessage","setLoadingMessage","isScrolled","setIsScrolled","navigate","searchInputRef","recognitionRef","abortControllerRef","currentIsListening","handleScroll","scrollY","window","threshold","console","log","addEventListener","passive","removeEventListener","header","document","querySelector","apply","h","Math","ceil","getBoundingClientRect","height","documentElement","style","setProperty","concat","ro","ResizeObserver","observe","disconnect","container","position","animate","requestAnimationFrame","autoSize","el","current","trim","overflowY","next","scrollHeight","max","parseFloat","getComputedStyle","maxHeight","clearInput","setTimeout","progressFromMessage","msg","includes","handleSearch","queryParam","queryToUse","AbortController","signal","response","fetch","encodeURIComponent","ok","cachedData","json","Promise","resolve","state","results","dataSource","source","fromSearch","cacheError","name","wihyResponse","searchHealth","success","summary","actualHealthResponse","_data$ai_response","data","ai_response","parsed","JSON","parse","replace","core_principle","message","_unused","wihyResp","wihy_response","searchResults","details","sources","extractCitations","recommendations","extractRecommendations","relatedTopics","medicalDisclaimer","isValidResult","Object","keys","length","method","headers","body","stringify","query","catch","err","warn","apiResponse","Error","apiError","error","handleCancelSearch","abort","handleAnalysisComplete","foodName","handleVoiceInput","alert","recognition","webkitSpeechRecognition","continuous","interimResults","lang","onstart","onresult","event","transcript","onerror","onend","start","stop","handleImageUpload","handleInputChange","e","target","value","handleSubmit","preventDefault","handleKeyDown","key","shiftKey","handleLogoClick","LoadingOverlay","_ref2","progress","top","left","right","bottom","backgroundColor","display","alignItems","justifyContent","zIndex","children","borderRadius","padding","textAlign","minWidth","boxShadow","margin","src","alt","width","objectFit","fontSize","fontWeight","color","overflow","marginBottom","transition","marginTop","onClick","border","cursor","headerClasses","minHeight","opacity","visibility","onUserChange","user","onSignIn","onSignOut","gap","marginLeft","background","onMouseOver","currentTarget","onMouseOut","onSubmit","animation","backgroundSize","maxWidth","ref","onChange","onKeyDown","placeholder","disabled","rows","resize","paddingRight","type","title","viewBox","d","fill","isOpen","onClose","onAnalysisComplete","subtitle"],"sources":["C:/repo/wihy_ui/client/src/components/shared/Header.tsx"],"sourcesContent":["/* filepath: c:\\vHealth\\vhealth\\client\\src\\components\\shared\\Header.tsx */\r\nimport React, { useState, useRef, useEffect, useLayoutEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport MultiAuthLogin from './MultiAuthLogin';\r\nimport ImageUploadModal from '../ui/ImageUploadModal';\r\nimport { wihyAPI } from '../../services/wihyAPI';\r\nimport { getApiEndpoint } from '../../config/apiConfig';\r\nimport '../../styles/VHealthSearch.css';\r\nimport '../../styles/search-components.css';\r\nimport './Header.css';\r\n\r\ninterface HeaderProps {\r\n  searchQuery?: string;\r\n  onSearchSubmit?: (query: string) => void;\r\n  onVoiceInput?: () => void;\r\n  onImageUpload?: () => void;\r\n  onLogoClick?: () => void;\r\n  isListening?: boolean;\r\n  showSearchInput?: boolean;\r\n  variant?: 'landing' | 'results';\r\n  className?: string;\r\n  showLogin?: boolean;\r\n}\r\n\r\nconst Header: React.FC<HeaderProps> = ({\r\n  searchQuery = '',\r\n  onSearchSubmit,\r\n  onVoiceInput,\r\n  onImageUpload,\r\n  onLogoClick,\r\n  isListening = false,\r\n  showSearchInput = true,\r\n  variant = 'landing',\r\n  className = '',\r\n  showLogin = true\r\n}) => {\r\n  // ================================\r\n  // STATE MANAGEMENT\r\n  // ================================\r\n  const [input, setInput] = useState(searchQuery);\r\n  const [internalIsListening, setInternalIsListening] = useState(false);\r\n  const [isUploadModalOpen, setIsUploadModalOpen] = useState(false);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [loadingMessage, setLoadingMessage] = useState('Searching...');\r\n  const [isScrolled, setIsScrolled] = useState(false);\r\n  \r\n  const navigate = useNavigate();\r\n  const searchInputRef = useRef<HTMLTextAreaElement>(null);\r\n  const recognitionRef = useRef<any>(null);\r\n  const abortControllerRef = useRef<AbortController | null>(null);\r\n\r\n  // Use internal listening state if onVoiceInput is not provided\r\n  const currentIsListening = onVoiceInput ? isListening : internalIsListening;\r\n\r\n  // ================================\r\n  // SCROLL DETECTION FOR LOGIN BUTTON\r\n  // ================================\r\n  useEffect(() => {\r\n    const handleScroll = () => {\r\n      const scrollY = window.scrollY;\r\n      const threshold = 10; // Hide login button when scrolled more than 10px (more aggressive)\r\n      console.log('Scroll detected:', scrollY, 'Threshold:', threshold, 'Should hide:', scrollY > threshold);\r\n      setIsScrolled(scrollY > threshold);\r\n    };\r\n\r\n    // Check initial scroll position\r\n    handleScroll();\r\n    \r\n    window.addEventListener('scroll', handleScroll, { passive: true });\r\n    \r\n    return () => {\r\n      window.removeEventListener('scroll', handleScroll);\r\n    };\r\n  }, []);\r\n\r\n  // ================================\r\n  // HEADER HEIGHT MEASUREMENT\r\n  // ================================\r\n  // Keep body offset equal to the real header height\r\n  useLayoutEffect(() => {\r\n    const header = document.querySelector('header.vhealth-header') as HTMLElement | null;\r\n    if (!header) return;\r\n\r\n    const apply = () => {\r\n      const h = Math.ceil(header.getBoundingClientRect().height);\r\n      document.documentElement.style.setProperty('--vh-header-height', `${h}px`);\r\n    };\r\n\r\n    // Run once now\r\n    apply();\r\n\r\n    // Update on header size change\r\n    const ro = new ResizeObserver(apply);\r\n    ro.observe(header);\r\n\r\n    // Update on viewport resize / orientation change\r\n    window.addEventListener('resize', apply);\r\n\r\n    return () => {\r\n      window.removeEventListener('resize', apply);\r\n      ro.disconnect();\r\n    };\r\n  }, []);\r\n\r\n  // ================================\r\n  // FORCE HEADER ANIMATION WITH JAVASCRIPT\r\n  // ================================\r\n  useEffect(() => {\r\n    // Force apply the rainbow border animation to header search bar using JavaScript\r\n    const container = document.querySelector('.vhealth-header .search-input-container') as HTMLElement;\r\n    if (container) {\r\n      console.log('Applying JavaScript animation to header search bar, variant:', variant);\r\n      \r\n      // Set up the base styles\r\n      container.style.setProperty('border', '2px solid transparent', 'important');\r\n      container.style.setProperty('background', `\r\n        linear-gradient(#fff, #fff) padding-box,\r\n        linear-gradient(90deg, #fa5f06, #ffffff, #C0C0C0, #4cbb17, #1a73e8) border-box\r\n      `, 'important');\r\n      container.style.setProperty('background-size', '100% 100%, 200% 100%', 'important');\r\n      container.style.setProperty('border-radius', '24px', 'important');\r\n      \r\n      // Remove CSS animation and use JavaScript instead\r\n      container.style.setProperty('animation', 'none', 'important');\r\n      \r\n      // JavaScript animation\r\n      let position = 0;\r\n      const animate = () => {\r\n        position += 1;\r\n        if (position >= 200) position = 0;\r\n        \r\n        container.style.setProperty('background-position', `0 0, ${position}% 0`, 'important');\r\n        requestAnimationFrame(animate);\r\n      };\r\n      \r\n      animate();\r\n    }\r\n  }, [variant]); // Re-run when variant changes\r\n\r\n  // ================================\r\n  // UTILITY FUNCTIONS\r\n  // ================================\r\n\r\n  /**\r\n   * AUTO-SIZE TEXT AREA\r\n   * Dynamically adjusts the height of the search input based on content\r\n   */\r\n  const autoSize = () => {\r\n    const el = searchInputRef.current;\r\n    if (!el) return;\r\n    \r\n    // Reset to default height when empty\r\n    if (!input.trim()) {\r\n      el.style.height = '44px';\r\n      el.style.overflowY = 'hidden';\r\n      return;\r\n    }\r\n    \r\n    // Auto-expand height based on content\r\n    el.style.height = \"0\";\r\n    const next = el.scrollHeight;\r\n    el.style.height = next + \"px\";\r\n    \r\n    // Enable scrolling if height exceeds max\r\n    const max = parseFloat(getComputedStyle(el).maxHeight);\r\n    el.style.overflowY = next > max ? \"auto\" : \"hidden\";\r\n  };\r\n\r\n  /**\r\n   * CLEAR SEARCH INPUT\r\n   * Clears search input and resets its height to default\r\n   */\r\n  const clearInput = () => {\r\n    setInput('');\r\n    setTimeout(() => {\r\n      if (searchInputRef.current) {\r\n        searchInputRef.current.style.height = '44px';\r\n      }\r\n    }, 10);\r\n  };\r\n\r\n  /**\r\n   * PROGRESS CALCULATOR\r\n   * Converts loading message text to progress percentage for UI feedback\r\n   */\r\n  const progressFromMessage = (msg: string) => {\r\n    if (msg.includes('Initializing')) return 10;\r\n    if (msg.includes('Checking cache')) return 25;\r\n    if (msg.includes('Analyzing with AI')) return 55;\r\n    if (msg.includes('Processing results')) return 75;\r\n    if (msg.includes('Results ready') || msg.includes('Response ready')) return 95;\r\n    if (msg.includes('Processing image')) return 35;\r\n    if (msg.includes('Checking nutrition')) return 45;\r\n    if (msg.includes('Analyzing nutrition')) return 60;\r\n    if (msg.includes('Processing nutrition')) return 80;\r\n    if (msg.includes('complete')) return 95;\r\n    if (msg.includes('failed')) return 100;\r\n    return 40;\r\n  };\r\n\r\n  // ================================\r\n  // SEARCH FUNCTIONALITY\r\n  // ================================\r\n\r\n  /**\r\n   * MAIN SEARCH HANDLER\r\n   * Primary search function that handles text-based health queries\r\n   */\r\n  const handleSearch = async (queryParam?: string) => {\r\n    const queryToUse = queryParam || input;\r\n    if (!queryToUse.trim() || isLoading) return;\r\n    \r\n    // If onSearchSubmit is provided, use it instead of internal search\r\n    if (onSearchSubmit) {\r\n      onSearchSubmit(queryToUse.trim());\r\n      return;\r\n    }\r\n\r\n    // Create new AbortController for this request\r\n    abortControllerRef.current = new AbortController();\r\n    const signal = abortControllerRef.current.signal;\r\n    \r\n    setIsLoading(true);\r\n    setLoadingMessage('Initializing search...');\r\n    \r\n    try {\r\n      // Step 1: Check database cache first\r\n      setLoadingMessage('Checking cache...');\r\n      \r\n      try {\r\n        const response = await fetch(getApiEndpoint(`/cache/get?q=${encodeURIComponent(queryToUse)}`), { signal });\r\n        \r\n        if (response.ok) {\r\n          const cachedData = await response.json();\r\n          console.log('Using cached results from database');\r\n          setLoadingMessage('Loading cached results...');\r\n          await new Promise(resolve => setTimeout(resolve, 300));\r\n          \r\n          setIsLoading(false);\r\n          navigate(`/results?q=${encodeURIComponent(queryToUse)}`, {\r\n            state: {\r\n              results: cachedData.results,\r\n              dataSource: cachedData.source || 'cache',\r\n              fromSearch: true\r\n            }\r\n          });\r\n          return;\r\n        }\r\n      } catch (cacheError) {\r\n        if (cacheError.name === 'AbortError') {\r\n          console.log('Cache request was cancelled');\r\n          return;\r\n        }\r\n        console.log('No cache found, proceeding with API call');\r\n      }\r\n\r\n      // Step 2: Get fresh results from WiHy API\r\n      setLoadingMessage('Analyzing with WiHy AI...');\r\n      \r\n      try {\r\n        console.log('Making WiHy API search request from Header for:', queryToUse);\r\n        const wihyResponse = await wihyAPI.searchHealth(queryToUse);\r\n        \r\n        if (wihyResponse.success) {\r\n          // Handle both unified and legacy response formats\r\n          let summary = 'Health information provided';\r\n          let actualHealthResponse = 'Health information provided';\r\n          \r\n          if ('data' in wihyResponse) {\r\n            // New unified API response format\r\n            const data = (wihyResponse as any).data;\r\n            if (data?.ai_response?.response) {\r\n              actualHealthResponse = data.ai_response.response;\r\n              summary = actualHealthResponse;\r\n            } else if (data?.response) {\r\n              // Handle JSON string responses\r\n              if (typeof data.response === 'string') {\r\n                try {\r\n                  const parsed = JSON.parse(data.response.replace(/'/g, '\"'));\r\n                  actualHealthResponse = parsed.core_principle || parsed.message || data.response;\r\n                } catch {\r\n                  actualHealthResponse = data.response;\r\n                }\r\n              } else {\r\n                actualHealthResponse = data.response;\r\n              }\r\n              summary = actualHealthResponse;\r\n            }\r\n          } else {\r\n            // Legacy WihyResponse format\r\n            const wihyResp = (wihyResponse as any).wihy_response;\r\n            if (wihyResp && typeof wihyResp === 'object') {\r\n              actualHealthResponse = wihyResp.core_principle || wihyResp.message || 'Health information provided';\r\n              summary = actualHealthResponse;\r\n            }\r\n          }\r\n          \r\n          // Convert WiHy response to expected format - use actual health response instead of technical formatting\r\n          const searchResults = {\r\n            summary: summary,\r\n            details: actualHealthResponse, // Use actual health response instead of formatted technical response\r\n            sources: wihyAPI.extractCitations(wihyResponse),\r\n            recommendations: wihyAPI.extractRecommendations(wihyResponse),\r\n            relatedTopics: [],\r\n            medicalDisclaimer: 'This guidance is based on evidence-based health principles. Always consult healthcare professionals for personalized medical advice.',\r\n            dataSource: 'wihy'\r\n          };\r\n          \r\n          const isValidResult = searchResults && \r\n            typeof searchResults === 'object' && \r\n            searchResults !== null &&\r\n            (searchResults.summary || searchResults.details || Object.keys(searchResults).length > 0);\r\n          \r\n          if (isValidResult) {\r\n          // Step 3: Save to database cache (async, don't wait)\r\n          setLoadingMessage('Caching results...');\r\n          \r\n          fetch(getApiEndpoint('/cache/save'), {\r\n            method: 'POST',\r\n            headers: { 'Content-Type': 'application/json' },\r\n            body: JSON.stringify({\r\n              query: queryToUse,\r\n              results: searchResults,\r\n              source: 'openai'\r\n            })\r\n          }).catch(err => console.warn('Cache save error:', err));\r\n          \r\n          setLoadingMessage('Results ready!');\r\n          await new Promise(resolve => setTimeout(resolve, 300));\r\n          \r\n          setIsLoading(false);\r\n          navigate(`/results?q=${encodeURIComponent(queryToUse)}`, {\r\n            state: {\r\n              results: searchResults,\r\n              apiResponse: wihyResponse, // Pass the original API response\r\n              dataSource: 'wihy',\r\n              fromSearch: true\r\n            }\r\n          });\r\n          return;\r\n        } else {\r\n          throw new Error('WiHy API returned invalid results');\r\n        }\r\n      } else {\r\n        throw new Error('WiHy API request failed');\r\n      }\r\n        \r\n      } catch (apiError) {\r\n        if (apiError.name === 'AbortError') {\r\n          console.log('API request was cancelled');\r\n          return;\r\n        }\r\n        console.error('Health search service failed:', apiError);\r\n        \r\n        setLoadingMessage('No results found. Please try a different search.');\r\n        setTimeout(() => {\r\n          setIsLoading(false);\r\n          setLoadingMessage('Searching...');\r\n        }, 3000);\r\n        return;\r\n      }\r\n        \r\n    } catch (error) {\r\n      if (error.name === 'AbortError') {\r\n        console.log('Search request was cancelled');\r\n        return;\r\n      }\r\n      \r\n      console.error(\"Search error:\", error);\r\n      setLoadingMessage('Search failed. Please try again.');\r\n      \r\n      setTimeout(() => {\r\n        setIsLoading(false);\r\n        setLoadingMessage('Searching...');\r\n      }, 2000);\r\n    }\r\n  };\r\n\r\n  /**\r\n   * SEARCH CANCELLATION HANDLER\r\n   */\r\n  const handleCancelSearch = () => {\r\n    if (abortControllerRef.current) {\r\n      abortControllerRef.current.abort();\r\n      abortControllerRef.current = null;\r\n    }\r\n    setIsLoading(false);\r\n    setLoadingMessage('Searching...');\r\n  };\r\n\r\n  /**\r\n   * IMAGE ANALYSIS COMPLETION HANDLER\r\n   */\r\n  const handleAnalysisComplete = async (foodName: string): Promise<void> => {\r\n    if (!foodName || isLoading) {\r\n      setIsUploadModalOpen(false);\r\n      return;\r\n    }\r\n\r\n    if (onSearchSubmit) {\r\n      onSearchSubmit(foodName);\r\n      setIsUploadModalOpen(false);\r\n      return;\r\n    }\r\n\r\n    // Use internal search logic\r\n    setInput(foodName);\r\n    await handleSearch(foodName);\r\n    setIsUploadModalOpen(false);\r\n  };\r\n\r\n  /**\r\n   * VOICE INPUT HANDLER\r\n   */\r\n  const handleVoiceInput = () => {\r\n    if (onVoiceInput) {\r\n      onVoiceInput();\r\n      return;\r\n    }\r\n\r\n    // Internal voice input logic\r\n    if (isLoading) return;\r\n    \r\n    if (!('webkitSpeechRecognition' in window)) {\r\n      alert('Speech recognition not supported in this browser');\r\n      return;\r\n    }\r\n\r\n    if (!recognitionRef.current) {\r\n      const recognition = new (window as any).webkitSpeechRecognition();\r\n      recognition.continuous = false;\r\n      recognition.interimResults = false;\r\n      recognition.lang = 'en-US';\r\n\r\n      recognition.onstart = () => setInternalIsListening(true);\r\n      recognition.onresult = (event: any) => {\r\n        const transcript = event.results[0][0].transcript;\r\n        setInput(transcript);\r\n        setInternalIsListening(false);\r\n      };\r\n      recognition.onerror = () => setInternalIsListening(false);\r\n      recognition.onend = () => setInternalIsListening(false);\r\n\r\n      recognitionRef.current = recognition;\r\n    }\r\n\r\n    if (!currentIsListening) {\r\n      recognitionRef.current.start();\r\n    } else {\r\n      recognitionRef.current.stop();\r\n      setInternalIsListening(false);\r\n    }\r\n  };\r\n\r\n  /**\r\n   * IMAGE UPLOAD HANDLER\r\n   */\r\n  const handleImageUpload = () => {\r\n    if (onImageUpload) {\r\n      onImageUpload();\r\n      return;\r\n    }\r\n    \r\n    // Internal image upload logic\r\n    setIsUploadModalOpen(true);\r\n  };\r\n\r\n  // ================================\r\n  // EVENT HANDLERS\r\n  // ================================\r\n  \r\n  // Update sizing when input changes\r\n  useEffect(() => {\r\n    autoSize();\r\n  }, [input]);\r\n  \r\n  // Handle input changes\r\n  const handleInputChange = (e: React.ChangeEvent<HTMLTextAreaElement>) => {\r\n    setInput(e.target.value);\r\n  };\r\n\r\n  const handleSubmit = (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    handleSearch();\r\n  };\r\n\r\n  const handleKeyDown = (e: React.KeyboardEvent) => {\r\n    if (e.key === 'Enter' && !e.shiftKey) {\r\n      e.preventDefault();\r\n      handleSubmit(e);\r\n    }\r\n  };\r\n\r\n  const handleLogoClick = () => {\r\n    if (onLogoClick) {\r\n      onLogoClick();\r\n    } else {\r\n      // Default behavior: navigate to home page\r\n      navigate('/');\r\n    }\r\n  };\r\n\r\n  // ================================\r\n  // LIFECYCLE HOOKS\r\n  // ================================\r\n\r\n  /**\r\n   * CLEANUP EFFECT\r\n   * Resets loading state when component unmounts\r\n   */\r\n  useEffect(() => {\r\n    return () => {\r\n      setIsLoading(false);\r\n      setLoadingMessage('Searching...');\r\n    };\r\n  }, []);\r\n\r\n  // ================================\r\n  // UI COMPONENTS\r\n  // ================================\r\n\r\n  /**\r\n   * LOADING OVERLAY COMPONENT\r\n   * Shows animated loading screen with progress bar during search operations\r\n   */\r\n  const LoadingOverlay: React.FC<{ message: string; progress: number }> = ({ message, progress }) => (\r\n    <div style={{\r\n      position: 'fixed',\r\n      top: 0,\r\n      left: 0,\r\n      right: 0,\r\n      bottom: 0,\r\n      backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n      display: 'flex',\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n      zIndex: 9999\r\n    }}>\r\n      <div style={{\r\n        backgroundColor: 'white',\r\n        borderRadius: '12px',\r\n        padding: '40px',\r\n        textAlign: 'center',\r\n        minWidth: '320px',\r\n        boxShadow: '0 10px 25px rgba(0, 0, 0, 0.2)'\r\n      }}>\r\n        {/* Spinner */}\r\n        <div style={{ margin: '0 auto 24px auto' }}>\r\n          <img \r\n            src=\"/assets/whatishealthyspinner.gif\" \r\n            alt=\"Loading...\" \r\n            style={{\r\n              width: '48px',\r\n              height: '48px',\r\n              objectFit: 'contain'\r\n            }}\r\n          />\r\n        </div>\r\n        \r\n        {/* Title */}\r\n        <h3 style={{\r\n          margin: '0 0 8px 0',\r\n          fontSize: '24px',\r\n          fontWeight: '600',\r\n          color: '#1f2937'\r\n        }}>\r\n          Loading Content\r\n        </h3>\r\n        \r\n        {/* Subtitle */}\r\n        <p style={{\r\n          margin: '0 0 24px 0',\r\n          fontSize: '16px',\r\n          color: '#6b7280'\r\n        }}>\r\n          Please wait while we process your request...\r\n        </p>\r\n        \r\n        {/* Progress Bar */}\r\n        <div style={{\r\n          width: '100%',\r\n          height: '8px',\r\n          backgroundColor: '#e5e7eb',\r\n          borderRadius: '4px',\r\n          overflow: 'hidden',\r\n          marginBottom: '12px'\r\n        }}>\r\n          <div style={{\r\n            width: `${progress}%`,\r\n            height: '100%',\r\n            backgroundColor: '#3b82f6',\r\n            borderRadius: '4px',\r\n            transition: 'width 0.3s ease'\r\n          }} />\r\n        </div>\r\n        \r\n        <div style={{\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          justifyContent: 'space-between',\r\n          marginTop: '16px'\r\n        }}>\r\n          <p style={{\r\n            margin: 0,\r\n            fontSize: '14px',\r\n            color: '#6b7280'\r\n          }}>\r\n            {progress}% Complete\r\n          </p>\r\n          \r\n          {/* Cancel button */}\r\n          <button\r\n            onClick={handleCancelSearch}\r\n            style={{\r\n              backgroundColor: 'transparent',\r\n              color: '#555',\r\n              border: '1px solid #ccc',\r\n              borderRadius: '16px',\r\n              padding: '8px 16px',\r\n              fontSize: '14px',\r\n              fontWeight: '500',\r\n              cursor: 'pointer',\r\n              transition: 'all 0.2s ease'\r\n            }}\r\n          >\r\n            Cancel\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  const headerClasses = `vhealth-header ${variant} ${className}`.trim();\r\n\r\n  return (\r\n    <>\r\n      {/* Ensure keyframes are available */}\r\n      <style>\r\n        {`\r\n          @keyframes wiH-border-sweep {\r\n            0%   { background-position: 0 0, 0% 0; }\r\n            100% { background-position: 0 0, 200% 0; }\r\n          }\r\n        `}\r\n      </style>\r\n      \r\n      {/* LOADING OVERLAY - Shows during search operations */}\r\n      {isLoading && (\r\n        <LoadingOverlay \r\n          message={loadingMessage}\r\n          progress={progressFromMessage(loadingMessage)}\r\n        />\r\n      )}\r\n\r\n      <header className={headerClasses}>\r\n        {/* === TOP BAR: Login only (no notifications for client) === */}\r\n        <div className=\"vhealth-topbar\">\r\n          <div className=\"vhealth-topbar-right\">\r\n            {showLogin && (\r\n              <div \r\n                className={`header-auth-wrapper ${isScrolled ? 'hidden-on-scroll' : ''}`}\r\n                style={{\r\n                  minWidth: '48px',\r\n                  minHeight: '48px',\r\n                  padding: '4px',\r\n                  display: isScrolled ? 'none' : 'flex',\r\n                  alignItems: 'center',\r\n                  justifyContent: 'center',\r\n                  opacity: isScrolled ? 0 : 1,\r\n                  visibility: isScrolled ? 'hidden' : 'visible',\r\n                  transition: 'all 0.2s ease'\r\n                }}>\r\n                <MultiAuthLogin \r\n                  position=\"inline\"\r\n                  onUserChange={(user) => console.log('User changed in header:', user)}\r\n                  onSignIn={(user) => console.log('User signed in from header:', user)}\r\n                  onSignOut={() => console.log('User signed out from header')}\r\n                />\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* === MAIN BAR: Logo + Search === */}\r\n        <div className=\"vhealth-mainbar\">\r\n          {/* Logo Section */}\r\n          <div className=\"vhealth-logo-container\">\r\n            <img\r\n              src=\"/assets/wihylogo.png\"\r\n              alt=\"What is Healthy?\"\r\n              className={`vhealth-logo ${variant}-logo`}\r\n              onClick={handleLogoClick}\r\n              style={{ cursor: onLogoClick ? 'pointer' : 'default' }}\r\n            />\r\n          </div>\r\n\r\n          {/* Navigation Links */}\r\n          <div style={{\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            gap: '20px',\r\n            marginLeft: '20px'\r\n          }}>\r\n            <button\r\n              onClick={() => navigate('/dashboard')}\r\n              style={{\r\n                background: 'none',\r\n                border: 'none',\r\n                color: '#374151',\r\n                fontSize: '16px',\r\n                fontWeight: '500',\r\n                cursor: 'pointer',\r\n                padding: '8px 16px',\r\n                borderRadius: '6px',\r\n                transition: 'all 0.2s ease'\r\n              }}\r\n              onMouseOver={(e) => {\r\n                e.currentTarget.style.backgroundColor = '#f3f4f6';\r\n                e.currentTarget.style.color = '#3b82f6';\r\n              }}\r\n              onMouseOut={(e) => {\r\n                e.currentTarget.style.backgroundColor = 'transparent';\r\n                e.currentTarget.style.color = '#374151';\r\n              }}\r\n            >\r\n              📊 Dashboard\r\n            </button>\r\n          </div>\r\n\r\n          {/* Search Input Section */}\r\n          {showSearchInput && (\r\n            <div className=\"vhealth-search-section\">\r\n              <form className=\"vhealth-search-form\" onSubmit={handleSubmit}>\r\n                <div \r\n                  className=\"search-input-container\"\r\n                  style={{\r\n                    animation: 'wiH-border-sweep 2.2s linear infinite !important',\r\n                    background: `\r\n                      linear-gradient(#fff, #fff) padding-box,\r\n                      linear-gradient(90deg, #fa5f06, #ffffff, #C0C0C0, #4cbb17, #1a73e8) border-box\r\n                    `,\r\n                    backgroundSize: '100% 100%, 200% 100%',\r\n                    border: '2px solid transparent',\r\n                    borderRadius: '24px',\r\n                    position: 'relative',\r\n                    width: '100%',\r\n                    maxWidth: '800px',\r\n                    margin: '0 auto',\r\n                    boxShadow: '0 1px 6px rgba(32,33,36,0.28)'\r\n                  }}\r\n                >\r\n                  <textarea\r\n                    ref={searchInputRef}\r\n                    value={input}\r\n                    onChange={handleInputChange}\r\n                    onKeyDown={handleKeyDown}\r\n                    placeholder=\"Ask anything about health...\"\r\n                    className=\"search-input\"\r\n                    disabled={isLoading}\r\n                    rows={1}\r\n                    style={{\r\n                      resize: 'none',\r\n                      overflow: 'hidden',\r\n                      minHeight: '44px',\r\n                      height: 'auto',\r\n                      paddingRight: '100px'\r\n                    }}\r\n                  />\r\n\r\n                  <div className=\"search-icons\">\r\n                    {input && (\r\n                      <button\r\n                        type=\"button\"\r\n                        className=\"icon-button clear-button\"\r\n                        onClick={clearInput}\r\n                        title=\"Clear\"\r\n                      >\r\n                        <svg viewBox=\"0 0 24 24\" width=\"16\" height=\"16\">\r\n                          <path d=\"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z\"/>\r\n                        </svg>\r\n                      </button>\r\n                    )}\r\n\r\n                    <button\r\n                      type=\"button\"\r\n                      className=\"icon-button\"\r\n                      onClick={handleImageUpload}\r\n                      title=\"Upload image\"\r\n                      disabled={isLoading}\r\n                    >\r\n                      <svg viewBox=\"0 0 24 24\" width=\"20\" height=\"20\" fill=\"currentColor\">\r\n                        <path d=\"M9 2L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2H9zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5z\"/>\r\n                      </svg>\r\n                    </button>\r\n\r\n                    <button\r\n                      type=\"button\"\r\n                      className={`icon-button ${currentIsListening ? 'listening' : ''}`}\r\n                      onClick={handleVoiceInput}\r\n                      title={currentIsListening ? 'Stop listening' : 'Start voice input'}\r\n                      disabled={isLoading}\r\n                    >\r\n                      <svg viewBox=\"0 0 24 24\" width=\"20\" height=\"20\" fill=\"currentColor\">\r\n                        <path d=\"M12 14c1.66 0 2.99-1.34 2.99-3L15 5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.48 6-3.3 6-6.72h-1.7z\"/>\r\n                      </svg>\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              </form>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </header>\r\n\r\n    {/* IMAGE UPLOAD MODAL - Opens when camera button is clicked */}\r\n    <ImageUploadModal\r\n      isOpen={isUploadModalOpen}\r\n      onClose={() => setIsUploadModalOpen(false)}\r\n      onAnalysisComplete={handleAnalysisComplete}\r\n      title=\"Upload Image\"\r\n      subtitle=\"Upload Image for Analysis\"\r\n    />\r\n  </>\r\n  );\r\n};\r\n\r\nexport default Header;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}