{"ast":null,"code":"var _jsxFileName = \"C:\\\\repo\\\\wihy_ui\\\\client\\\\src\\\\components\\\\shared\\\\components\\\\Header.tsx\",\n  _s = $RefreshSig$();\n/* filepath: c:\\vHealth\\vhealth\\client\\src\\components\\shared\\components\\Header.tsx */\nimport React, { useState, useRef, useEffect, useLayoutEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport MultiAuthLogin from './MultiAuthLogin';\nimport ImageUploadModal from '../../ImageUploadModal';\nimport { wihyAPI } from '../../../services/wihyAPI';\nimport { getApiEndpoint } from '../../../config/apiConfig';\nimport '../../../styles/VHealthSearch.css';\nimport '../../../styles/search-components.css';\nimport './Header.css';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst Header = ({\n  searchQuery = '',\n  onSearchSubmit,\n  onVoiceInput,\n  onImageUpload,\n  onLogoClick,\n  isListening = false,\n  showSearchInput = true,\n  variant = 'landing',\n  className = '',\n  showLogin = true\n}) => {\n  _s();\n  // ================================\n  // STATE MANAGEMENT\n  // ================================\n  const [input, setInput] = useState(searchQuery);\n  const [internalIsListening, setInternalIsListening] = useState(false);\n  const [isUploadModalOpen, setIsUploadModalOpen] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n  const [loadingMessage, setLoadingMessage] = useState('Searching...');\n  const navigate = useNavigate();\n  const searchInputRef = useRef(null);\n  const recognitionRef = useRef(null);\n  const abortControllerRef = useRef(null);\n\n  // Use internal listening state if onVoiceInput is not provided\n  const currentIsListening = onVoiceInput ? isListening : internalIsListening;\n\n  // ================================\n  // HEADER HEIGHT MEASUREMENT\n  // ================================\n  // Keep body offset equal to the real header height\n  useLayoutEffect(() => {\n    const header = document.querySelector('header.vhealth-header');\n    if (!header) return;\n    const apply = () => {\n      const h = Math.ceil(header.getBoundingClientRect().height);\n      document.documentElement.style.setProperty('--vh-header-height', `${h}px`);\n    };\n\n    // Run once now\n    apply();\n\n    // Update on header size change\n    const ro = new ResizeObserver(apply);\n    ro.observe(header);\n\n    // Update on viewport resize / orientation change\n    window.addEventListener('resize', apply);\n    return () => {\n      window.removeEventListener('resize', apply);\n      ro.disconnect();\n    };\n  }, []);\n\n  // ================================\n  // FORCE HEADER ANIMATION WITH JAVASCRIPT\n  // ================================\n  useEffect(() => {\n    // Force apply the rainbow border animation to header search bar using JavaScript\n    const container = document.querySelector('.vhealth-header .search-input-container');\n    if (container) {\n      console.log('Applying JavaScript animation to header search bar, variant:', variant);\n\n      // Set up the base styles\n      container.style.setProperty('border', '2px solid transparent', 'important');\n      container.style.setProperty('background', `\n        linear-gradient(#fff, #fff) padding-box,\n        linear-gradient(90deg, #fa5f06, #ffffff, #C0C0C0, #4cbb17, #1a73e8) border-box\n      `, 'important');\n      container.style.setProperty('background-size', '100% 100%, 200% 100%', 'important');\n      container.style.setProperty('border-radius', '24px', 'important');\n\n      // Remove CSS animation and use JavaScript instead\n      container.style.setProperty('animation', 'none', 'important');\n\n      // JavaScript animation\n      let position = 0;\n      const animate = () => {\n        position += 1;\n        if (position >= 200) position = 0;\n        container.style.setProperty('background-position', `0 0, ${position}% 0`, 'important');\n        requestAnimationFrame(animate);\n      };\n      animate();\n    }\n  }, [variant]); // Re-run when variant changes\n\n  // ================================\n  // UTILITY FUNCTIONS\n  // ================================\n\n  /**\r\n   * AUTO-SIZE TEXT AREA\r\n   * Dynamically adjusts the height of the search input based on content\r\n   */\n  const autoSize = () => {\n    const el = searchInputRef.current;\n    if (!el) return;\n\n    // Reset to default height when empty\n    if (!input.trim()) {\n      el.style.height = '44px';\n      el.style.overflowY = 'hidden';\n      return;\n    }\n\n    // Auto-expand height based on content\n    el.style.height = \"0\";\n    const next = el.scrollHeight;\n    el.style.height = next + \"px\";\n\n    // Enable scrolling if height exceeds max\n    const max = parseFloat(getComputedStyle(el).maxHeight);\n    el.style.overflowY = next > max ? \"auto\" : \"hidden\";\n  };\n\n  /**\r\n   * CLEAR SEARCH INPUT\r\n   * Clears search input and resets its height to default\r\n   */\n  const clearInput = () => {\n    setInput('');\n    setTimeout(() => {\n      if (searchInputRef.current) {\n        searchInputRef.current.style.height = '44px';\n      }\n    }, 10);\n  };\n\n  /**\r\n   * PROGRESS CALCULATOR\r\n   * Converts loading message text to progress percentage for UI feedback\r\n   */\n  const progressFromMessage = msg => {\n    if (msg.includes('Initializing')) return 10;\n    if (msg.includes('Checking cache')) return 25;\n    if (msg.includes('Analyzing with AI')) return 55;\n    if (msg.includes('Processing results')) return 75;\n    if (msg.includes('Results ready') || msg.includes('Response ready')) return 95;\n    if (msg.includes('Processing image')) return 35;\n    if (msg.includes('Checking nutrition')) return 45;\n    if (msg.includes('Analyzing nutrition')) return 60;\n    if (msg.includes('Processing nutrition')) return 80;\n    if (msg.includes('complete')) return 95;\n    if (msg.includes('failed')) return 100;\n    return 40;\n  };\n\n  // ================================\n  // SEARCH FUNCTIONALITY\n  // ================================\n\n  /**\r\n   * MAIN SEARCH HANDLER\r\n   * Primary search function that handles text-based health queries\r\n   */\n  const handleSearch = async queryParam => {\n    const queryToUse = queryParam || input;\n    if (!queryToUse.trim() || isLoading) return;\n\n    // If onSearchSubmit is provided, use it instead of internal search\n    if (onSearchSubmit) {\n      onSearchSubmit(queryToUse.trim());\n      return;\n    }\n\n    // Create new AbortController for this request\n    abortControllerRef.current = new AbortController();\n    const signal = abortControllerRef.current.signal;\n    setIsLoading(true);\n    setLoadingMessage('Initializing search...');\n    try {\n      // Step 1: Check database cache first\n      setLoadingMessage('Checking cache...');\n      try {\n        const response = await fetch(getApiEndpoint(`/cache/get?q=${encodeURIComponent(queryToUse)}`), {\n          signal\n        });\n        if (response.ok) {\n          const cachedData = await response.json();\n          console.log('Using cached results from database');\n          setLoadingMessage('Loading cached results...');\n          await new Promise(resolve => setTimeout(resolve, 300));\n          setIsLoading(false);\n          navigate(`/results?q=${encodeURIComponent(queryToUse)}`, {\n            state: {\n              results: cachedData.results,\n              dataSource: cachedData.source || 'cache',\n              fromSearch: true\n            }\n          });\n          return;\n        }\n      } catch (cacheError) {\n        if (cacheError.name === 'AbortError') {\n          console.log('Cache request was cancelled');\n          return;\n        }\n        console.log('No cache found, proceeding with API call');\n      }\n\n      // Step 2: Get fresh results from WiHy API\n      setLoadingMessage('Analyzing with WiHy AI...');\n      try {\n        console.log('Making WiHy API search request from Header for:', queryToUse);\n        const wihyResponse = await wihyAPI.searchHealth(queryToUse);\n        if (wihyResponse.success) {\n          // Convert WiHy response to expected format\n          const searchResults = {\n            summary: wihyResponse.wihy_response.core_principle,\n            details: wihyAPI.formatWihyResponse(wihyResponse),\n            sources: wihyAPI.extractCitations(wihyResponse),\n            recommendations: wihyAPI.extractRecommendations(wihyResponse),\n            relatedTopics: [],\n            medicalDisclaimer: 'This guidance is based on evidence-based health principles. Always consult healthcare professionals for personalized medical advice.',\n            dataSource: 'wihy'\n          };\n          const isValidResult = searchResults && typeof searchResults === 'object' && searchResults !== null && (searchResults.summary || searchResults.details || Object.keys(searchResults).length > 0);\n          if (isValidResult) {\n            // Step 3: Save to database cache (async, don't wait)\n            setLoadingMessage('Caching results...');\n            fetch(getApiEndpoint('/cache/save'), {\n              method: 'POST',\n              headers: {\n                'Content-Type': 'application/json'\n              },\n              body: JSON.stringify({\n                query: queryToUse,\n                results: searchResults,\n                source: 'openai'\n              })\n            }).catch(err => console.warn('Cache save error:', err));\n            setLoadingMessage('Results ready!');\n            await new Promise(resolve => setTimeout(resolve, 300));\n            setIsLoading(false);\n            navigate(`/results?q=${encodeURIComponent(queryToUse)}`, {\n              state: {\n                results: searchResults,\n                dataSource: 'wihy',\n                fromSearch: true\n              }\n            });\n            return;\n          } else {\n            throw new Error('WiHy API returned invalid results');\n          }\n        } else {\n          throw new Error('WiHy API request failed');\n        }\n      } catch (apiError) {\n        if (apiError.name === 'AbortError') {\n          console.log('API request was cancelled');\n          return;\n        }\n        console.error('Health search service failed:', apiError);\n        setLoadingMessage('No results found. Please try a different search.');\n        setTimeout(() => {\n          setIsLoading(false);\n          setLoadingMessage('Searching...');\n        }, 3000);\n        return;\n      }\n    } catch (error) {\n      if (error.name === 'AbortError') {\n        console.log('Search request was cancelled');\n        return;\n      }\n      console.error(\"Search error:\", error);\n      setLoadingMessage('Search failed. Please try again.');\n      setTimeout(() => {\n        setIsLoading(false);\n        setLoadingMessage('Searching...');\n      }, 2000);\n    }\n  };\n\n  /**\r\n   * SEARCH CANCELLATION HANDLER\r\n   */\n  const handleCancelSearch = () => {\n    if (abortControllerRef.current) {\n      abortControllerRef.current.abort();\n      abortControllerRef.current = null;\n    }\n    setIsLoading(false);\n    setLoadingMessage('Searching...');\n  };\n\n  /**\r\n   * IMAGE ANALYSIS COMPLETION HANDLER\r\n   */\n  const handleAnalysisComplete = async foodName => {\n    if (!foodName || isLoading) {\n      setIsUploadModalOpen(false);\n      return;\n    }\n    if (onSearchSubmit) {\n      onSearchSubmit(foodName);\n      setIsUploadModalOpen(false);\n      return;\n    }\n\n    // Use internal search logic\n    setInput(foodName);\n    await handleSearch(foodName);\n    setIsUploadModalOpen(false);\n  };\n\n  /**\r\n   * VOICE INPUT HANDLER\r\n   */\n  const handleVoiceInput = () => {\n    if (onVoiceInput) {\n      onVoiceInput();\n      return;\n    }\n\n    // Internal voice input logic\n    if (isLoading) return;\n    if (!('webkitSpeechRecognition' in window)) {\n      alert('Speech recognition not supported in this browser');\n      return;\n    }\n    if (!recognitionRef.current) {\n      const recognition = new window.webkitSpeechRecognition();\n      recognition.continuous = false;\n      recognition.interimResults = false;\n      recognition.lang = 'en-US';\n      recognition.onstart = () => setInternalIsListening(true);\n      recognition.onresult = event => {\n        const transcript = event.results[0][0].transcript;\n        setInput(transcript);\n        setInternalIsListening(false);\n      };\n      recognition.onerror = () => setInternalIsListening(false);\n      recognition.onend = () => setInternalIsListening(false);\n      recognitionRef.current = recognition;\n    }\n    if (!currentIsListening) {\n      recognitionRef.current.start();\n    } else {\n      recognitionRef.current.stop();\n      setInternalIsListening(false);\n    }\n  };\n\n  /**\r\n   * IMAGE UPLOAD HANDLER\r\n   */\n  const handleImageUpload = () => {\n    if (onImageUpload) {\n      onImageUpload();\n      return;\n    }\n\n    // Internal image upload logic\n    setIsUploadModalOpen(true);\n  };\n\n  // ================================\n  // EVENT HANDLERS\n  // ================================\n\n  // Update sizing when input changes\n  useEffect(() => {\n    autoSize();\n  }, [input]);\n\n  // Handle input changes\n  const handleInputChange = e => {\n    setInput(e.target.value);\n  };\n  const handleSubmit = e => {\n    e.preventDefault();\n    handleSearch();\n  };\n  const handleKeyDown = e => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleSubmit(e);\n    }\n  };\n  const handleLogoClick = () => {\n    if (onLogoClick) {\n      onLogoClick();\n    } else {\n      // Default behavior: navigate to home page\n      navigate('/');\n    }\n  };\n\n  // ================================\n  // LIFECYCLE HOOKS\n  // ================================\n\n  /**\r\n   * CLEANUP EFFECT\r\n   * Resets loading state when component unmounts\r\n   */\n  useEffect(() => {\n    return () => {\n      setIsLoading(false);\n      setLoadingMessage('Searching...');\n    };\n  }, []);\n\n  // ================================\n  // UI COMPONENTS\n  // ================================\n\n  /**\r\n   * LOADING OVERLAY COMPONENT\r\n   * Shows animated loading screen with progress bar during search operations\r\n   */\n  const LoadingOverlay = ({\n    message,\n    progress\n  }) => /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      position: 'fixed',\n      top: 0,\n      left: 0,\n      right: 0,\n      bottom: 0,\n      backgroundColor: 'rgba(0, 0, 0, 0.5)',\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'center',\n      zIndex: 9999\n    },\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        backgroundColor: 'white',\n        borderRadius: '12px',\n        padding: '40px',\n        textAlign: 'center',\n        minWidth: '320px',\n        boxShadow: '0 10px 25px rgba(0, 0, 0, 0.2)'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          margin: '0 auto 24px auto'\n        },\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          src: \"/assets/whatishealthyspinner.gif\",\n          alt: \"Loading...\",\n          style: {\n            width: '48px',\n            height: '48px',\n            objectFit: 'contain'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 493,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 492,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n        style: {\n          margin: '0 0 8px 0',\n          fontSize: '24px',\n          fontWeight: '600',\n          color: '#1f2937'\n        },\n        children: \"Loading Content\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 505,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        style: {\n          margin: '0 0 24px 0',\n          fontSize: '16px',\n          color: '#6b7280'\n        },\n        children: \"Please wait while we process your request...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 515,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          width: '100%',\n          height: '8px',\n          backgroundColor: '#e5e7eb',\n          borderRadius: '4px',\n          overflow: 'hidden',\n          marginBottom: '12px'\n        },\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            width: `${progress}%`,\n            height: '100%',\n            backgroundColor: '#3b82f6',\n            borderRadius: '4px',\n            transition: 'width 0.3s ease'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 532,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 524,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'space-between',\n          marginTop: '16px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            margin: 0,\n            fontSize: '14px',\n            color: '#6b7280'\n          },\n          children: [progress, \"% Complete\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 547,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleCancelSearch,\n          style: {\n            backgroundColor: 'transparent',\n            color: '#555',\n            border: '1px solid #ccc',\n            borderRadius: '16px',\n            padding: '8px 16px',\n            fontSize: '14px',\n            fontWeight: '500',\n            cursor: 'pointer',\n            transition: 'all 0.2s ease'\n          },\n          children: \"Cancel\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 556,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 541,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 483,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 471,\n    columnNumber: 5\n  }, this);\n  const headerClasses = `vhealth-header ${variant} ${className}`.trim();\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"style\", {\n      children: `\n          @keyframes wiH-border-sweep {\n            0%   { background-position: 0 0, 0% 0; }\n            100% { background-position: 0 0, 200% 0; }\n          }\n        `\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 582,\n      columnNumber: 7\n    }, this), isLoading && /*#__PURE__*/_jsxDEV(LoadingOverlay, {\n      message: loadingMessage,\n      progress: progressFromMessage(loadingMessage)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 593,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"header\", {\n      className: headerClasses,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"vhealth-topbar\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"vhealth-topbar-right\",\n          children: showLogin && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"header-auth-wrapper\",\n            children: /*#__PURE__*/_jsxDEV(MultiAuthLogin, {\n              position: \"inline\",\n              onUserChange: user => console.log('User changed in header:', user),\n              onSignIn: user => console.log('User signed in from header:', user),\n              onSignOut: () => console.log('User signed out from header')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 605,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 604,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 602,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 601,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"vhealth-mainbar\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"vhealth-logo-container\",\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            src: \"/assets/wihylogo.png\",\n            alt: \"What is Healthy?\",\n            className: `vhealth-logo ${variant}-logo`,\n            onClick: handleLogoClick,\n            style: {\n              cursor: onLogoClick ? 'pointer' : 'default'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 620,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 619,\n          columnNumber: 11\n        }, this), showSearchInput && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"vhealth-search-section\",\n          children: /*#__PURE__*/_jsxDEV(\"form\", {\n            className: \"vhealth-search-form\",\n            onSubmit: handleSubmit,\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"search-input-container\",\n              style: {\n                animation: 'wiH-border-sweep 2.2s linear infinite !important',\n                background: `\n                      linear-gradient(#fff, #fff) padding-box,\n                      linear-gradient(90deg, #fa5f06, #ffffff, #C0C0C0, #4cbb17, #1a73e8) border-box\n                    `,\n                backgroundSize: '100% 100%, 200% 100%',\n                border: '2px solid transparent',\n                borderRadius: '24px',\n                position: 'relative',\n                width: '100%',\n                maxWidth: '800px',\n                margin: '0 auto',\n                boxShadow: '0 1px 6px rgba(32,33,36,0.28)'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n                ref: searchInputRef,\n                value: input,\n                onChange: handleInputChange,\n                onKeyDown: handleKeyDown,\n                placeholder: \"Ask anything about health...\",\n                className: \"search-input\",\n                disabled: isLoading,\n                rows: 1,\n                style: {\n                  resize: 'none',\n                  overflow: 'hidden',\n                  minHeight: '44px',\n                  height: 'auto',\n                  paddingRight: '100px'\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 651,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"search-icons\",\n                children: [input && /*#__PURE__*/_jsxDEV(\"button\", {\n                  type: \"button\",\n                  className: \"icon-button clear-button\",\n                  onClick: clearInput,\n                  title: \"Clear\",\n                  children: /*#__PURE__*/_jsxDEV(\"svg\", {\n                    viewBox: \"0 0 24 24\",\n                    width: \"16\",\n                    height: \"16\",\n                    children: /*#__PURE__*/_jsxDEV(\"path\", {\n                      d: \"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 678,\n                      columnNumber: 27\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 677,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 671,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  type: \"button\",\n                  className: \"icon-button\",\n                  onClick: handleImageUpload,\n                  title: \"Upload image\",\n                  disabled: isLoading,\n                  children: /*#__PURE__*/_jsxDEV(\"svg\", {\n                    viewBox: \"0 0 24 24\",\n                    width: \"20\",\n                    height: \"20\",\n                    fill: \"currentColor\",\n                    children: /*#__PURE__*/_jsxDEV(\"path\", {\n                      d: \"M9 2L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2H9zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5z\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 691,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 690,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 683,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  type: \"button\",\n                  className: `icon-button ${currentIsListening ? 'listening' : ''}`,\n                  onClick: handleVoiceInput,\n                  title: currentIsListening ? 'Stop listening' : 'Start voice input',\n                  disabled: isLoading,\n                  children: /*#__PURE__*/_jsxDEV(\"svg\", {\n                    viewBox: \"0 0 24 24\",\n                    width: \"20\",\n                    height: \"20\",\n                    fill: \"currentColor\",\n                    children: /*#__PURE__*/_jsxDEV(\"path\", {\n                      d: \"M12 14c1.66 0 2.99-1.34 2.99-3L15 5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.48 6-3.3 6-6.72h-1.7z\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 703,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 702,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 695,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 669,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 633,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 632,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 631,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 617,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 599,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(ImageUploadModal, {\n      isOpen: isUploadModalOpen,\n      onClose: () => setIsUploadModalOpen(false),\n      onAnalysisComplete: handleAnalysisComplete,\n      title: \"Upload Image\",\n      subtitle: \"Upload Image for Analysis\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 715,\n      columnNumber: 5\n    }, this)]\n  }, void 0, true);\n};\n_s(Header, \"+jfxNjU8dRMzpJxdENkUIRMkeFI=\", false, function () {\n  return [useNavigate];\n});\n_c = Header;\nexport default Header;\nvar _c;\n$RefreshReg$(_c, \"Header\");","map":{"version":3,"names":["React","useState","useRef","useEffect","useLayoutEffect","useNavigate","MultiAuthLogin","ImageUploadModal","wihyAPI","getApiEndpoint","jsxDEV","_jsxDEV","Fragment","_Fragment","Header","searchQuery","onSearchSubmit","onVoiceInput","onImageUpload","onLogoClick","isListening","showSearchInput","variant","className","showLogin","_s","input","setInput","internalIsListening","setInternalIsListening","isUploadModalOpen","setIsUploadModalOpen","isLoading","setIsLoading","loadingMessage","setLoadingMessage","navigate","searchInputRef","recognitionRef","abortControllerRef","currentIsListening","header","document","querySelector","apply","h","Math","ceil","getBoundingClientRect","height","documentElement","style","setProperty","ro","ResizeObserver","observe","window","addEventListener","removeEventListener","disconnect","container","console","log","position","animate","requestAnimationFrame","autoSize","el","current","trim","overflowY","next","scrollHeight","max","parseFloat","getComputedStyle","maxHeight","clearInput","setTimeout","progressFromMessage","msg","includes","handleSearch","queryParam","queryToUse","AbortController","signal","response","fetch","encodeURIComponent","ok","cachedData","json","Promise","resolve","state","results","dataSource","source","fromSearch","cacheError","name","wihyResponse","searchHealth","success","searchResults","summary","wihy_response","core_principle","details","formatWihyResponse","sources","extractCitations","recommendations","extractRecommendations","relatedTopics","medicalDisclaimer","isValidResult","Object","keys","length","method","headers","body","JSON","stringify","query","catch","err","warn","Error","apiError","error","handleCancelSearch","abort","handleAnalysisComplete","foodName","handleVoiceInput","alert","recognition","webkitSpeechRecognition","continuous","interimResults","lang","onstart","onresult","event","transcript","onerror","onend","start","stop","handleImageUpload","handleInputChange","e","target","value","handleSubmit","preventDefault","handleKeyDown","key","shiftKey","handleLogoClick","LoadingOverlay","message","progress","top","left","right","bottom","backgroundColor","display","alignItems","justifyContent","zIndex","children","borderRadius","padding","textAlign","minWidth","boxShadow","margin","src","alt","width","objectFit","fileName","_jsxFileName","lineNumber","columnNumber","fontSize","fontWeight","color","overflow","marginBottom","transition","marginTop","onClick","border","cursor","headerClasses","onUserChange","user","onSignIn","onSignOut","onSubmit","animation","background","backgroundSize","maxWidth","ref","onChange","onKeyDown","placeholder","disabled","rows","resize","minHeight","paddingRight","type","title","viewBox","d","fill","isOpen","onClose","onAnalysisComplete","subtitle","_c","$RefreshReg$"],"sources":["C:/repo/wihy_ui/client/src/components/shared/components/Header.tsx"],"sourcesContent":["/* filepath: c:\\vHealth\\vhealth\\client\\src\\components\\shared\\components\\Header.tsx */\r\nimport React, { useState, useRef, useEffect, useLayoutEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport MultiAuthLogin from './MultiAuthLogin';\r\nimport ImageUploadModal from '../../ImageUploadModal';\r\nimport { wihyAPI } from '../../../services/wihyAPI';\r\nimport { getApiEndpoint } from '../../../config/apiConfig';\r\nimport '../../../styles/VHealthSearch.css';\r\nimport '../../../styles/search-components.css';\r\nimport './Header.css';\r\n\r\ninterface HeaderProps {\r\n  searchQuery?: string;\r\n  onSearchSubmit?: (query: string) => void;\r\n  onVoiceInput?: () => void;\r\n  onImageUpload?: () => void;\r\n  onLogoClick?: () => void;\r\n  isListening?: boolean;\r\n  showSearchInput?: boolean;\r\n  variant?: 'landing' | 'results';\r\n  className?: string;\r\n  showLogin?: boolean;\r\n}\r\n\r\nconst Header: React.FC<HeaderProps> = ({\r\n  searchQuery = '',\r\n  onSearchSubmit,\r\n  onVoiceInput,\r\n  onImageUpload,\r\n  onLogoClick,\r\n  isListening = false,\r\n  showSearchInput = true,\r\n  variant = 'landing',\r\n  className = '',\r\n  showLogin = true\r\n}) => {\r\n  // ================================\r\n  // STATE MANAGEMENT\r\n  // ================================\r\n  const [input, setInput] = useState(searchQuery);\r\n  const [internalIsListening, setInternalIsListening] = useState(false);\r\n  const [isUploadModalOpen, setIsUploadModalOpen] = useState(false);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [loadingMessage, setLoadingMessage] = useState('Searching...');\r\n  \r\n  const navigate = useNavigate();\r\n  const searchInputRef = useRef<HTMLTextAreaElement>(null);\r\n  const recognitionRef = useRef<any>(null);\r\n  const abortControllerRef = useRef<AbortController | null>(null);\r\n\r\n  // Use internal listening state if onVoiceInput is not provided\r\n  const currentIsListening = onVoiceInput ? isListening : internalIsListening;\r\n\r\n  // ================================\r\n  // HEADER HEIGHT MEASUREMENT\r\n  // ================================\r\n  // Keep body offset equal to the real header height\r\n  useLayoutEffect(() => {\r\n    const header = document.querySelector('header.vhealth-header') as HTMLElement | null;\r\n    if (!header) return;\r\n\r\n    const apply = () => {\r\n      const h = Math.ceil(header.getBoundingClientRect().height);\r\n      document.documentElement.style.setProperty('--vh-header-height', `${h}px`);\r\n    };\r\n\r\n    // Run once now\r\n    apply();\r\n\r\n    // Update on header size change\r\n    const ro = new ResizeObserver(apply);\r\n    ro.observe(header);\r\n\r\n    // Update on viewport resize / orientation change\r\n    window.addEventListener('resize', apply);\r\n\r\n    return () => {\r\n      window.removeEventListener('resize', apply);\r\n      ro.disconnect();\r\n    };\r\n  }, []);\r\n\r\n  // ================================\r\n  // FORCE HEADER ANIMATION WITH JAVASCRIPT\r\n  // ================================\r\n  useEffect(() => {\r\n    // Force apply the rainbow border animation to header search bar using JavaScript\r\n    const container = document.querySelector('.vhealth-header .search-input-container') as HTMLElement;\r\n    if (container) {\r\n      console.log('Applying JavaScript animation to header search bar, variant:', variant);\r\n      \r\n      // Set up the base styles\r\n      container.style.setProperty('border', '2px solid transparent', 'important');\r\n      container.style.setProperty('background', `\r\n        linear-gradient(#fff, #fff) padding-box,\r\n        linear-gradient(90deg, #fa5f06, #ffffff, #C0C0C0, #4cbb17, #1a73e8) border-box\r\n      `, 'important');\r\n      container.style.setProperty('background-size', '100% 100%, 200% 100%', 'important');\r\n      container.style.setProperty('border-radius', '24px', 'important');\r\n      \r\n      // Remove CSS animation and use JavaScript instead\r\n      container.style.setProperty('animation', 'none', 'important');\r\n      \r\n      // JavaScript animation\r\n      let position = 0;\r\n      const animate = () => {\r\n        position += 1;\r\n        if (position >= 200) position = 0;\r\n        \r\n        container.style.setProperty('background-position', `0 0, ${position}% 0`, 'important');\r\n        requestAnimationFrame(animate);\r\n      };\r\n      \r\n      animate();\r\n    }\r\n  }, [variant]); // Re-run when variant changes\r\n\r\n  // ================================\r\n  // UTILITY FUNCTIONS\r\n  // ================================\r\n\r\n  /**\r\n   * AUTO-SIZE TEXT AREA\r\n   * Dynamically adjusts the height of the search input based on content\r\n   */\r\n  const autoSize = () => {\r\n    const el = searchInputRef.current;\r\n    if (!el) return;\r\n    \r\n    // Reset to default height when empty\r\n    if (!input.trim()) {\r\n      el.style.height = '44px';\r\n      el.style.overflowY = 'hidden';\r\n      return;\r\n    }\r\n    \r\n    // Auto-expand height based on content\r\n    el.style.height = \"0\";\r\n    const next = el.scrollHeight;\r\n    el.style.height = next + \"px\";\r\n    \r\n    // Enable scrolling if height exceeds max\r\n    const max = parseFloat(getComputedStyle(el).maxHeight);\r\n    el.style.overflowY = next > max ? \"auto\" : \"hidden\";\r\n  };\r\n\r\n  /**\r\n   * CLEAR SEARCH INPUT\r\n   * Clears search input and resets its height to default\r\n   */\r\n  const clearInput = () => {\r\n    setInput('');\r\n    setTimeout(() => {\r\n      if (searchInputRef.current) {\r\n        searchInputRef.current.style.height = '44px';\r\n      }\r\n    }, 10);\r\n  };\r\n\r\n  /**\r\n   * PROGRESS CALCULATOR\r\n   * Converts loading message text to progress percentage for UI feedback\r\n   */\r\n  const progressFromMessage = (msg: string) => {\r\n    if (msg.includes('Initializing')) return 10;\r\n    if (msg.includes('Checking cache')) return 25;\r\n    if (msg.includes('Analyzing with AI')) return 55;\r\n    if (msg.includes('Processing results')) return 75;\r\n    if (msg.includes('Results ready') || msg.includes('Response ready')) return 95;\r\n    if (msg.includes('Processing image')) return 35;\r\n    if (msg.includes('Checking nutrition')) return 45;\r\n    if (msg.includes('Analyzing nutrition')) return 60;\r\n    if (msg.includes('Processing nutrition')) return 80;\r\n    if (msg.includes('complete')) return 95;\r\n    if (msg.includes('failed')) return 100;\r\n    return 40;\r\n  };\r\n\r\n  // ================================\r\n  // SEARCH FUNCTIONALITY\r\n  // ================================\r\n\r\n  /**\r\n   * MAIN SEARCH HANDLER\r\n   * Primary search function that handles text-based health queries\r\n   */\r\n  const handleSearch = async (queryParam?: string) => {\r\n    const queryToUse = queryParam || input;\r\n    if (!queryToUse.trim() || isLoading) return;\r\n    \r\n    // If onSearchSubmit is provided, use it instead of internal search\r\n    if (onSearchSubmit) {\r\n      onSearchSubmit(queryToUse.trim());\r\n      return;\r\n    }\r\n\r\n    // Create new AbortController for this request\r\n    abortControllerRef.current = new AbortController();\r\n    const signal = abortControllerRef.current.signal;\r\n    \r\n    setIsLoading(true);\r\n    setLoadingMessage('Initializing search...');\r\n    \r\n    try {\r\n      // Step 1: Check database cache first\r\n      setLoadingMessage('Checking cache...');\r\n      \r\n      try {\r\n        const response = await fetch(getApiEndpoint(`/cache/get?q=${encodeURIComponent(queryToUse)}`), { signal });\r\n        \r\n        if (response.ok) {\r\n          const cachedData = await response.json();\r\n          console.log('Using cached results from database');\r\n          setLoadingMessage('Loading cached results...');\r\n          await new Promise(resolve => setTimeout(resolve, 300));\r\n          \r\n          setIsLoading(false);\r\n          navigate(`/results?q=${encodeURIComponent(queryToUse)}`, {\r\n            state: {\r\n              results: cachedData.results,\r\n              dataSource: cachedData.source || 'cache',\r\n              fromSearch: true\r\n            }\r\n          });\r\n          return;\r\n        }\r\n      } catch (cacheError) {\r\n        if (cacheError.name === 'AbortError') {\r\n          console.log('Cache request was cancelled');\r\n          return;\r\n        }\r\n        console.log('No cache found, proceeding with API call');\r\n      }\r\n\r\n      // Step 2: Get fresh results from WiHy API\r\n      setLoadingMessage('Analyzing with WiHy AI...');\r\n      \r\n      try {\r\n        console.log('Making WiHy API search request from Header for:', queryToUse);\r\n        const wihyResponse = await wihyAPI.searchHealth(queryToUse);\r\n        \r\n        if (wihyResponse.success) {\r\n          // Convert WiHy response to expected format\r\n          const searchResults = {\r\n            summary: wihyResponse.wihy_response.core_principle,\r\n            details: wihyAPI.formatWihyResponse(wihyResponse),\r\n            sources: wihyAPI.extractCitations(wihyResponse),\r\n            recommendations: wihyAPI.extractRecommendations(wihyResponse),\r\n            relatedTopics: [],\r\n            medicalDisclaimer: 'This guidance is based on evidence-based health principles. Always consult healthcare professionals for personalized medical advice.',\r\n            dataSource: 'wihy'\r\n          };\r\n          \r\n          const isValidResult = searchResults && \r\n            typeof searchResults === 'object' && \r\n            searchResults !== null &&\r\n            (searchResults.summary || searchResults.details || Object.keys(searchResults).length > 0);\r\n          \r\n          if (isValidResult) {\r\n          // Step 3: Save to database cache (async, don't wait)\r\n          setLoadingMessage('Caching results...');\r\n          \r\n          fetch(getApiEndpoint('/cache/save'), {\r\n            method: 'POST',\r\n            headers: { 'Content-Type': 'application/json' },\r\n            body: JSON.stringify({\r\n              query: queryToUse,\r\n              results: searchResults,\r\n              source: 'openai'\r\n            })\r\n          }).catch(err => console.warn('Cache save error:', err));\r\n          \r\n          setLoadingMessage('Results ready!');\r\n          await new Promise(resolve => setTimeout(resolve, 300));\r\n          \r\n          setIsLoading(false);\r\n          navigate(`/results?q=${encodeURIComponent(queryToUse)}`, {\r\n            state: {\r\n              results: searchResults,\r\n              dataSource: 'wihy',\r\n              fromSearch: true\r\n            }\r\n          });\r\n          return;\r\n        } else {\r\n          throw new Error('WiHy API returned invalid results');\r\n        }\r\n      } else {\r\n        throw new Error('WiHy API request failed');\r\n      }\r\n        \r\n      } catch (apiError) {\r\n        if (apiError.name === 'AbortError') {\r\n          console.log('API request was cancelled');\r\n          return;\r\n        }\r\n        console.error('Health search service failed:', apiError);\r\n        \r\n        setLoadingMessage('No results found. Please try a different search.');\r\n        setTimeout(() => {\r\n          setIsLoading(false);\r\n          setLoadingMessage('Searching...');\r\n        }, 3000);\r\n        return;\r\n      }\r\n        \r\n    } catch (error) {\r\n      if (error.name === 'AbortError') {\r\n        console.log('Search request was cancelled');\r\n        return;\r\n      }\r\n      \r\n      console.error(\"Search error:\", error);\r\n      setLoadingMessage('Search failed. Please try again.');\r\n      \r\n      setTimeout(() => {\r\n        setIsLoading(false);\r\n        setLoadingMessage('Searching...');\r\n      }, 2000);\r\n    }\r\n  };\r\n\r\n  /**\r\n   * SEARCH CANCELLATION HANDLER\r\n   */\r\n  const handleCancelSearch = () => {\r\n    if (abortControllerRef.current) {\r\n      abortControllerRef.current.abort();\r\n      abortControllerRef.current = null;\r\n    }\r\n    setIsLoading(false);\r\n    setLoadingMessage('Searching...');\r\n  };\r\n\r\n  /**\r\n   * IMAGE ANALYSIS COMPLETION HANDLER\r\n   */\r\n  const handleAnalysisComplete = async (foodName: string): Promise<void> => {\r\n    if (!foodName || isLoading) {\r\n      setIsUploadModalOpen(false);\r\n      return;\r\n    }\r\n\r\n    if (onSearchSubmit) {\r\n      onSearchSubmit(foodName);\r\n      setIsUploadModalOpen(false);\r\n      return;\r\n    }\r\n\r\n    // Use internal search logic\r\n    setInput(foodName);\r\n    await handleSearch(foodName);\r\n    setIsUploadModalOpen(false);\r\n  };\r\n\r\n  /**\r\n   * VOICE INPUT HANDLER\r\n   */\r\n  const handleVoiceInput = () => {\r\n    if (onVoiceInput) {\r\n      onVoiceInput();\r\n      return;\r\n    }\r\n\r\n    // Internal voice input logic\r\n    if (isLoading) return;\r\n    \r\n    if (!('webkitSpeechRecognition' in window)) {\r\n      alert('Speech recognition not supported in this browser');\r\n      return;\r\n    }\r\n\r\n    if (!recognitionRef.current) {\r\n      const recognition = new (window as any).webkitSpeechRecognition();\r\n      recognition.continuous = false;\r\n      recognition.interimResults = false;\r\n      recognition.lang = 'en-US';\r\n\r\n      recognition.onstart = () => setInternalIsListening(true);\r\n      recognition.onresult = (event: any) => {\r\n        const transcript = event.results[0][0].transcript;\r\n        setInput(transcript);\r\n        setInternalIsListening(false);\r\n      };\r\n      recognition.onerror = () => setInternalIsListening(false);\r\n      recognition.onend = () => setInternalIsListening(false);\r\n\r\n      recognitionRef.current = recognition;\r\n    }\r\n\r\n    if (!currentIsListening) {\r\n      recognitionRef.current.start();\r\n    } else {\r\n      recognitionRef.current.stop();\r\n      setInternalIsListening(false);\r\n    }\r\n  };\r\n\r\n  /**\r\n   * IMAGE UPLOAD HANDLER\r\n   */\r\n  const handleImageUpload = () => {\r\n    if (onImageUpload) {\r\n      onImageUpload();\r\n      return;\r\n    }\r\n    \r\n    // Internal image upload logic\r\n    setIsUploadModalOpen(true);\r\n  };\r\n\r\n  // ================================\r\n  // EVENT HANDLERS\r\n  // ================================\r\n  \r\n  // Update sizing when input changes\r\n  useEffect(() => {\r\n    autoSize();\r\n  }, [input]);\r\n  \r\n  // Handle input changes\r\n  const handleInputChange = (e: React.ChangeEvent<HTMLTextAreaElement>) => {\r\n    setInput(e.target.value);\r\n  };\r\n\r\n  const handleSubmit = (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    handleSearch();\r\n  };\r\n\r\n  const handleKeyDown = (e: React.KeyboardEvent) => {\r\n    if (e.key === 'Enter' && !e.shiftKey) {\r\n      e.preventDefault();\r\n      handleSubmit(e);\r\n    }\r\n  };\r\n\r\n  const handleLogoClick = () => {\r\n    if (onLogoClick) {\r\n      onLogoClick();\r\n    } else {\r\n      // Default behavior: navigate to home page\r\n      navigate('/');\r\n    }\r\n  };\r\n\r\n  // ================================\r\n  // LIFECYCLE HOOKS\r\n  // ================================\r\n\r\n  /**\r\n   * CLEANUP EFFECT\r\n   * Resets loading state when component unmounts\r\n   */\r\n  useEffect(() => {\r\n    return () => {\r\n      setIsLoading(false);\r\n      setLoadingMessage('Searching...');\r\n    };\r\n  }, []);\r\n\r\n  // ================================\r\n  // UI COMPONENTS\r\n  // ================================\r\n\r\n  /**\r\n   * LOADING OVERLAY COMPONENT\r\n   * Shows animated loading screen with progress bar during search operations\r\n   */\r\n  const LoadingOverlay: React.FC<{ message: string; progress: number }> = ({ message, progress }) => (\r\n    <div style={{\r\n      position: 'fixed',\r\n      top: 0,\r\n      left: 0,\r\n      right: 0,\r\n      bottom: 0,\r\n      backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n      display: 'flex',\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n      zIndex: 9999\r\n    }}>\r\n      <div style={{\r\n        backgroundColor: 'white',\r\n        borderRadius: '12px',\r\n        padding: '40px',\r\n        textAlign: 'center',\r\n        minWidth: '320px',\r\n        boxShadow: '0 10px 25px rgba(0, 0, 0, 0.2)'\r\n      }}>\r\n        {/* Spinner */}\r\n        <div style={{ margin: '0 auto 24px auto' }}>\r\n          <img \r\n            src=\"/assets/whatishealthyspinner.gif\" \r\n            alt=\"Loading...\" \r\n            style={{\r\n              width: '48px',\r\n              height: '48px',\r\n              objectFit: 'contain'\r\n            }}\r\n          />\r\n        </div>\r\n        \r\n        {/* Title */}\r\n        <h3 style={{\r\n          margin: '0 0 8px 0',\r\n          fontSize: '24px',\r\n          fontWeight: '600',\r\n          color: '#1f2937'\r\n        }}>\r\n          Loading Content\r\n        </h3>\r\n        \r\n        {/* Subtitle */}\r\n        <p style={{\r\n          margin: '0 0 24px 0',\r\n          fontSize: '16px',\r\n          color: '#6b7280'\r\n        }}>\r\n          Please wait while we process your request...\r\n        </p>\r\n        \r\n        {/* Progress Bar */}\r\n        <div style={{\r\n          width: '100%',\r\n          height: '8px',\r\n          backgroundColor: '#e5e7eb',\r\n          borderRadius: '4px',\r\n          overflow: 'hidden',\r\n          marginBottom: '12px'\r\n        }}>\r\n          <div style={{\r\n            width: `${progress}%`,\r\n            height: '100%',\r\n            backgroundColor: '#3b82f6',\r\n            borderRadius: '4px',\r\n            transition: 'width 0.3s ease'\r\n          }} />\r\n        </div>\r\n        \r\n        <div style={{\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          justifyContent: 'space-between',\r\n          marginTop: '16px'\r\n        }}>\r\n          <p style={{\r\n            margin: 0,\r\n            fontSize: '14px',\r\n            color: '#6b7280'\r\n          }}>\r\n            {progress}% Complete\r\n          </p>\r\n          \r\n          {/* Cancel button */}\r\n          <button\r\n            onClick={handleCancelSearch}\r\n            style={{\r\n              backgroundColor: 'transparent',\r\n              color: '#555',\r\n              border: '1px solid #ccc',\r\n              borderRadius: '16px',\r\n              padding: '8px 16px',\r\n              fontSize: '14px',\r\n              fontWeight: '500',\r\n              cursor: 'pointer',\r\n              transition: 'all 0.2s ease'\r\n            }}\r\n          >\r\n            Cancel\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  const headerClasses = `vhealth-header ${variant} ${className}`.trim();\r\n\r\n  return (\r\n    <>\r\n      {/* Ensure keyframes are available */}\r\n      <style>\r\n        {`\r\n          @keyframes wiH-border-sweep {\r\n            0%   { background-position: 0 0, 0% 0; }\r\n            100% { background-position: 0 0, 200% 0; }\r\n          }\r\n        `}\r\n      </style>\r\n      \r\n      {/* LOADING OVERLAY - Shows during search operations */}\r\n      {isLoading && (\r\n        <LoadingOverlay \r\n          message={loadingMessage}\r\n          progress={progressFromMessage(loadingMessage)}\r\n        />\r\n      )}\r\n\r\n      <header className={headerClasses}>\r\n        {/* === TOP BAR: Login only (no notifications for client) === */}\r\n        <div className=\"vhealth-topbar\">\r\n          <div className=\"vhealth-topbar-right\">\r\n            {showLogin && (\r\n              <div className=\"header-auth-wrapper\">\r\n                <MultiAuthLogin \r\n                  position=\"inline\"\r\n                  onUserChange={(user) => console.log('User changed in header:', user)}\r\n                  onSignIn={(user) => console.log('User signed in from header:', user)}\r\n                  onSignOut={() => console.log('User signed out from header')}\r\n                />\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* === MAIN BAR: Logo + Search === */}\r\n        <div className=\"vhealth-mainbar\">\r\n          {/* Logo Section */}\r\n          <div className=\"vhealth-logo-container\">\r\n            <img\r\n              src=\"/assets/wihylogo.png\"\r\n              alt=\"What is Healthy?\"\r\n              className={`vhealth-logo ${variant}-logo`}\r\n              onClick={handleLogoClick}\r\n              style={{ cursor: onLogoClick ? 'pointer' : 'default' }}\r\n            />\r\n          </div>\r\n\r\n          {/* Search Input Section */}\r\n          {showSearchInput && (\r\n            <div className=\"vhealth-search-section\">\r\n              <form className=\"vhealth-search-form\" onSubmit={handleSubmit}>\r\n                <div \r\n                  className=\"search-input-container\"\r\n                  style={{\r\n                    animation: 'wiH-border-sweep 2.2s linear infinite !important',\r\n                    background: `\r\n                      linear-gradient(#fff, #fff) padding-box,\r\n                      linear-gradient(90deg, #fa5f06, #ffffff, #C0C0C0, #4cbb17, #1a73e8) border-box\r\n                    `,\r\n                    backgroundSize: '100% 100%, 200% 100%',\r\n                    border: '2px solid transparent',\r\n                    borderRadius: '24px',\r\n                    position: 'relative',\r\n                    width: '100%',\r\n                    maxWidth: '800px',\r\n                    margin: '0 auto',\r\n                    boxShadow: '0 1px 6px rgba(32,33,36,0.28)'\r\n                  }}\r\n                >\r\n                  <textarea\r\n                    ref={searchInputRef}\r\n                    value={input}\r\n                    onChange={handleInputChange}\r\n                    onKeyDown={handleKeyDown}\r\n                    placeholder=\"Ask anything about health...\"\r\n                    className=\"search-input\"\r\n                    disabled={isLoading}\r\n                    rows={1}\r\n                    style={{\r\n                      resize: 'none',\r\n                      overflow: 'hidden',\r\n                      minHeight: '44px',\r\n                      height: 'auto',\r\n                      paddingRight: '100px'\r\n                    }}\r\n                  />\r\n\r\n                  <div className=\"search-icons\">\r\n                    {input && (\r\n                      <button\r\n                        type=\"button\"\r\n                        className=\"icon-button clear-button\"\r\n                        onClick={clearInput}\r\n                        title=\"Clear\"\r\n                      >\r\n                        <svg viewBox=\"0 0 24 24\" width=\"16\" height=\"16\">\r\n                          <path d=\"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z\"/>\r\n                        </svg>\r\n                      </button>\r\n                    )}\r\n\r\n                    <button\r\n                      type=\"button\"\r\n                      className=\"icon-button\"\r\n                      onClick={handleImageUpload}\r\n                      title=\"Upload image\"\r\n                      disabled={isLoading}\r\n                    >\r\n                      <svg viewBox=\"0 0 24 24\" width=\"20\" height=\"20\" fill=\"currentColor\">\r\n                        <path d=\"M9 2L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2H9zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5z\"/>\r\n                      </svg>\r\n                    </button>\r\n\r\n                    <button\r\n                      type=\"button\"\r\n                      className={`icon-button ${currentIsListening ? 'listening' : ''}`}\r\n                      onClick={handleVoiceInput}\r\n                      title={currentIsListening ? 'Stop listening' : 'Start voice input'}\r\n                      disabled={isLoading}\r\n                    >\r\n                      <svg viewBox=\"0 0 24 24\" width=\"20\" height=\"20\" fill=\"currentColor\">\r\n                        <path d=\"M12 14c1.66 0 2.99-1.34 2.99-3L15 5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.48 6-3.3 6-6.72h-1.7z\"/>\r\n                      </svg>\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              </form>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </header>\r\n\r\n    {/* IMAGE UPLOAD MODAL - Opens when camera button is clicked */}\r\n    <ImageUploadModal\r\n      isOpen={isUploadModalOpen}\r\n      onClose={() => setIsUploadModalOpen(false)}\r\n      onAnalysisComplete={handleAnalysisComplete}\r\n      title=\"Upload Image\"\r\n      subtitle=\"Upload Image for Analysis\"\r\n    />\r\n  </>\r\n  );\r\n};\r\n\r\nexport default Header;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}