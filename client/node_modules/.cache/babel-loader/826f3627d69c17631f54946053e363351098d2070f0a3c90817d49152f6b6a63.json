{"ast":null,"code":"var _jsxFileName = \"C:\\\\repo\\\\wihy_ui\\\\client\\\\src\\\\components\\\\ChatWidget.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef, useEffect } from 'react';\nimport { wihyAPI } from '../services/wihyAPI';\nimport { logger } from '../utils/logger';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ChatWidget = ({\n  isOpen,\n  onToggle,\n  onClose,\n  currentContext,\n  inline = false,\n  externalMessage\n}) => {\n  _s();\n  const [messages, setMessages] = useState([{\n    id: '1',\n    type: 'assistant',\n    message: 'Hi! I\\'m your health assistant. I can help explain your dashboard data and answer questions about your health metrics. What would you like to know?',\n    timestamp: new Date()\n  }]);\n  const [inputMessage, setInputMessage] = useState('');\n  const [isTyping, setIsTyping] = useState(false);\n  const messagesEndRef = useRef(null);\n  const scrollToBottom = () => {\n    var _messagesEndRef$curre;\n    (_messagesEndRef$curre = messagesEndRef.current) === null || _messagesEndRef$curre === void 0 ? void 0 : _messagesEndRef$curre.scrollIntoView({\n      behavior: 'smooth'\n    });\n  };\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  // Add external message when provided\n  useEffect(() => {\n    if (externalMessage && isOpen) {\n      const userMessage = {\n        id: Date.now().toString(),\n        type: 'user',\n        message: externalMessage.query,\n        timestamp: new Date()\n      };\n      const assistantMessage = {\n        id: (Date.now() + 1).toString(),\n        type: 'assistant',\n        message: externalMessage.response,\n        timestamp: new Date()\n      };\n\n      // Replace existing messages with the external conversation\n      setMessages([{\n        id: '1',\n        type: 'assistant',\n        message: 'Hi! I\\'m your health assistant. I can help explain your dashboard data and answer questions about your health metrics. What would you like to know?',\n        timestamp: new Date()\n      }, userMessage, assistantMessage]);\n    }\n  }, [externalMessage, isOpen]);\n\n  // Add contextual message when context changes (but not when external message is provided)\n  useEffect(() => {\n    if (currentContext && isOpen && !externalMessage) {\n      const contextualMessage = {\n        id: Date.now().toString(),\n        type: 'assistant',\n        message: `I see you're looking at your ${currentContext}. I can help explain these metrics, identify trends, or answer any questions about this data. What would you like to know?`,\n        timestamp: new Date(),\n        context: currentContext\n      };\n\n      // Only add if it's not the same as the last message\n      setMessages(prev => {\n        const lastMessage = prev[prev.length - 1];\n        if ((lastMessage === null || lastMessage === void 0 ? void 0 : lastMessage.context) === currentContext) {\n          return prev; // Don't duplicate context messages\n        }\n        return [...prev, contextualMessage];\n      });\n    }\n  }, [currentContext, isOpen, externalMessage]);\n  const handleSendMessage = async () => {\n    if (!inputMessage.trim()) return;\n    const userMessage = {\n      id: Date.now().toString(),\n      type: 'user',\n      message: inputMessage.trim(),\n      timestamp: new Date(),\n      context: currentContext\n    };\n    setMessages(prev => [...prev, userMessage]);\n    setInputMessage('');\n    setIsTyping(true);\n    try {\n      // Use WiHy API for chat responses\n      logger.debug('ChatWidget: Making WiHy API request for:', inputMessage.trim());\n      const wihyResponse = await wihyAPI.searchHealth(inputMessage.trim(), {\n        // Add context if available\n        health_concerns: currentContext ? [currentContext] : undefined\n      });\n      logger.debug('ChatWidget: WiHy API full response:', wihyResponse);\n      let responseMessage = 'I apologize, but I encountered an issue processing your request. Please try again.';\n      if (wihyResponse.success && wihyResponse.data) {\n        const data = wihyResponse.data;\n\n        // Try multiple response locations to handle different API formats\n        if (data.ai_response && data.ai_response.response) {\n          // New unified API format - enhanced conversational response\n          responseMessage = data.ai_response.response;\n          logger.debug('ChatWidget: Using ai_response.response field from unified API');\n        } else if (data.response) {\n          // Direct response field (could be JSON string or plain text)\n          let parsedResponse = data.response;\n\n          // Try to parse if it's a JSON string\n          if (typeof data.response === 'string') {\n            try {\n              const parsed = JSON.parse(data.response.replace(/'/g, '\"'));\n              if (parsed && typeof parsed === 'object') {\n                // Extract meaningful content from parsed object\n                parsedResponse = parsed.core_principle || parsed.message || data.response;\n              }\n            } catch (e) {\n              // If parsing fails, use the raw string\n              parsedResponse = data.response;\n            }\n          }\n          responseMessage = parsedResponse;\n          logger.debug('ChatWidget: Using direct response field from API');\n        } else if (wihyResponse.wihy_response) {\n          // Legacy WiHy format\n          const wihyResp = wihyResponse.wihy_response;\n          responseMessage = wihyResp.core_principle || wihyResp.message || 'Health information provided';\n          logger.debug('ChatWidget: Using legacy wihy_response format');\n        } else if (wihyResponse.message) {\n          // Simple message format\n          responseMessage = wihyResponse.message;\n          logger.debug('ChatWidget: Using message field from API');\n        } else {\n          logger.warn('ChatWidget: No recognizable response field found in API data');\n          responseMessage = generateContextualResponse(inputMessage.trim(), currentContext);\n        }\n        logger.debug('ChatWidget: Final response message:', responseMessage);\n      } else {\n        logger.warn('ChatWidget: WiHy API request failed or no data');\n        // Fallback to contextual response\n        responseMessage = generateContextualResponse(inputMessage.trim(), currentContext);\n      }\n      const assistantMessage = {\n        id: (Date.now() + 1).toString(),\n        type: 'assistant',\n        message: responseMessage,\n        timestamp: new Date()\n      };\n      setMessages(prev => [...prev, assistantMessage]);\n      setIsTyping(false);\n    } catch (error) {\n      logger.error('ChatWidget: Error getting AI response:', error);\n\n      // Fallback to contextual response on error\n      const fallbackMessage = generateContextualResponse(inputMessage.trim(), currentContext);\n      const assistantMessage = {\n        id: (Date.now() + 1).toString(),\n        type: 'assistant',\n        message: fallbackMessage,\n        timestamp: new Date()\n      };\n      setMessages(prev => [...prev, assistantMessage]);\n      setIsTyping(false);\n    }\n  };\n  const generateContextualResponse = (question, context) => {\n    const lowerQuestion = question.toLowerCase();\n\n    // Context-aware responses based on current dashboard section\n    if (context !== null && context !== void 0 && context.includes('nutrition') || context !== null && context !== void 0 && context.includes('food')) {\n      if (lowerQuestion.includes('calories') || lowerQuestion.includes('nutrition')) {\n        return 'Based on your search results, I can help you understand the nutritional information. The data shows detailed breakdowns of calories, macronutrients, and other important dietary factors. Would you like me to explain any specific nutritional values?';\n      }\n      if (lowerQuestion.includes('protein') || lowerQuestion.includes('carb') || lowerQuestion.includes('fat')) {\n        return 'I can help you understand the macronutrient breakdown in your search results. The nutrition data shows the distribution of proteins, carbohydrates, and fats. Would you like specific recommendations for optimizing these ratios?';\n      }\n    }\n    if (context !== null && context !== void 0 && context.includes('search') || context !== null && context !== void 0 && context.includes('results')) {\n      if (lowerQuestion.includes('quality') || lowerQuestion.includes('reliable')) {\n        return 'The search results quality chart shows how reliable and comprehensive the information is. It takes into account factors like source credibility, data completeness, and scientific backing. What specific aspect of the results would you like me to explain?';\n      }\n      if (lowerQuestion.includes('chart') || lowerQuestion.includes('graph')) {\n        return 'The charts on the right show different aspects of your search results - including result quality metrics and nutritional breakdowns when applicable. Which chart would you like me to explain in detail?';\n      }\n    }\n\n    // General health responses\n    if (lowerQuestion.includes('help') || lowerQuestion.includes('what can you do')) {\n      return \"I can help you with:\\n• Understanding your search results and health information\\n• Explaining charts and data visualizations\\n• Providing context about nutritional data\\n• Answering questions about health topics\\n• Suggesting related information to explore\\n\\nWhat would you like to know more about?\";\n    }\n    if (lowerQuestion.includes('nutrition') || lowerQuestion.includes('food') || lowerQuestion.includes('diet')) {\n      return \"I can analyze nutritional data from your search results and help you understand dietary information. I can explain calories, macronutrients, vitamins, and suggest improvements. What specific nutrition question do you have?\";\n    }\n    if (lowerQuestion.includes('health') || lowerQuestion.includes('wellness')) {\n      return \"I can help you understand the health information in your search results. I can explain medical terms, provide context for health metrics, and offer evidence-based insights. What health topic interests you most?\";\n    }\n    if (lowerQuestion.includes('recommend') || lowerQuestion.includes('suggest') || lowerQuestion.includes('advice')) {\n      return \"Based on your search results, I can provide personalized recommendations and insights. I can suggest related topics to explore, explain complex information, or help you understand how to apply this information. What area would you like recommendations for?\";\n    }\n\n    // Default responses\n    const defaultResponses = [\"I'm here to help you understand your search results! Could you tell me more about what specific aspect you'd like to explore?\", \"I can provide insights about your health search results. What would you like to know more about?\", \"Great question! I can help explain the information in your search results. Could you be more specific about what you're looking for?\", \"I'd love to help you with that. Which part of the search results or health information would you like me to explain?\"];\n    return defaultResponses[Math.floor(Math.random() * defaultResponses.length)];\n  };\n  const handleKeyPress = e => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleSendMessage();\n    }\n  };\n  const formatTime = date => {\n    return date.toLocaleTimeString([], {\n      hour: '2-digit',\n      minute: '2-digit'\n    });\n  };\n  if (!isOpen) {\n    return null; // Don't show toggle button when closed\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"chat-widget\",\n    style: {\n      position: inline ? 'relative' : 'fixed',\n      left: inline ? 'auto' : '0',\n      top: inline ? 'auto' : '0',\n      width: inline ? '100%' : '350px',\n      height: inline ? '100%' : '100vh',\n      backgroundColor: 'white',\n      borderRight: inline ? 'none' : '1px solid #e5e7eb',\n      border: inline ? '1px solid #e5e7eb' : 'none',\n      borderRadius: inline ? '8px' : '0',\n      display: 'flex',\n      flexDirection: 'column',\n      zIndex: inline ? 'auto' : 1000,\n      fontFamily: 'system-ui, -apple-system, sans-serif',\n      animation: inline ? 'none' : 'slideInFromLeft 0.3s ease-out',\n      boxShadow: inline ? 'none' : '4px 0 12px rgba(0, 0, 0, 0.1)'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        padding: inline ? '16px 20px' : '20px 24px',\n        borderBottom: '1px solid #e5e7eb',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'space-between',\n        backgroundColor: '#ffffff'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          alignItems: 'center',\n          gap: '12px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: \"/assets/wihyfavicon.png\",\n          alt: \"WiHy Assistant\",\n          style: {\n            width: '32px',\n            height: '32px',\n            borderRadius: '50%',\n            border: '2px solid #e5e7eb',\n            backgroundColor: 'white',\n            padding: '4px'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 296,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontWeight: '600',\n              fontSize: '14px',\n              color: '#1f2937'\n            },\n            children: \"WiHy Health Assistant\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 309,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontSize: '12px',\n              color: '#6b7280'\n            },\n            children: currentContext ? `Analyzing: ${currentContext}` : 'Online • Ready to help'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 312,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 308,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 295,\n        columnNumber: 9\n      }, this), !inline && /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: onClose,\n        style: {\n          background: 'none',\n          border: 'none',\n          cursor: 'pointer',\n          padding: '4px',\n          borderRadius: '4px',\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center'\n        },\n        children: /*#__PURE__*/_jsxDEV(\"svg\", {\n          width: \"20\",\n          height: \"20\",\n          viewBox: \"0 0 24 24\",\n          fill: \"#6b7280\",\n          children: /*#__PURE__*/_jsxDEV(\"path\", {\n            d: \"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 332,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 331,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 318,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 287,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        flex: 1,\n        overflow: 'auto',\n        padding: inline ? '12px 16px' : '16px',\n        display: 'flex',\n        flexDirection: 'column',\n        gap: '12px'\n      },\n      children: [messages.map(message => /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          flexDirection: message.type === 'user' ? 'row-reverse' : 'row',\n          gap: '8px',\n          alignItems: 'flex-start'\n        },\n        children: [message.type === 'user' ? /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            width: '28px',\n            height: '28px',\n            borderRadius: '50%',\n            backgroundColor: '#10b981',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            color: 'white',\n            fontSize: '12px',\n            fontWeight: 'bold',\n            flexShrink: 0\n          },\n          children: \"U\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 358,\n          columnNumber: 15\n        }, this) : /*#__PURE__*/_jsxDEV(\"img\", {\n          src: \"/assets/wihyfavicon.png\",\n          alt: \"WiHy\",\n          style: {\n            width: '28px',\n            height: '28px',\n            borderRadius: '50%',\n            border: '1px solid #e5e7eb',\n            backgroundColor: 'white',\n            padding: '2px',\n            flexShrink: 0\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 374,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            maxWidth: '75%',\n            display: 'flex',\n            flexDirection: 'column',\n            gap: '4px'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              backgroundColor: message.type === 'user' ? '#10b981' : '#f3f4f6',\n              color: message.type === 'user' ? 'white' : '#1f2937',\n              padding: '12px 16px',\n              borderRadius: message.type === 'user' ? '18px 18px 4px 18px' : '18px 18px 18px 4px',\n              fontSize: '14px',\n              lineHeight: '1.4'\n            },\n            children: message.message\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 394,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontSize: '11px',\n              color: '#9ca3af',\n              textAlign: message.type === 'user' ? 'right' : 'left',\n              paddingLeft: message.type === 'user' ? '0' : '16px',\n              paddingRight: message.type === 'user' ? '16px' : '0'\n            },\n            children: [formatTime(message.timestamp), message.context && /*#__PURE__*/_jsxDEV(\"span\", {\n              style: {\n                marginLeft: '8px',\n                fontStyle: 'italic'\n              },\n              children: [\"\\u2022 viewing \", message.context]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 413,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 404,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 388,\n          columnNumber: 13\n        }, this)]\n      }, message.id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 348,\n        columnNumber: 11\n      }, this)), isTyping && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          gap: '8px',\n          alignItems: 'flex-start'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            width: '28px',\n            height: '28px',\n            borderRadius: '50%',\n            backgroundColor: '#1a73e8',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            color: 'white',\n            fontSize: '12px',\n            fontWeight: 'bold'\n          },\n          children: \"WH\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 428,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            backgroundColor: '#f3f4f6',\n            padding: '12px 16px',\n            borderRadius: '18px 18px 18px 4px',\n            display: 'flex',\n            gap: '4px',\n            alignItems: 'center'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              width: '6px',\n              height: '6px',\n              borderRadius: '50%',\n              backgroundColor: '#9ca3af',\n              animation: 'typing 1.5s ease-in-out infinite'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 450,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              width: '6px',\n              height: '6px',\n              borderRadius: '50%',\n              backgroundColor: '#9ca3af',\n              animation: 'typing 1.5s ease-in-out infinite 0.2s'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 457,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              width: '6px',\n              height: '6px',\n              borderRadius: '50%',\n              backgroundColor: '#9ca3af',\n              animation: 'typing 1.5s ease-in-out infinite 0.4s'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 464,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 442,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 423,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        ref: messagesEndRef\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 475,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 339,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        padding: '16px',\n        borderTop: '1px solid #f3f4f6',\n        backgroundColor: '#fafbfc'\n      },\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          gap: '8px',\n          alignItems: 'flex-end'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n          value: inputMessage,\n          onChange: e => setInputMessage(e.target.value),\n          onKeyPress: handleKeyPress,\n          placeholder: \"Ask about your health data...\",\n          style: {\n            flex: 1,\n            border: '1px solid #d1d5db',\n            borderRadius: '12px',\n            padding: '12px 16px',\n            fontSize: '14px',\n            resize: 'none',\n            minHeight: '20px',\n            maxHeight: '80px',\n            fontFamily: 'inherit',\n            outline: 'none'\n          },\n          rows: 1\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 489,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleSendMessage,\n          disabled: !inputMessage.trim() || isTyping,\n          style: {\n            backgroundColor: inputMessage.trim() ? '#1a73e8' : '#d1d5db',\n            color: 'white',\n            border: 'none',\n            borderRadius: '12px',\n            padding: '12px',\n            cursor: inputMessage.trim() ? 'pointer' : 'not-allowed',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            transition: 'background-color 0.2s ease'\n          },\n          children: /*#__PURE__*/_jsxDEV(\"svg\", {\n            width: \"16\",\n            height: \"16\",\n            viewBox: \"0 0 24 24\",\n            fill: \"currentColor\",\n            children: /*#__PURE__*/_jsxDEV(\"path\", {\n              d: \"M2.01 21L23 12 2.01 3 2 10l15 2-15 2z\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 525,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 524,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 508,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 484,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 479,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"style\", {\n      children: `\n        @keyframes typing {\n          0%, 60%, 100% {\n            transform: translateY(0);\n            opacity: 0.4;\n          }\n          30% {\n            transform: translateY(-10px);\n            opacity: 1;\n          }\n        }\n      `\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 531,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 266,\n    columnNumber: 5\n  }, this);\n};\n_s(ChatWidget, \"61GZBb3haDVcAfV/7l7QvdgLfFs=\");\n_c = ChatWidget;\nexport default ChatWidget;\nvar _c;\n$RefreshReg$(_c, \"ChatWidget\");","map":{"version":3,"names":["React","useState","useRef","useEffect","wihyAPI","logger","jsxDEV","_jsxDEV","ChatWidget","isOpen","onToggle","onClose","currentContext","inline","externalMessage","_s","messages","setMessages","id","type","message","timestamp","Date","inputMessage","setInputMessage","isTyping","setIsTyping","messagesEndRef","scrollToBottom","_messagesEndRef$curre","current","scrollIntoView","behavior","userMessage","now","toString","query","assistantMessage","response","contextualMessage","context","prev","lastMessage","length","handleSendMessage","trim","debug","wihyResponse","searchHealth","health_concerns","undefined","responseMessage","success","data","ai_response","parsedResponse","parsed","JSON","parse","replace","core_principle","e","wihy_response","wihyResp","warn","generateContextualResponse","error","fallbackMessage","question","lowerQuestion","toLowerCase","includes","defaultResponses","Math","floor","random","handleKeyPress","key","shiftKey","preventDefault","formatTime","date","toLocaleTimeString","hour","minute","className","style","position","left","top","width","height","backgroundColor","borderRight","border","borderRadius","display","flexDirection","zIndex","fontFamily","animation","boxShadow","children","padding","borderBottom","alignItems","justifyContent","gap","src","alt","fileName","_jsxFileName","lineNumber","columnNumber","fontWeight","fontSize","color","onClick","background","cursor","viewBox","fill","d","flex","overflow","map","flexShrink","maxWidth","lineHeight","textAlign","paddingLeft","paddingRight","marginLeft","fontStyle","ref","borderTop","value","onChange","target","onKeyPress","placeholder","resize","minHeight","maxHeight","outline","rows","disabled","transition","_c","$RefreshReg$"],"sources":["C:/repo/wihy_ui/client/src/components/ChatWidget.tsx"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\r\nimport { wihyAPI } from '../services/wihyAPI';\r\nimport { logger } from '../utils/logger';\r\n\r\ninterface ChatMessage {\r\n  id: string;\r\n  type: 'user' | 'assistant';\r\n  message: string;\r\n  timestamp: Date;\r\n  context?: string; // What the user was viewing when they asked\r\n}\r\n\r\ninterface ChatWidgetProps {\r\n  isOpen: boolean;\r\n  onToggle: () => void;\r\n  onClose: () => void;\r\n  currentContext?: string; // Current dashboard section being viewed\r\n  inline?: boolean; // Whether to render inline or as fixed overlay\r\n  externalMessage?: { query: string; response: string } | null; // External message to add\r\n}\r\n\r\nconst ChatWidget: React.FC<ChatWidgetProps> = ({ isOpen, onToggle, onClose, currentContext, inline = false, externalMessage }) => {\r\n  const [messages, setMessages] = useState<ChatMessage[]>([\r\n    {\r\n      id: '1',\r\n      type: 'assistant',\r\n      message: 'Hi! I\\'m your health assistant. I can help explain your dashboard data and answer questions about your health metrics. What would you like to know?',\r\n      timestamp: new Date()\r\n    }\r\n  ]);\r\n  const [inputMessage, setInputMessage] = useState('');\r\n  const [isTyping, setIsTyping] = useState(false);\r\n  const messagesEndRef = useRef<HTMLDivElement>(null);\r\n\r\n  const scrollToBottom = () => {\r\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\r\n  };\r\n\r\n  useEffect(() => {\r\n    scrollToBottom();\r\n  }, [messages]);\r\n\r\n  // Add external message when provided\r\n  useEffect(() => {\r\n    if (externalMessage && isOpen) {\r\n      const userMessage: ChatMessage = {\r\n        id: Date.now().toString(),\r\n        type: 'user',\r\n        message: externalMessage.query,\r\n        timestamp: new Date()\r\n      };\r\n      \r\n      const assistantMessage: ChatMessage = {\r\n        id: (Date.now() + 1).toString(),\r\n        type: 'assistant',\r\n        message: externalMessage.response,\r\n        timestamp: new Date()\r\n      };\r\n      \r\n      // Replace existing messages with the external conversation\r\n      setMessages([\r\n        {\r\n          id: '1',\r\n          type: 'assistant',\r\n          message: 'Hi! I\\'m your health assistant. I can help explain your dashboard data and answer questions about your health metrics. What would you like to know?',\r\n          timestamp: new Date()\r\n        },\r\n        userMessage,\r\n        assistantMessage\r\n      ]);\r\n    }\r\n  }, [externalMessage, isOpen]);\r\n\r\n  // Add contextual message when context changes (but not when external message is provided)\r\n  useEffect(() => {\r\n    if (currentContext && isOpen && !externalMessage) {\r\n      const contextualMessage: ChatMessage = {\r\n        id: Date.now().toString(),\r\n        type: 'assistant',\r\n        message: `I see you're looking at your ${currentContext}. I can help explain these metrics, identify trends, or answer any questions about this data. What would you like to know?`,\r\n        timestamp: new Date(),\r\n        context: currentContext\r\n      };\r\n      \r\n      // Only add if it's not the same as the last message\r\n      setMessages(prev => {\r\n        const lastMessage = prev[prev.length - 1];\r\n        if (lastMessage?.context === currentContext) {\r\n          return prev; // Don't duplicate context messages\r\n        }\r\n        return [...prev, contextualMessage];\r\n      });\r\n    }\r\n  }, [currentContext, isOpen, externalMessage]);\r\n\r\n  const handleSendMessage = async () => {\r\n    if (!inputMessage.trim()) return;\r\n\r\n    const userMessage: ChatMessage = {\r\n      id: Date.now().toString(),\r\n      type: 'user',\r\n      message: inputMessage.trim(),\r\n      timestamp: new Date(),\r\n      context: currentContext\r\n    };\r\n\r\n    setMessages(prev => [...prev, userMessage]);\r\n    setInputMessage('');\r\n    setIsTyping(true);\r\n\r\n    try {\r\n      // Use WiHy API for chat responses\r\n      logger.debug('ChatWidget: Making WiHy API request for:', inputMessage.trim());\r\n      \r\n      const wihyResponse = await wihyAPI.searchHealth(inputMessage.trim(), {\r\n        // Add context if available\r\n        health_concerns: currentContext ? [currentContext] : undefined\r\n      });\r\n\r\n      logger.debug('ChatWidget: WiHy API full response:', wihyResponse);\r\n\r\n      let responseMessage = 'I apologize, but I encountered an issue processing your request. Please try again.';\r\n\r\n      if (wihyResponse.success && (wihyResponse as any).data) {\r\n        const data = (wihyResponse as any).data;\r\n        \r\n        // Try multiple response locations to handle different API formats\r\n        if (data.ai_response && data.ai_response.response) {\r\n          // New unified API format - enhanced conversational response\r\n          responseMessage = data.ai_response.response;\r\n          logger.debug('ChatWidget: Using ai_response.response field from unified API');\r\n        } else if (data.response) {\r\n          // Direct response field (could be JSON string or plain text)\r\n          let parsedResponse = data.response;\r\n          \r\n          // Try to parse if it's a JSON string\r\n          if (typeof data.response === 'string') {\r\n            try {\r\n              const parsed = JSON.parse(data.response.replace(/'/g, '\"'));\r\n              if (parsed && typeof parsed === 'object') {\r\n                // Extract meaningful content from parsed object\r\n                parsedResponse = parsed.core_principle || parsed.message || data.response;\r\n              }\r\n            } catch (e) {\r\n              // If parsing fails, use the raw string\r\n              parsedResponse = data.response;\r\n            }\r\n          }\r\n          \r\n          responseMessage = parsedResponse;\r\n          logger.debug('ChatWidget: Using direct response field from API');\r\n        } else if ((wihyResponse as any).wihy_response) {\r\n          // Legacy WiHy format\r\n          const wihyResp = (wihyResponse as any).wihy_response;\r\n          responseMessage = wihyResp.core_principle || wihyResp.message || 'Health information provided';\r\n          logger.debug('ChatWidget: Using legacy wihy_response format');\r\n        } else if ((wihyResponse as any).message) {\r\n          // Simple message format\r\n          responseMessage = (wihyResponse as any).message;\r\n          logger.debug('ChatWidget: Using message field from API');\r\n        } else {\r\n          logger.warn('ChatWidget: No recognizable response field found in API data');\r\n          responseMessage = generateContextualResponse(inputMessage.trim(), currentContext);\r\n        }\r\n        \r\n        logger.debug('ChatWidget: Final response message:', responseMessage);\r\n      } else {\r\n        logger.warn('ChatWidget: WiHy API request failed or no data');\r\n        // Fallback to contextual response\r\n        responseMessage = generateContextualResponse(inputMessage.trim(), currentContext);\r\n      }\r\n\r\n      const assistantMessage: ChatMessage = {\r\n        id: (Date.now() + 1).toString(),\r\n        type: 'assistant',\r\n        message: responseMessage,\r\n        timestamp: new Date()\r\n      };\r\n\r\n      setMessages(prev => [...prev, assistantMessage]);\r\n      setIsTyping(false);\r\n    } catch (error) {\r\n      logger.error('ChatWidget: Error getting AI response:', error);\r\n\r\n      // Fallback to contextual response on error\r\n      const fallbackMessage = generateContextualResponse(inputMessage.trim(), currentContext);\r\n      \r\n      const assistantMessage: ChatMessage = {\r\n        id: (Date.now() + 1).toString(),\r\n        type: 'assistant',\r\n        message: fallbackMessage,\r\n        timestamp: new Date()\r\n      };\r\n\r\n      setMessages(prev => [...prev, assistantMessage]);\r\n      setIsTyping(false);\r\n    }\r\n  };\r\n\r\n  const generateContextualResponse = (question: string, context?: string): string => {\r\n    const lowerQuestion = question.toLowerCase();\r\n    \r\n    // Context-aware responses based on current dashboard section\r\n    if (context?.includes('nutrition') || context?.includes('food')) {\r\n      if (lowerQuestion.includes('calories') || lowerQuestion.includes('nutrition')) {\r\n        return 'Based on your search results, I can help you understand the nutritional information. The data shows detailed breakdowns of calories, macronutrients, and other important dietary factors. Would you like me to explain any specific nutritional values?';\r\n      }\r\n      if (lowerQuestion.includes('protein') || lowerQuestion.includes('carb') || lowerQuestion.includes('fat')) {\r\n        return 'I can help you understand the macronutrient breakdown in your search results. The nutrition data shows the distribution of proteins, carbohydrates, and fats. Would you like specific recommendations for optimizing these ratios?';\r\n      }\r\n    }\r\n    \r\n    if (context?.includes('search') || context?.includes('results')) {\r\n      if (lowerQuestion.includes('quality') || lowerQuestion.includes('reliable')) {\r\n        return 'The search results quality chart shows how reliable and comprehensive the information is. It takes into account factors like source credibility, data completeness, and scientific backing. What specific aspect of the results would you like me to explain?';\r\n      }\r\n      if (lowerQuestion.includes('chart') || lowerQuestion.includes('graph')) {\r\n        return 'The charts on the right show different aspects of your search results - including result quality metrics and nutritional breakdowns when applicable. Which chart would you like me to explain in detail?';\r\n      }\r\n    }\r\n\r\n    // General health responses\r\n    if (lowerQuestion.includes('help') || lowerQuestion.includes('what can you do')) {\r\n      return \"I can help you with:\\n• Understanding your search results and health information\\n• Explaining charts and data visualizations\\n• Providing context about nutritional data\\n• Answering questions about health topics\\n• Suggesting related information to explore\\n\\nWhat would you like to know more about?\";\r\n    }\r\n    \r\n    if (lowerQuestion.includes('nutrition') || lowerQuestion.includes('food') || lowerQuestion.includes('diet')) {\r\n      return \"I can analyze nutritional data from your search results and help you understand dietary information. I can explain calories, macronutrients, vitamins, and suggest improvements. What specific nutrition question do you have?\";\r\n    }\r\n    \r\n    if (lowerQuestion.includes('health') || lowerQuestion.includes('wellness')) {\r\n      return \"I can help you understand the health information in your search results. I can explain medical terms, provide context for health metrics, and offer evidence-based insights. What health topic interests you most?\";\r\n    }\r\n    \r\n    if (lowerQuestion.includes('recommend') || lowerQuestion.includes('suggest') || lowerQuestion.includes('advice')) {\r\n      return \"Based on your search results, I can provide personalized recommendations and insights. I can suggest related topics to explore, explain complex information, or help you understand how to apply this information. What area would you like recommendations for?\";\r\n    }\r\n\r\n    // Default responses\r\n    const defaultResponses = [\r\n      \"I'm here to help you understand your search results! Could you tell me more about what specific aspect you'd like to explore?\",\r\n      \"I can provide insights about your health search results. What would you like to know more about?\",\r\n      \"Great question! I can help explain the information in your search results. Could you be more specific about what you're looking for?\",\r\n      \"I'd love to help you with that. Which part of the search results or health information would you like me to explain?\"\r\n    ];\r\n    \r\n    return defaultResponses[Math.floor(Math.random() * defaultResponses.length)];\r\n  };\r\n\r\n  const handleKeyPress = (e: React.KeyboardEvent) => {\r\n    if (e.key === 'Enter' && !e.shiftKey) {\r\n      e.preventDefault();\r\n      handleSendMessage();\r\n    }\r\n  };\r\n\r\n  const formatTime = (date: Date) => {\r\n    return date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\r\n  };\r\n\r\n  if (!isOpen) {\r\n    return null; // Don't show toggle button when closed\r\n  }\r\n\r\n  return (\r\n    <div \r\n      className=\"chat-widget\"\r\n      style={{\r\n        position: inline ? 'relative' : 'fixed',\r\n        left: inline ? 'auto' : '0',\r\n        top: inline ? 'auto' : '0',\r\n        width: inline ? '100%' : '350px',\r\n        height: inline ? '100%' : '100vh',\r\n        backgroundColor: 'white',\r\n        borderRight: inline ? 'none' : '1px solid #e5e7eb',\r\n        border: inline ? '1px solid #e5e7eb' : 'none',\r\n        borderRadius: inline ? '8px' : '0',\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        zIndex: inline ? 'auto' : 1000,\r\n        fontFamily: 'system-ui, -apple-system, sans-serif',\r\n        animation: inline ? 'none' : 'slideInFromLeft 0.3s ease-out',\r\n        boxShadow: inline ? 'none' : '4px 0 12px rgba(0, 0, 0, 0.1)'\r\n      }}\r\n    >\r\n      {/* Header */}\r\n      <div style={{\r\n        padding: inline ? '16px 20px' : '20px 24px',\r\n        borderBottom: '1px solid #e5e7eb',\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        justifyContent: 'space-between',\r\n        backgroundColor: '#ffffff'\r\n      }}>\r\n        <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>\r\n          <img \r\n            src=\"/assets/wihyfavicon.png\" \r\n            alt=\"WiHy Assistant\"\r\n            style={{\r\n              width: '32px',\r\n              height: '32px',\r\n              borderRadius: '50%',\r\n              border: '2px solid #e5e7eb',\r\n              backgroundColor: 'white',\r\n              padding: '4px'\r\n            }}\r\n          />\r\n          <div>\r\n            <div style={{ fontWeight: '600', fontSize: '14px', color: '#1f2937' }}>\r\n              WiHy Health Assistant\r\n            </div>\r\n            <div style={{ fontSize: '12px', color: '#6b7280' }}>\r\n              {currentContext ? `Analyzing: ${currentContext}` : 'Online • Ready to help'}\r\n            </div>\r\n          </div>\r\n        </div>\r\n        {!inline && (\r\n          <button\r\n            onClick={onClose}\r\n            style={{\r\n              background: 'none',\r\n              border: 'none',\r\n              cursor: 'pointer',\r\n              padding: '4px',\r\n              borderRadius: '4px',\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              justifyContent: 'center'\r\n            }}\r\n          >\r\n            <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"#6b7280\">\r\n              <path d=\"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z\"/>\r\n            </svg>\r\n          </button>\r\n        )}\r\n      </div>\r\n\r\n      {/* Messages */}\r\n      <div style={{\r\n        flex: 1,\r\n        overflow: 'auto',\r\n        padding: inline ? '12px 16px' : '16px',\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        gap: '12px'\r\n      }}>\r\n        {messages.map((message) => (\r\n          <div\r\n            key={message.id}\r\n            style={{\r\n              display: 'flex',\r\n              flexDirection: message.type === 'user' ? 'row-reverse' : 'row',\r\n              gap: '8px',\r\n              alignItems: 'flex-start'\r\n            }}\r\n          >\r\n            {message.type === 'user' ? (\r\n              <div style={{\r\n                width: '28px',\r\n                height: '28px',\r\n                borderRadius: '50%',\r\n                backgroundColor: '#10b981',\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                justifyContent: 'center',\r\n                color: 'white',\r\n                fontSize: '12px',\r\n                fontWeight: 'bold',\r\n                flexShrink: 0\r\n              }}>\r\n                U\r\n              </div>\r\n            ) : (\r\n              <img \r\n                src=\"/assets/wihyfavicon.png\" \r\n                alt=\"WiHy\"\r\n                style={{\r\n                  width: '28px',\r\n                  height: '28px',\r\n                  borderRadius: '50%',\r\n                  border: '1px solid #e5e7eb',\r\n                  backgroundColor: 'white',\r\n                  padding: '2px',\r\n                  flexShrink: 0\r\n                }}\r\n              />\r\n            )}\r\n            <div style={{\r\n              maxWidth: '75%',\r\n              display: 'flex',\r\n              flexDirection: 'column',\r\n              gap: '4px'\r\n            }}>\r\n              <div style={{\r\n                backgroundColor: message.type === 'user' ? '#10b981' : '#f3f4f6',\r\n                color: message.type === 'user' ? 'white' : '#1f2937',\r\n                padding: '12px 16px',\r\n                borderRadius: message.type === 'user' ? '18px 18px 4px 18px' : '18px 18px 18px 4px',\r\n                fontSize: '14px',\r\n                lineHeight: '1.4'\r\n              }}>\r\n                {message.message}\r\n              </div>\r\n              <div style={{\r\n                fontSize: '11px',\r\n                color: '#9ca3af',\r\n                textAlign: message.type === 'user' ? 'right' : 'left',\r\n                paddingLeft: message.type === 'user' ? '0' : '16px',\r\n                paddingRight: message.type === 'user' ? '16px' : '0'\r\n              }}>\r\n                {formatTime(message.timestamp)}\r\n                {message.context && (\r\n                  <span style={{ marginLeft: '8px', fontStyle: 'italic' }}>\r\n                    • viewing {message.context}\r\n                  </span>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        ))}\r\n        \r\n        {isTyping && (\r\n          <div style={{\r\n            display: 'flex',\r\n            gap: '8px',\r\n            alignItems: 'flex-start'\r\n          }}>\r\n            <div style={{\r\n              width: '28px',\r\n              height: '28px',\r\n              borderRadius: '50%',\r\n              backgroundColor: '#1a73e8',\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              justifyContent: 'center',\r\n              color: 'white',\r\n              fontSize: '12px',\r\n              fontWeight: 'bold'\r\n            }}>\r\n              WH\r\n            </div>\r\n            <div style={{\r\n              backgroundColor: '#f3f4f6',\r\n              padding: '12px 16px',\r\n              borderRadius: '18px 18px 18px 4px',\r\n              display: 'flex',\r\n              gap: '4px',\r\n              alignItems: 'center'\r\n            }}>\r\n              <div style={{\r\n                width: '6px',\r\n                height: '6px',\r\n                borderRadius: '50%',\r\n                backgroundColor: '#9ca3af',\r\n                animation: 'typing 1.5s ease-in-out infinite'\r\n              }} />\r\n              <div style={{\r\n                width: '6px',\r\n                height: '6px',\r\n                borderRadius: '50%',\r\n                backgroundColor: '#9ca3af',\r\n                animation: 'typing 1.5s ease-in-out infinite 0.2s'\r\n              }} />\r\n              <div style={{\r\n                width: '6px',\r\n                height: '6px',\r\n                borderRadius: '50%',\r\n                backgroundColor: '#9ca3af',\r\n                animation: 'typing 1.5s ease-in-out infinite 0.4s'\r\n              }} />\r\n            </div>\r\n          </div>\r\n        )}\r\n        \r\n        <div ref={messagesEndRef} />\r\n      </div>\r\n\r\n      {/* Input */}\r\n      <div style={{\r\n        padding: '16px',\r\n        borderTop: '1px solid #f3f4f6',\r\n        backgroundColor: '#fafbfc'\r\n      }}>\r\n        <div style={{\r\n          display: 'flex',\r\n          gap: '8px',\r\n          alignItems: 'flex-end'\r\n        }}>\r\n          <textarea\r\n            value={inputMessage}\r\n            onChange={(e) => setInputMessage(e.target.value)}\r\n            onKeyPress={handleKeyPress}\r\n            placeholder=\"Ask about your health data...\"\r\n            style={{\r\n              flex: 1,\r\n              border: '1px solid #d1d5db',\r\n              borderRadius: '12px',\r\n              padding: '12px 16px',\r\n              fontSize: '14px',\r\n              resize: 'none',\r\n              minHeight: '20px',\r\n              maxHeight: '80px',\r\n              fontFamily: 'inherit',\r\n              outline: 'none'\r\n            }}\r\n            rows={1}\r\n          />\r\n          <button\r\n            onClick={handleSendMessage}\r\n            disabled={!inputMessage.trim() || isTyping}\r\n            style={{\r\n              backgroundColor: inputMessage.trim() ? '#1a73e8' : '#d1d5db',\r\n              color: 'white',\r\n              border: 'none',\r\n              borderRadius: '12px',\r\n              padding: '12px',\r\n              cursor: inputMessage.trim() ? 'pointer' : 'not-allowed',\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              justifyContent: 'center',\r\n              transition: 'background-color 0.2s ease'\r\n            }}\r\n          >\r\n            <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\r\n              <path d=\"M2.01 21L23 12 2.01 3 2 10l15 2-15 2z\"/>\r\n            </svg>\r\n          </button>\r\n        </div>\r\n      </div>\r\n      \r\n      <style>{`\r\n        @keyframes typing {\r\n          0%, 60%, 100% {\r\n            transform: translateY(0);\r\n            opacity: 0.4;\r\n          }\r\n          30% {\r\n            transform: translateY(-10px);\r\n            opacity: 1;\r\n          }\r\n        }\r\n      `}</style>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ChatWidget;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}