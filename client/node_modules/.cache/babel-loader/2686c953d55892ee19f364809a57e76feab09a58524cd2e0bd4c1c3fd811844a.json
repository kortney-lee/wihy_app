{"ast":null,"code":"import React,{useState,useEffect,useRef}from'react';import{BrowserRouter as Router,Routes,Route,useSearchParams,useNavigate}from'react-router-dom';import VHealthSearch from'./VHealthSearch';import SearchResults from'./SearchResults';import{wihyAPI}from'./services/wihyAPI';import{searchCache}from'./services/searchCache';import{fetchNewsFeed,refreshNewsFeed,searchNewsArticles}from'./services/newsService';import'./styles/VHealthSearch.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const API_BASE_URL=process.env.REACT_APP_API_URL||'http://localhost:5000';export const searchFoodDatabase=async query=>{try{console.log('Calling food database API for:',query);const response=await fetch(\"\".concat(API_BASE_URL,\"/api/food/search?q=\").concat(encodeURIComponent(query)),{method:'GET',headers:{'Content-Type':'application/json'}});if(!response.ok){throw new Error(\"HTTP error! status: \".concat(response.status));}const data=await response.json();console.log('Food API response:',data);return data;}catch(error){console.error('Food database API error:',error);throw error;}};export const foodAPI={searchFood:searchFoodDatabase};// Export news API for use in other components\nexport const newsAPI={fetchNewsFeed,refreshNewsFeed,searchNewsArticles};const ResultsPage=()=>{const[searchParams]=useSearchParams();const navigate=useNavigate();const query=searchParams.get('q')||'';const isHealthNews=searchParams.get('type')==='health_news';const category=searchParams.get('category')||'all';const[isLoading,setIsLoading]=useState(false);const[results,setResults]=useState('');const[dataSource,setDataSource]=useState(\"local\");const[citations,setCitations]=useState([]);const[recommendations,setRecommendations]=useState([]);const[disclaimer,setDisclaimer]=useState('');// Track if this is initial load to prevent loading spinner on browser navigation\nconst[isInitialLoad,setIsInitialLoad]=useState(true);// Add ref to prevent duplicate API calls\nconst lastProcessedQuery=useRef('');const isProcessing=useRef(false);// Detect browser navigation type\nconst isBrowserNavigation=()=>{var _performance,_performance$getEntri,_performance$getEntri2;const navigation=(_performance=window.performance)===null||_performance===void 0?void 0:(_performance$getEntri=_performance.getEntriesByType)===null||_performance$getEntri===void 0?void 0:(_performance$getEntri2=_performance$getEntri.call(_performance,'navigation'))===null||_performance$getEntri2===void 0?void 0:_performance$getEntri2[0];return(navigation===null||navigation===void 0?void 0:navigation.type)==='back_forward';};// Fetch results when query changes\nuseEffect(()=>{const fetchResults=async()=>{if(!query&&!isHealthNews){setIsLoading(false);return;}// Create cache key based on type\nconst cacheKey=isHealthNews?\"health_news_\".concat(category):query;// Prevent duplicate processing\nif(isProcessing.current||lastProcessedQuery.current===cacheKey){console.log('Skipping duplicate query:',cacheKey);return;}console.log(\"Processing new query:\",cacheKey);lastProcessedQuery.current=cacheKey;isProcessing.current=true;console.log(\"Is health news:\",isHealthNews);console.log(\"Is browser navigation:\",isBrowserNavigation());// Always check cache first - especially for browser navigation\nconst cachedResult=searchCache.getCachedResult(cacheKey);if(cachedResult){console.log('Using cached results for:',cacheKey);setResults(cachedResult);setDataSource('local');setIsLoading(false);setCitations([]);setRecommendations([]);setDisclaimer('');setIsInitialLoad(false);isProcessing.current=false;// Reset processing flag\nreturn;// Exit early - no API calls needed\n}// If this is browser navigation and no cache, redirect to search page\nif(isBrowserNavigation()||!isInitialLoad){console.log('Browser navigation detected with no cache - redirecting to search');isProcessing.current=false;// Reset processing flag\nnavigate('/');return;}// Only show loading for genuine new searches (not browser navigation)\nsetIsLoading(true);try{// Handle \"I'm Feeling Healthy\" requests\nif(isHealthNews){console.log('Fetching health news via newsService...');const healthNewsResult=await fetchNewsFeed([category],6);if(healthNewsResult.success&&healthNewsResult.articles){console.log('Health news fetched successfully');// Format the news articles for display\nconst formattedNews=formatNewsArticles(healthNewsResult.articles);setResults(formattedNews);setDataSource('openai');// Use openai as the display source\n// Cache the health news results\nsearchCache.setCachedResult(cacheKey,formattedNews,window.location.href);setDisclaimer('Health news provided by AI. Always consult healthcare professionals for medical advice.');}else{throw new Error(healthNewsResult.message||'Failed to fetch health news');}}else{// Handle regular search queries\n// STEP 1: First try the nutrition database\ntry{console.log('Trying nutrition database first...');console.log('API URL:',\"\".concat(API_BASE_URL,\"/api/search/food?q=\").concat(encodeURIComponent(query)));const nutritionResponse=await fetch(\"\".concat(API_BASE_URL,\"/api/search/food?q=\").concat(encodeURIComponent(query)));if(nutritionResponse.ok){const nutritionData=await nutritionResponse.json();console.log('Nutrition API response:',nutritionData);if(nutritionData&&nutritionData.found===true){console.log('Found nutrition data - using vnutrition source');const resultString=JSON.stringify(nutritionData);setResults(resultString);setDataSource('vnutrition');// Cache the nutrition results\nsearchCache.setCachedResult(query,resultString,window.location.href);setIsLoading(false);setIsInitialLoad(false);isProcessing.current=false;// Reset processing flag\nreturn;}}}catch(nutritionError){console.log('Nutrition API error:',nutritionError);}// STEP 2: Fall back to WiHy API if no nutrition data found\nconsole.log('Making WiHy API call for query:',query);const wihyRequest={query:query};const wihyResult=await wihyAPI.askAnything(wihyRequest);console.log(\"WiHy API result received:\",wihyResult);if(wihyResult.success){const formattedResult=wihyAPI.formatWihyResponse(wihyResult);setResults(formattedResult);setDataSource(\"wihy\");// Cache the WiHy results\nsearchCache.setCachedResult(query,formattedResult,window.location.href);setCitations(wihyAPI.extractCitations(wihyResult));setRecommendations(wihyAPI.extractRecommendations(wihyResult));setDisclaimer('This guidance is based on evidence-based health principles. Always consult healthcare professionals for personalized medical advice.');}else{throw new Error('WiHy API request failed');}}}catch(error){console.error(\"Search error:\",error);const errorMessage=\"Sorry, there was an error processing your request.\";setResults(errorMessage);setDataSource(\"error\");setCitations([]);setRecommendations([]);setDisclaimer('');}finally{setIsLoading(false);setIsInitialLoad(false);isProcessing.current=false;// Always reset processing flag\n}};fetchResults();},[query,isHealthNews,category]);// Removed 'navigate' from dependencies\n// Function to format news articles for display\nconst formatNewsArticles=articles=>{let formatted='# Latest Health News\\n\\n';articles.forEach((article,index)=>{formatted+=\"## \".concat(article.title,\"\\n\\n\");formatted+=\"**Source:** \".concat(article.source,\" (\").concat(article.domain,\")\\n\");formatted+=\"**Category:** \".concat(article.category,\"\\n\");formatted+=\"**Published:** \".concat(new Date(article.publishedDate).toLocaleDateString(),\"\\n\");formatted+=\"**Relevance:** \".concat(Math.round(article.relevanceScore*100),\"%\\n\\n\");formatted+=\"\".concat(article.summary,\"\\n\\n\");if(article.tags&&article.tags.length>0){formatted+=\"**Tags:** \".concat(article.tags.join(', '),\"\\n\\n\");}formatted+=\"[Read Full Article](\".concat(article.url,\")\\n\\n\");formatted+='---\\n\\n';});return formatted;};const handleBackToSearch=()=>{navigate('/');};const handleNewSearch=newQuery=>{if(newQuery!==query){// Reset the initial load flag for new searches\nsetIsInitialLoad(true);navigate(\"/results?q=\".concat(encodeURIComponent(newQuery)));}};return/*#__PURE__*/_jsx(SearchResults,{query:isHealthNews?'Latest Health News':query,results:results,onBackToSearch:handleBackToSearch,onNewSearch:handleNewSearch,isLoading:isLoading,dataSource:dataSource,citations:citations,recommendations:recommendations,disclaimer:disclaimer});};const App=()=>{console.log(\"App component rendered\");return/*#__PURE__*/_jsx(Router,{children:/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(VHealthSearch,{})}),/*#__PURE__*/_jsx(Route,{path:\"/results\",element:/*#__PURE__*/_jsx(ResultsPage,{})})]})});};export default App;","map":{"version":3,"names":["React","useState","useEffect","useRef","BrowserRouter","Router","Routes","Route","useSearchParams","useNavigate","VHealthSearch","SearchResults","wihyAPI","searchCache","fetchNewsFeed","refreshNewsFeed","searchNewsArticles","jsx","_jsx","jsxs","_jsxs","API_BASE_URL","process","env","REACT_APP_API_URL","searchFoodDatabase","query","console","log","response","fetch","concat","encodeURIComponent","method","headers","ok","Error","status","data","json","error","foodAPI","searchFood","newsAPI","ResultsPage","searchParams","navigate","get","isHealthNews","category","isLoading","setIsLoading","results","setResults","dataSource","setDataSource","citations","setCitations","recommendations","setRecommendations","disclaimer","setDisclaimer","isInitialLoad","setIsInitialLoad","lastProcessedQuery","isProcessing","isBrowserNavigation","_performance","_performance$getEntri","_performance$getEntri2","navigation","window","performance","getEntriesByType","call","type","fetchResults","cacheKey","current","cachedResult","getCachedResult","healthNewsResult","success","articles","formattedNews","formatNewsArticles","setCachedResult","location","href","message","nutritionResponse","nutritionData","found","resultString","JSON","stringify","nutritionError","wihyRequest","wihyResult","askAnything","formattedResult","formatWihyResponse","extractCitations","extractRecommendations","errorMessage","formatted","forEach","article","index","title","source","domain","Date","publishedDate","toLocaleDateString","Math","round","relevanceScore","summary","tags","length","join","url","handleBackToSearch","handleNewSearch","newQuery","onBackToSearch","onNewSearch","App","children","path","element"],"sources":["C:/repo/wihy_ui/client/src/App.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport { BrowserRouter as Router, Routes, Route, useSearchParams, useNavigate } from 'react-router-dom';\r\nimport VHealthSearch from './VHealthSearch';\r\nimport SearchResults from './SearchResults';\r\nimport HealthNewsFeed from './components/HealthNewsFeed';\r\nimport openaiAPI from './services/openaiAPI';\r\nimport { wihyAPI } from './services/wihyAPI';\r\nimport { searchCache } from './services/searchCache';\r\nimport { fetchNewsFeed, refreshNewsFeed, searchNewsArticles } from './services/newsService';\r\nimport './styles/VHealthSearch.css';\r\n\r\nconst API_BASE_URL = process.env.REACT_APP_API_URL || 'http://localhost:5000';\r\n\r\nexport const searchFoodDatabase = async (query: string) => {\r\n  try {\r\n    console.log('Calling food database API for:', query);\r\n    \r\n    const response = await fetch(`${API_BASE_URL}/api/food/search?q=${encodeURIComponent(query)}`, {\r\n      method: 'GET',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error(`HTTP error! status: ${response.status}`);\r\n    }\r\n\r\n    const data = await response.json();\r\n    console.log('Food API response:', data);\r\n    \r\n    return data;\r\n  } catch (error) {\r\n    console.error('Food database API error:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\nexport const foodAPI = {\r\n  searchFood: searchFoodDatabase\r\n};\r\n\r\n// Export news API for use in other components\r\nexport const newsAPI = {\r\n  fetchNewsFeed,\r\n  refreshNewsFeed,\r\n  searchNewsArticles\r\n};\r\n\r\ntype AllowedDataSource = \"error\" | \"openai\" | \"local\" | \"vnutrition\" | \"wihy\";\r\n\r\nconst ResultsPage: React.FC = () => {\r\n  const [searchParams] = useSearchParams();\r\n  const navigate = useNavigate();\r\n  const query = searchParams.get('q') || '';\r\n  const isHealthNews = searchParams.get('type') === 'health_news';\r\n  const category = searchParams.get('category') || 'all';\r\n  \r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [results, setResults] = useState<string>('');\r\n  const [dataSource, setDataSource] = useState<AllowedDataSource>(\"local\");\r\n  const [citations, setCitations] = useState<string[]>([]);\r\n  const [recommendations, setRecommendations] = useState<string[]>([]);\r\n  const [disclaimer, setDisclaimer] = useState<string>('');\r\n  \r\n  // Track if this is initial load to prevent loading spinner on browser navigation\r\n  const [isInitialLoad, setIsInitialLoad] = useState(true);\r\n  \r\n  // Add ref to prevent duplicate API calls\r\n  const lastProcessedQuery = useRef<string>('');\r\n  const isProcessing = useRef<boolean>(false);\r\n  \r\n  // Detect browser navigation type\r\n  const isBrowserNavigation = () => {\r\n    const navigation = (window as any).performance?.getEntriesByType?.('navigation')?.[0];\r\n    return navigation?.type === 'back_forward';\r\n  };\r\n\r\n  // Fetch results when query changes\r\n  useEffect(() => {\r\n    const fetchResults = async () => {\r\n      if (!query && !isHealthNews) {\r\n        setIsLoading(false);\r\n        return;\r\n      }\r\n      \r\n      // Create cache key based on type\r\n      const cacheKey = isHealthNews ? `health_news_${category}` : query;\r\n      \r\n      // Prevent duplicate processing\r\n      if (isProcessing.current || lastProcessedQuery.current === cacheKey) {\r\n        console.log('Skipping duplicate query:', cacheKey);\r\n        return;\r\n      }\r\n      \r\n      console.log(\"Processing new query:\", cacheKey);\r\n      lastProcessedQuery.current = cacheKey;\r\n      isProcessing.current = true;\r\n      \r\n      console.log(\"Is health news:\", isHealthNews);\r\n      console.log(\"Is browser navigation:\", isBrowserNavigation());\r\n      \r\n      // Always check cache first - especially for browser navigation\r\n      const cachedResult = searchCache.getCachedResult(cacheKey);\r\n      if (cachedResult) {\r\n        console.log('Using cached results for:', cacheKey);\r\n        setResults(cachedResult);\r\n        setDataSource('local');\r\n        setIsLoading(false);\r\n        setCitations([]);\r\n        setRecommendations([]);\r\n        setDisclaimer('');\r\n        setIsInitialLoad(false);\r\n        isProcessing.current = false; // Reset processing flag\r\n        return; // Exit early - no API calls needed\r\n      }\r\n      \r\n      // If this is browser navigation and no cache, redirect to search page\r\n      if (isBrowserNavigation() || !isInitialLoad) {\r\n        console.log('Browser navigation detected with no cache - redirecting to search');\r\n        isProcessing.current = false; // Reset processing flag\r\n        navigate('/');\r\n        return;\r\n      }\r\n      \r\n      // Only show loading for genuine new searches (not browser navigation)\r\n      setIsLoading(true);\r\n      \r\n      try {\r\n        // Handle \"I'm Feeling Healthy\" requests\r\n        if (isHealthNews) {\r\n          console.log('Fetching health news via newsService...');\r\n          const healthNewsResult = await fetchNewsFeed([category], 6);\r\n          \r\n          if (healthNewsResult.success && healthNewsResult.articles) {\r\n            console.log('Health news fetched successfully');\r\n            \r\n            // Format the news articles for display\r\n            const formattedNews = formatNewsArticles(healthNewsResult.articles);\r\n            \r\n            setResults(formattedNews);\r\n            setDataSource('openai'); // Use openai as the display source\r\n            \r\n            // Cache the health news results\r\n            searchCache.setCachedResult(cacheKey, formattedNews, window.location.href);\r\n            \r\n            setDisclaimer('Health news provided by AI. Always consult healthcare professionals for medical advice.');\r\n          } else {\r\n            throw new Error(healthNewsResult.message || 'Failed to fetch health news');\r\n          }\r\n        } else {\r\n          // Handle regular search queries\r\n          // STEP 1: First try the nutrition database\r\n          try {\r\n            console.log('Trying nutrition database first...');\r\n            console.log('API URL:', `${API_BASE_URL}/api/search/food?q=${encodeURIComponent(query)}`);\r\n            \r\n            const nutritionResponse = await fetch(`${API_BASE_URL}/api/search/food?q=${encodeURIComponent(query)}`);\r\n            \r\n            if (nutritionResponse.ok) {\r\n              const nutritionData = await nutritionResponse.json();\r\n              console.log('Nutrition API response:', nutritionData);\r\n              \r\n              if (nutritionData && nutritionData.found === true) {\r\n                console.log('Found nutrition data - using vnutrition source');\r\n                const resultString = JSON.stringify(nutritionData);\r\n                setResults(resultString);\r\n                setDataSource('vnutrition');\r\n                \r\n                // Cache the nutrition results\r\n                searchCache.setCachedResult(query, resultString, window.location.href);\r\n                \r\n                setIsLoading(false);\r\n                setIsInitialLoad(false);\r\n                isProcessing.current = false; // Reset processing flag\r\n                return;\r\n              }\r\n            }\r\n          } catch (nutritionError) {\r\n            console.log('Nutrition API error:', nutritionError);\r\n          }\r\n          \r\n          // STEP 2: Fall back to WiHy API if no nutrition data found\r\n          console.log('Making WiHy API call for query:', query);\r\n          const wihyRequest = { query: query };\r\n          const wihyResult = await wihyAPI.askAnything(wihyRequest);\r\n          console.log(\"WiHy API result received:\", wihyResult);\r\n          \r\n          if (wihyResult.success) {\r\n            const formattedResult = wihyAPI.formatWihyResponse(wihyResult);\r\n            setResults(formattedResult);\r\n            setDataSource(\"wihy\");\r\n            \r\n            // Cache the WiHy results\r\n            searchCache.setCachedResult(query, formattedResult, window.location.href);\r\n            \r\n            setCitations(wihyAPI.extractCitations(wihyResult));\r\n            setRecommendations(wihyAPI.extractRecommendations(wihyResult));\r\n            setDisclaimer('This guidance is based on evidence-based health principles. Always consult healthcare professionals for personalized medical advice.');\r\n          } else {\r\n            throw new Error('WiHy API request failed');\r\n          }\r\n        }\r\n        \r\n      } catch (error) {\r\n        console.error(\"Search error:\", error);\r\n        const errorMessage = \"Sorry, there was an error processing your request.\";\r\n        setResults(errorMessage);\r\n        setDataSource(\"error\");\r\n        \r\n        setCitations([]);\r\n        setRecommendations([]);\r\n        setDisclaimer('');\r\n      } finally {\r\n        setIsLoading(false);\r\n        setIsInitialLoad(false);\r\n        isProcessing.current = false; // Always reset processing flag\r\n      }\r\n    };\r\n    \r\n    fetchResults();\r\n  }, [query, isHealthNews, category]); // Removed 'navigate' from dependencies\r\n\r\n  // Function to format news articles for display\r\n  const formatNewsArticles = (articles: any[]): string => {\r\n    let formatted = '# Latest Health News\\n\\n';\r\n    \r\n    articles.forEach((article, index) => {\r\n      formatted += `## ${article.title}\\n\\n`;\r\n      formatted += `**Source:** ${article.source} (${article.domain})\\n`;\r\n      formatted += `**Category:** ${article.category}\\n`;\r\n      formatted += `**Published:** ${new Date(article.publishedDate).toLocaleDateString()}\\n`;\r\n      formatted += `**Relevance:** ${Math.round(article.relevanceScore * 100)}%\\n\\n`;\r\n      formatted += `${article.summary}\\n\\n`;\r\n      \r\n      if (article.tags && article.tags.length > 0) {\r\n        formatted += `**Tags:** ${article.tags.join(', ')}\\n\\n`;\r\n      }\r\n      \r\n      formatted += `[Read Full Article](${article.url})\\n\\n`;\r\n      formatted += '---\\n\\n';\r\n    });\r\n    \r\n    return formatted;\r\n  };\r\n\r\n  const handleBackToSearch = () => {\r\n    navigate('/');\r\n  };\r\n\r\n  const handleNewSearch = (newQuery: string) => {\r\n    if (newQuery !== query) {\r\n      // Reset the initial load flag for new searches\r\n      setIsInitialLoad(true);\r\n      navigate(`/results?q=${encodeURIComponent(newQuery)}`);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <SearchResults\r\n      query={isHealthNews ? 'Latest Health News' : query}\r\n      results={results}\r\n      onBackToSearch={handleBackToSearch}\r\n      onNewSearch={handleNewSearch}\r\n      isLoading={isLoading}\r\n      dataSource={dataSource}\r\n      citations={citations}\r\n      recommendations={recommendations}\r\n      disclaimer={disclaimer}\r\n    />\r\n  );\r\n};\r\n\r\nconst App: React.FC = () => {\r\n  console.log(\"App component rendered\");\r\n  \r\n  return (\r\n    <Router>\r\n      <Routes>\r\n        <Route path=\"/\" element={<VHealthSearch />} />\r\n        <Route path=\"/results\" element={<ResultsPage />} />\r\n      </Routes>\r\n    </Router>\r\n  );\r\n};\r\n\r\nexport default App;\r\n\r\ninterface ChatGPTResponse {\r\n  details?: string;\r\n  sources?: string[];\r\n  recommendations?: string[];\r\n  medicalDisclaimer?: string;\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}