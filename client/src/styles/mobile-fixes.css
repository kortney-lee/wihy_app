/* Mobile-specific fixes for layout issues */

/* Fix any unwanted overlays or background tints */
@media (max-width: 768px) {
  /* CRITICAL: Remove horizontal scrollbar completely */
  html {
    overflow-x: hidden !important;
    max-width: 100vw !important;
    width: 100% !important;
  }

  /* Force remove scrollbar from body */
  body {
    overflow-x: hidden !important;
    max-width: 100vw !important;
    width: 100% !important;
  }

  /* Remove scrollbar from viewport containers */
  html, body {
    overflow-x: hidden !important;
    -webkit-overflow-scrolling: touch !important;
  }

  body {
    overflow-x: hidden !important;
    max-width: 100vw !important;
    background: #f9f9f9 !important;
    background-image: none !important;
    padding-top: 80px !important; /* Reduced from 160px - just enough for mobile header */
    margin: 0 !important;
    position: relative !important;
  }

  /* Prevent any element from causing horizontal scroll */
  * {
    max-width: 100% !important;
    box-sizing: border-box !important;
  }

  /* Target common scrollbar culprits */
  #root,
  .app,
  .App,
  .main-container,
  .content-wrapper,
  .page-container {
    overflow-x: hidden !important;
    max-width: 100vw !important;
    width: 100% !important;
  }

  /* Hide scrollbars on mobile for chat widget and all scrollable elements */
  .chat-messages-scroll,
  .chat-messages-scroll::-webkit-scrollbar,
  *::-webkit-scrollbar {
    display: none !important;
    width: 0 !important;
    background: transparent !important;
  }

  /* Hide scrollbars on Firefox mobile */
  .chat-messages-scroll,
  * {
    scrollbar-width: none !important;
    -ms-overflow-style: none !important;
  }

  /* Ensure smooth scrolling on mobile */
  .chat-messages-scroll {
    -webkit-overflow-scrolling: touch !important;
  }
}  /* Remove scrollbar from any potential wide elements */
  div, section, article, main, header, footer {
    max-width: 100vw !important;
    overflow-x: hidden !important;
  }

  /* Override CSS variables for mobile to ensure clean look */
  :root {
    --vh-accent: #1a73e8;
    --vh-accent-2: #34a853;
    --vh-ink: #202124;
    --vh-muted: #5f6368;
    --vh-surface: #ffffff;
    --vh-surface-2: #ffffff; /* Changed from #f8fbff to pure white for mobile */
    --vh-ring: 0 0 0 3px rgba(26,115,232,.18);
  }

  /* Remove any yellow/orange overlays */
  *::before,
  *::after {
    background: none !important;
    box-shadow: none !important;
  }

  /* Ensure main app container fits properly */
  .app-container {
    padding: 10px !important;
    margin: 0 auto !important;
    max-width: 100vw !important;
    overflow-x: hidden !important;
  }

  /* Fix main content areas - reduce padding */
  .results-page {
    padding-top: 5px !important;
  }

  .results-container {
    padding: 10px !important;
    margin: 5px auto !important;
  }

  /* Fix text sizing for mobile readability */
  .health-info-content,
  .health-info-content pre {
    font-size: 14px !important;
    line-height: 1.6 !important;
  }

  /* Improve mobile typography */
  .results-header {
    font-size: 18px !important;
    margin-bottom: 15px !important;
  }
  
  /* News feed specific mobile fixes */
  .feeling-healthy-section {
    position: relative !important;
    top: auto !important;
    transform: none !important;
    padding-top: 0 !important;
    margin-top: 0 !important;
    height: auto !important;
    overflow: visible !important;
  }
  
  /* Ensure news feed container doesn't push content off screen */
  .news-feed-container {
    position: relative !important;
    top: auto !important;
    transform: none !important;
    margin-top: 10px !important; /* Reduced from 20px since body padding is now smaller */
  }
  
  /* Prevent any scroll-to-top behavior */
  .news-card {
    scroll-margin-top: 0 !important;
    transform: none !important;
  }
  
  /* Ensure smooth scrolling and no layout shifts */
  html {
    scroll-behavior: auto !important; /* Disable smooth scroll that might cause issues */
  }
  
  /* Fix any layout shifts on mobile */
  .search-landing,
  .results-page {
    min-height: calc(100vh - 160px) !important; /* Match mobile body padding */
    margin-top: 0 !important;
    padding-top: 10px !important;
  }

  /* Better mobile text sizing throughout */
  h2, h3, h4, h5, h6 {
    font-size: clamp(14px, 4vw, 24px) !important;
    line-height: 1.3 !important;
  }

  /* Special styling for main title/logo - ensure visibility */
  .search-title,
  h1 {
    font-size: clamp(1.8rem, 6vw, 2.5rem) !important;
    margin: 15px 0 25px 0 !important;
    text-align: center !important;
    line-height: 1.2 !important;
    color: #000000 !important;
    font-weight: 700 !important;
    display: block !important;
    visibility: visible !important;
    opacity: 1 !important;
    background: linear-gradient(135deg, #000000 0%, #000000 100%) !important;
    -webkit-background-clip: text !important;
    -webkit-text-fill-color: transparent !important;
    background-clip: text !important;
  }

  /* Improve readability of main content */
  .markdown-content,
  .health-info-content,
  .health-info-content * {
    font-size: 15px !important;
    line-height: 1.6 !important;
  }

  /* Adjust button text size */
  .topic-button,
  .resources-list a {
    font-size: 14px !important;
  }

  /* Improve chart text */
  .quality-chart-container,
  .nutrition-chart-container {
    font-size: 13px !important;
  }

  /* Better spacing between elements */
  .health-info-card {
    margin-bottom: 15px !important;
  }

  /* Ensure news feed integrates properly with mobile layout */
  .news-feed-container {
    margin-top: 10px !important; /* Reduced from 20px to match earlier reduction */
    padding: 0 10px !important;
    max-width: 100% !important;
  }

  /* Make sure scrollable areas don't conflict */
  .search-form,
  .results-container,
  .news-feed-container {
    overflow-x: hidden !important;
    width: 100% !important;
    box-sizing: border-box !important;
  }

  .related-topics-card,
  .resources-card {
    margin-bottom: 12px !important;
  }

  /* Ensure proper mobile padding for search container */
  .search-container-centered {
    padding: 15px 20px !important;
  }

  /* Ensure clean white backgrounds for main content areas */
  .results-page,
  .search-landing,
  .health-info-card,
  .health-info-content,
  .related-topics-card,
  .resources-card {
    background: #ffffff !important;
    background-image: none !important;
    background-color: #ffffff !important;
  }

  /* Override card gradients for mobile */
  .related-topics-card,
  .resources-card {
    background: #ffffff !important;
    border: 1px solid #e8f0fe;
    box-shadow: 0 2px 8px rgba(0,0,0,0.05);
  }

  .related-topics-card h3,
  .resources-card h3 {
    background: #f8fbff !important;
    color: #1a73e8 !important;
  }

  /* Fix any dark/black overlays that might cause readability issues */
  .data-source-indicator,
  .error-source {
    background: #ffffff !important;
    color: #333333 !important;
    border: 1px solid #e8f0fe;
    border-radius: 8px;
    padding: 8px 12px;
    margin: 8px 0;
  }

  .error-source {
    background: #fef7f7 !important;
    color: #ea4335 !important;
    border-color: #fecaca;
  }

  /* Ensure proper text contrast */
  .health-info-content,
  .health-info-content *,
  .related-topics-list,
  .resources-list {
    color: #333333 !important;
    background: transparent !important;
  }

  /* Fix any modal or overlay issues */
  .modal-overlay,
  .loading-overlay {
    background: rgba(255, 255, 255, 0.95) !important;
  }

  /* Ensure proper button visibility */
  .topic-button,
  .resources-list a {
    background: #f8fbff !important;
    color: #1a73e8 !important;
    border: 1px solid #e8f0fe;
    margin-bottom: 4px;
    border-radius: 8px;
  }

  .topic-button:hover,
  .resources-list a:hover {
    background: #eef4ff !important;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
  }

  /* Fix search input container with animation */
  .search-input-container {
    background: 
      linear-gradient(#fff, #fff) padding-box,
      linear-gradient(90deg, #fa5f06, #ffffff, #C0C0C0, #4cbb17, #1a73e8) border-box !important;
    animation: wiH-border-sweep 2.2s linear infinite !important;
  }

  /* Remove any unwanted gradients or overlays */
  .health-info-card::before {
    display: none !important;
  }

  /* Ensure proper z-index stacking */
  .results-search-header {
    z-index: 100 !important;
    background: #ffffff !important;
  }

  .sidebar {
    z-index: 1 !important;
  }

  /* Fix any layout overflow issues */
  body,
  html {
    overflow-x: hidden !important;
  }

  .results-container,
  .search-container-centered {
    width: 100% !important;
    max-width: 100% !important;
    overflow-x: hidden !important;
  }

  /* Fix search input placeholder text display */
  .search-input {
    font-size: 16px !important; /* Prevent zoom on iOS */
    padding: 12px 60px 12px 16px !important; /* More space for icons */
    width: 100% !important;
    box-sizing: border-box !important;
  }

  .search-input::placeholder {
    font-size: 16px !important;
    color: #9aa0a6 !important;
    opacity: 1 !important;
    text-overflow: ellipsis !important;
    white-space: nowrap !important;
    overflow: hidden !important;
  }

  /* Ensure search icons don't overlap text */
  .search-icons {
    right: 8px !important;
    background-color: rgba(255, 255, 255, 0.95) !important;
  }

/* Extra small mobile devices */
@media (max-width: 480px) {
  /* Ensure even more compact layout */
  .health-info-card,
  .related-topics-card,
  .resources-card {
    margin: 0 0 12px 0 !important;
    padding: 12px !important;
  }

  /* Fix any remaining overlay issues */
  .search-icons {
    background-color: rgba(255, 255, 255, 0.95) !important;
    backdrop-filter: blur(4px);
  }
}

/* Mobile-specific hiding for clean news-only view */
@media (max-width: 768px) {
  /* Hide search buttons on mobile - user should only see news */
  .search-buttons {
    display: none !important;
  }

  /* Hide category buttons on mobile - already handled in HealthNewsFeed.css but adding here for extra coverage */
  .news-categories {
    display: none !important;
  }

  /* Ensure news feed takes full width and starts at top */
  .feeling-healthy-section {
    padding-top: 0 !important;
    margin-top: 0 !important;
    width: 100% !important;
    max-width: 100vw !important;
    overflow-x: hidden !important;
  }

  /* Make search container more compact when buttons are hidden */
  .search-container {
    margin-bottom: 10px !important;
    width: 100% !important;
    max-width: 100vw !important;
    overflow-x: hidden !important;
  }

  /* News feed specific overflow fixes */
  .news-feed-container {
    width: 100% !important;
    max-width: 100vw !important;
    overflow-x: hidden !important;
    padding: 8px 12px 20px 12px !important;
    margin: 20px 0 0 0 !important; /* Top margin for spacing from header, no side margins */
    box-sizing: border-box !important;
  }

  /* News grid overflow fixes */
  .news-grid {
    width: 100% !important;
    max-width: 100vw !important;
    overflow-x: hidden !important;
    grid-template-columns: 1fr !important;
    gap: 12px !important;
    padding: 0 !important;
    margin: 0 !important;
  }

  /* Individual news articles */
  .news-article,
  article {
    width: 100% !important;
    max-width: 100% !important;
    overflow-x: hidden !important;
    box-sizing: border-box !important;
  }

  /* News article content areas */
  .news-content,
  .news-title,
  .news-description {
    width: 100% !important;
    max-width: 100% !important;
    overflow-wrap: break-word !important;
    word-wrap: break-word !important;
    hyphens: auto !important;
  }

  /* News images */
  .news-image,
  .news-image img {
    width: 100% !important;
    max-width: 100% !important;
    height: auto !important;
    object-fit: cover !important;
  }

  /* Main app container fixes */
  #root {
    width: 100% !important;
    max-width: 100vw !important;
    overflow-x: hidden !important;
  }

  /* Modal Mobile Fixes */
  .photo-modal-overlay,
  .upload-modal-overlay {
    padding: 10px !important;
  }
  
  .photo-modal,
  .upload-modal-content {
    width: 95% !important;
    max-width: 420px !important;
    max-height: 90vh !important;
    border-radius: 16px !important;
    margin: 10px !important;
  }
  
  .modal-header {
    padding: 20px 20px 12px 20px !important;
  }
  
  .modal-header h2 {
    font-size: 20px !important;
  }
  
  .modal-subtitle {
    font-size: 13px !important;
  }
  
  .simple-upload-container {
    padding: 16px 20px !important;
  }
  
  .simple-search-button {
    padding: 14px 20px !important;
    font-size: 16px !important;
    min-height: 48px !important;
    border-radius: 24px !important;
  }
  
  .simple-url-section {
    padding: 0 20px 24px 20px !important;
    flex-direction: column !important;
    gap: 12px !important;
  }
  
  .simple-url-input {
    padding: 14px 18px !important;
    font-size: 16px !important;
    min-height: 48px !important;
    border-radius: 24px !important;
  }
}

@media (max-width: 480px) {
  .photo-modal,
  .upload-modal-content {
    width: 98% !important;
    margin: 5px !important;
  }
  
  .modal-header {
    padding: 16px 16px 10px 16px !important;
  }
  
  .simple-upload-container {
    padding: 12px 16px !important;
  }
}

/* ===========================
   MOBILE NAVIGATION & KEYBOARD FIXES
   =========================== */

/* Handle mobile navigation bars and keyboard interactions */
@media (max-width: 768px) {
  /* Use CSS environment variables for safe area (mobile notch/navigation bars) */
  html {
    /* Account for mobile navigation bars */
    padding-top: env(safe-area-inset-top);
    padding-bottom: env(safe-area-inset-bottom);
    padding-left: env(safe-area-inset-left);
    padding-right: env(safe-area-inset-right);
  }

  /* Main content containers should respect safe area */
  body,
  #root,
  .main-container {
    /* Adjust for navigation bars */
    min-height: 100vh;
    min-height: calc(100vh - env(safe-area-inset-top) - env(safe-area-inset-bottom));
  }

  /* Input areas that need keyboard-aware positioning */
  .chat-input-area,
  .search-input-container,
  .input-container,
  .chat-input-wrapper {
    /* Prevent keyboard from covering input */
    position: relative;
    padding-bottom: calc(16px + env(safe-area-inset-bottom));
    transition: all 0.3s ease;
  }

  /* When virtual keyboard is open (detected by viewport height change) */
  @supports (-webkit-touch-callout: none) {
    /* iOS Safari specific fixes */
    .chat-input-area,
    .search-input-container {
      /* Stick to bottom when keyboard opens */
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: white;
      border-top: 1px solid #e5e7eb;
      z-index: 1000;
      padding-bottom: env(safe-area-inset-bottom);
    }

    /* Adjust main content when keyboard input is focused */
    .keyboard-open body {
      padding-bottom: 320px; /* Approximate keyboard height */
    }
  }

  /* Android Chrome specific fixes */
  @media screen and (-webkit-min-device-pixel-ratio: 0) {
    /* Adjust for Android navigation bars */
    .main-container {
      height: 100vh;
      height: calc(100vh - env(safe-area-inset-bottom));
    }
  }

  /* Fixed header/navigation that should stay above keyboard */
  .results-search-header,
  .dashboard-header,
  .header-container {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 100;
    background: white;
    padding-top: env(safe-area-inset-top);
  }

  /* Scrollable content that should account for keyboard */
  .chat-messages,
  .results-container,
  .dashboard-content {
    /* Account for potential keyboard */
    padding-bottom: calc(80px + env(safe-area-inset-bottom));
    max-height: calc(100vh - 160px); /* Account for header + input area */
    overflow-y: auto;
  }

  /* Prevent zoom on input focus (iOS fix) */
  input[type="text"],
  input[type="search"],
  textarea {
    font-size: 16px !important; /* Prevents iOS zoom */
    transform: translateZ(0); /* Force hardware acceleration */
  }

  /* Scroll behavior fixes for mobile */
  .scrollable-container {
    -webkit-overflow-scrolling: touch;
    scroll-behavior: smooth;
  }

  /* Focus fixes for better mobile UX */
  input:focus,
  textarea:focus {
    /* Ensure focused inputs are visible */
    transform: translateY(-20px); /* Move up slightly when focused */
    transition: transform 0.3s ease;
  }

  input:not(:focus),
  textarea:not(:focus) {
    transform: translateY(0);
    transition: transform 0.3s ease;
  }
}

/* Landscape orientation fixes */
@media (max-width: 768px) and (orientation: landscape) {
  /* Adjust for smaller height in landscape */
  .chat-messages,
  .results-container {
    max-height: calc(100vh - 120px); /* Reduced height for landscape */
  }

  /* Compact header in landscape */
  .results-search-header {
    padding: 8px 16px;
  }

  /* Smaller input areas in landscape */
  .chat-input-area {
    padding: 8px 16px;
  }
}

/* Very small screens (iPhone SE, etc.) */
@media (max-width: 375px) {
  /* Extra compact layout */
  .chat-input-area,
  .search-input-container {
    padding: 8px 12px;
    padding-bottom: calc(8px + env(safe-area-inset-bottom));
  }

  /* Smaller fonts to fit more content */
  input,
  textarea {
    font-size: 14px !important;
  }
}

/* JavaScript class helpers for keyboard state */
.keyboard-open {
  /* Applied when virtual keyboard is detected */
  padding-bottom: 320px; /* Keyboard height compensation */
}

.keyboard-closed {
  /* Applied when virtual keyboard is hidden */
  padding-bottom: 0;
}

/* Navigation bar states */
.has-navigation-bar {
  /* Applied when device has bottom navigation */
  padding-bottom: calc(48px + env(safe-area-inset-bottom)) !important;
}

.no-navigation-bar {
  /* Applied when device has no bottom navigation */
  padding-bottom: env(safe-area-inset-bottom) !important;
}